{
	"$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
	"contentVersion": "1.0.0.0",
	"parameters": {
		"factoryName": {
			"type": "string",
			"metadata": "Data Factory name",
			"defaultValue": "PlanetFitnessDF"
		}
	},
	"variables": {
		"factoryId": "[concat('Microsoft.DataFactory/factories/', parameters('factoryName'))]"
	},
	"resources": [
		{
			"name": "[concat(parameters('factoryName'), '/Catalogitemcategories_SQLPOOL')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "ForEach1",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "Lookup1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('Lookup1').output.value",
								"type": "Expression"
							},
							"isSequential": false,
							"activities": [
								{
									"name": "Catalogitemcategories",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [
										{
											"name": "Source",
											"value": "."
										},
										{
											"name": "Destination",
											"value": "betadata.stg_members"
										}
									],
									"typeProperties": {
										"source": {
											"type": "OracleSource",
											"oracleReaderQuery": {
												"value": "select * from BETADATA.CATALOGITEMCATEGORIES\nwhere CIC_MODIFIED >= TO_DATE('@{formatDateTime(pipeline().parameters.windowStart, 'yyyy-MM-dd HH:mm' )}', 'YYYY-MM-DD HH24:MI') \nAND CIC_MODIFIED < TO_DATE('@{formatDateTime(pipeline().parameters.windowEnd, 'yyyy-MM-dd HH:mm' )}', 'YYYY-MM-DD HH24:MI')\nAND VPD_ID in @{item().vpd_list}",
												"type": "Expression"
											},
											"partitionOption": "None"
										},
										"sink": {
											"type": "SqlDWSink",
											"allowPolyBase": true,
											"polyBaseSettings": {
												"rejectValue": 0,
												"rejectType": "value",
												"useTypeDefault": false
											}
										},
										"enableStaging": true,
										"stagingSettings": {
											"linkedServiceName": {
												"referenceName": "AzureBlobStorage1",
												"type": "LinkedServiceReference"
											},
											"path": "vifiles"
										},
										"parallelCopies": 32,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "VPD_ID",
														"type": "Decimal"
													},
													"sink": {
														"name": "VPD_ID",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "CIC_ID",
														"type": "String"
													},
													"sink": {
														"name": "CIC_ID",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "CIC_CREATED",
														"type": "DateTime"
													},
													"sink": {
														"name": "CIC_CREATED",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"name": "CIC_MODIFIED",
														"type": "DateTime"
													},
													"sink": {
														"name": "CIC_MODIFIED",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"name": "CIC_ACTIVE",
														"type": "String"
													},
													"sink": {
														"name": "CIC_ACTIVE",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "CIC_ABC_CODE",
														"type": "String"
													},
													"sink": {
														"name": "CIC_ABC_CODE",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "CIC_NAME",
														"type": "String"
													},
													"sink": {
														"name": "CIC_NAME",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "CIC_DESCRIPTION",
														"type": "String"
													},
													"sink": {
														"name": "CIC_DESCRIPTION",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "CIC_BUTTON_TEXT",
														"type": "String"
													},
													"sink": {
														"name": "CIC_BUTTON_TEXT",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "CIC_GL_CODE",
														"type": "String"
													},
													"sink": {
														"name": "CIC_GL_CODE",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "CIC_DISPLAY_IN_POS",
														"type": "String"
													},
													"sink": {
														"name": "CIC_DISPLAY_IN_POS",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "CIC_POS_ONLY",
														"type": "String"
													},
													"sink": {
														"name": "CIC_POS_ONLY",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "CIC_SORT_ORDER",
														"type": "Decimal"
													},
													"sink": {
														"name": "CIC_SORT_ORDER",
														"type": "Decimal"
													}
												}
											]
										}
									},
									"inputs": [
										{
											"referenceName": "SRC_BETADATA_CATALOGITEMCATEGORIES",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "SNK_SYN_DT_STG_CATALOGITEMCATEGORIES_INCR",
											"type": "DatasetReference",
											"parameters": {}
										}
									]
								}
							]
						}
					},
					{
						"name": "Lookup1",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Truncate incr table",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderStoredProcedureName": "[[abcpi].[GetVPDToLoad]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "AzureSynapseAnalyticsDB",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": false
						}
					},
					{
						"name": "Truncate incr table",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "truncate table StgDatatrak.stg_CATALOGITEMCATEGORIES_incr;\nselect 0;",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "AzureSynapseAnalyticsDB",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Merge to Staging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "ForEach1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[StgDatatrak].[STG_CATALOGITEMCATEGORIES_MERGE]"
						},
						"linkedServiceName": {
							"referenceName": "AzureSynapseAnalytics1",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"windowStart": {
						"type": "String"
					},
					"windowEnd": {
						"type": "String"
					}
				},
				"folder": {
					"name": "Oracle_SQLPOOL/Oracle_SQL_POOL_Group1"
				},
				"annotations": [],
				"lastPublishTime": "2023-02-08T11:25:30Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Catalogitems_SQLPOOL')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Catalogitems",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "Lookup1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('Lookup1').output.value",
								"type": "Expression"
							},
							"isSequential": false,
							"activities": [
								{
									"name": "Catalogitems01",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [
										{
											"name": "Source",
											"value": "."
										},
										{
											"name": "Destination",
											"value": "ABCPI.STG_CATALOGITEMS_INCR"
										}
									],
									"typeProperties": {
										"source": {
											"type": "OracleSource",
											"oracleReaderQuery": {
												"value": "select /*+INDEX(t,CGI_MODIFIED)*/\n       VPD_ID\n      ,CGI_ID\n      ,CGI_CREATED\n      ,CGI_CREATED_LOCAL\n      ,CGI_MODIFIED\n      ,CGI_ACTIVE\n      ,CGI_SERVICE\n      ,CGI_REQUIRED\n      ,CGI_ABC_CODE\n      ,REGEXP_REPLACE(cgi_name,'[^0-9A-Za-z.,-/_()*&^%$#@!~/\\+=]', ' ')  as CGI_NAME\n      ,CGI_DESCRIPTION\n      ,CGI_DISCOUNT_TYPE_FIXED\n      ,CGI_SALE_PRICE\n      ,CGI_SALE_PRICE_FIXED\n      ,CGI_DEFAULT_QUANTITY\n      ,CGI_DEFAULT_QUANTITY_FIXED\n      ,CGI_BUTTON_TEXT\n      ,CGI_PROMPT_FOR_PRICE\n      ,CGI_PROMPT_FOR_PRICE_FIXED\n      ,CGI_L1_PERCENTAGE\n      ,CGI_L1_FIXED_AMOUNT\n      ,CGI_L2_PERCENTAGE\n      ,CGI_L2_FIXED_AMOUNT\n      ,CGI_L3_PERCENTAGE\n      ,CGI_L3_FIXED_AMOUNT\n      ,CGI_L_FIXED\n      ,CGI_UPC\n      ,CGI_ASSET\n      ,CGI_MEMBER_REQUIRED\n      ,CGI_HOLD\n      ,CGI_HOLD_FIXED\n      ,CGI_ALLOW_DISCOUNT\n      ,CGI_ALLOW_DISCOUNT_FIXED\n      ,CGI_ALLOW_USER_DISCOUNT\n      ,CGI_ALLOW_USER_DISCOUNT_FIXED\n      ,CGI_SIZE\n      ,CGI_COLOR\n      ,CGI_CASE_QUANTITY\n      ,CGI_STOCKABLE\n      ,CGI_PRINT_RECEIPT\n      ,CGI_PRINT_RECEIPT_FIXED\n      ,CGI_EMPLOYEE_REQUIRED\n      ,CGI_ONE_PER_TRANSACTION\n      ,CGI_PROMPT_FOR_NAME\n      ,CGI_ALLOW_FREE\n      ,CGI_ALLOW_CLUB_ACCOUNT\n      ,CG_ID\n      ,CIC_ID\n      ,CPIV_ID_ALTERNATE\n      ,CPIV_ID_PREFERRED\n      ,D_ID\n      ,PC_ID\n      ,SDT_ID\n      ,SEM_ID\n      ,TZL_ID_CREATED_LOCAL\n      ,CGI_ALLOW_INCREMENTAL_SERVICE\n      ,CIG_ID\n      ,CGI_ALLOW_DEDUCT\n      ,CGI_COMMISSION_REQUIRED\n      ,CGI_SERVICE_EMPLOYEE_REQUIRED\n      ,CGI_VERIFY_PIN\n      ,CGI_SERVICE_COLOR_BUTTON\n      ,CGI_SERVICE_COLOR_TEXT\n      ,CGI_SERVICES_COLOR_BUTTON\n      ,CGI_SERVICES_COLOR_TEXT\n      ,CGI_MIN_QUANTITY\n      ,CGI_MAX_QUANTITY\n      ,CGI_MODIFIED_DW\n      ,CMG_ID\n      ,CGI_ONLINE\n      ,CGI_ONLINE_FIXED\n      ,CGI_ABC_PC_ID\n      ,CGI_ABC_PC_CLIENT_LEVEL\n      ,CGI_RECURRING_SERVICE_SEARCH\n      ,COSR_ID\n      ,CGI_ALLOW_CLUB_CREDIT\n      ,CGIPTR_ABC_CODE\n      ,CGI_ALLOW_CROSS_CLUB\n\n from BETADATA.CATALOGITEMS t\nwhere CGI_MODIFIED>= TO_DATE('@{formatDateTime(pipeline().parameters.windowStart, 'yyyy-MM-dd HH:mm' )}', 'YYYY-MM-DD HH24:MI') \nAND CGI_MODIFIED< TO_DATE('@{formatDateTime(pipeline().parameters.windowEnd, 'yyyy-MM-dd HH:mm' )}', 'YYYY-MM-DD HH24:MI')\nAND VPD_ID in @{item().vpd_list}",
												"type": "Expression"
											},
											"partitionOption": "None",
											"convertDecimalToInteger": false
										},
										"sink": {
											"type": "SqlDWSink",
											"allowPolyBase": true,
											"polyBaseSettings": {
												"rejectValue": 0,
												"rejectType": "value",
												"useTypeDefault": false
											}
										},
										"enableStaging": true,
										"stagingSettings": {
											"linkedServiceName": {
												"referenceName": "AzureBlobStorage1",
												"type": "LinkedServiceReference"
											},
											"path": "vifiles"
										},
										"parallelCopies": 32,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "VPD_ID",
														"type": "Decimal"
													},
													"sink": {
														"name": "VPD_ID",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "CGI_ID",
														"type": "String"
													},
													"sink": {
														"name": "CGI_ID",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "CGI_CREATED",
														"type": "DateTime"
													},
													"sink": {
														"name": "CGI_CREATED",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"name": "CGI_CREATED_LOCAL",
														"type": "DateTime"
													},
													"sink": {
														"name": "CGI_CREATED_LOCAL",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"name": "CGI_MODIFIED",
														"type": "DateTime"
													},
													"sink": {
														"name": "CGI_MODIFIED",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"name": "CGI_ACTIVE",
														"type": "String"
													},
													"sink": {
														"name": "CGI_ACTIVE",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "CGI_SERVICE",
														"type": "String"
													},
													"sink": {
														"name": "CGI_SERVICE",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "CGI_REQUIRED",
														"type": "String"
													},
													"sink": {
														"name": "CGI_REQUIRED",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "CGI_ABC_CODE",
														"type": "String"
													},
													"sink": {
														"name": "CGI_ABC_CODE",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "CGI_NAME",
														"type": "String"
													},
													"sink": {
														"name": "CGI_NAME",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "CGI_DESCRIPTION",
														"type": "String"
													},
													"sink": {
														"name": "CGI_DESCRIPTION",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "CGI_DISCOUNT_TYPE_FIXED",
														"type": "String"
													},
													"sink": {
														"name": "CGI_DISCOUNT_TYPE_FIXED",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "CGI_SALE_PRICE",
														"type": "Decimal"
													},
													"sink": {
														"name": "CGI_SALE_PRICE",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "CGI_SALE_PRICE_FIXED",
														"type": "String"
													},
													"sink": {
														"name": "CGI_SALE_PRICE_FIXED",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "CGI_DEFAULT_QUANTITY",
														"type": "Decimal"
													},
													"sink": {
														"name": "CGI_DEFAULT_QUANTITY",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "CGI_DEFAULT_QUANTITY_FIXED",
														"type": "String"
													},
													"sink": {
														"name": "CGI_DEFAULT_QUANTITY_FIXED",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "CGI_BUTTON_TEXT",
														"type": "String"
													},
													"sink": {
														"name": "CGI_BUTTON_TEXT",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "CGI_PROMPT_FOR_PRICE",
														"type": "String"
													},
													"sink": {
														"name": "CGI_PROMPT_FOR_PRICE",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "CGI_PROMPT_FOR_PRICE_FIXED",
														"type": "String"
													},
													"sink": {
														"name": "CGI_PROMPT_FOR_PRICE_FIXED",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "CGI_L1_PERCENTAGE",
														"type": "Decimal"
													},
													"sink": {
														"name": "CGI_L1_PERCENTAGE",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "CGI_L1_FIXED_AMOUNT",
														"type": "Decimal"
													},
													"sink": {
														"name": "CGI_L1_FIXED_AMOUNT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "CGI_L2_PERCENTAGE",
														"type": "Decimal"
													},
													"sink": {
														"name": "CGI_L2_PERCENTAGE",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "CGI_L2_FIXED_AMOUNT",
														"type": "Decimal"
													},
													"sink": {
														"name": "CGI_L2_FIXED_AMOUNT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "CGI_L3_PERCENTAGE",
														"type": "Decimal"
													},
													"sink": {
														"name": "CGI_L3_PERCENTAGE",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "CGI_L3_FIXED_AMOUNT",
														"type": "Decimal"
													},
													"sink": {
														"name": "CGI_L3_FIXED_AMOUNT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "CGI_L_FIXED",
														"type": "String"
													},
													"sink": {
														"name": "CGI_L_FIXED",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "CGI_UPC",
														"type": "String"
													},
													"sink": {
														"name": "CGI_UPC",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "CGI_ASSET",
														"type": "String"
													},
													"sink": {
														"name": "CGI_ASSET",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "CGI_MEMBER_REQUIRED",
														"type": "Decimal"
													},
													"sink": {
														"name": "CGI_MEMBER_REQUIRED",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "CGI_HOLD",
														"type": "String"
													},
													"sink": {
														"name": "CGI_HOLD",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "CGI_HOLD_FIXED",
														"type": "String"
													},
													"sink": {
														"name": "CGI_HOLD_FIXED",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "CGI_ALLOW_DISCOUNT",
														"type": "String"
													},
													"sink": {
														"name": "CGI_ALLOW_DISCOUNT",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "CGI_ALLOW_DISCOUNT_FIXED",
														"type": "String"
													},
													"sink": {
														"name": "CGI_ALLOW_DISCOUNT_FIXED",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "CGI_ALLOW_USER_DISCOUNT",
														"type": "String"
													},
													"sink": {
														"name": "CGI_ALLOW_USER_DISCOUNT",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "CGI_ALLOW_USER_DISCOUNT_FIXED",
														"type": "String"
													},
													"sink": {
														"name": "CGI_ALLOW_USER_DISCOUNT_FIXED",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "CGI_SIZE",
														"type": "String"
													},
													"sink": {
														"name": "CGI_SIZE",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "CGI_COLOR",
														"type": "String"
													},
													"sink": {
														"name": "CGI_COLOR",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "CGI_CASE_QUANTITY",
														"type": "Decimal"
													},
													"sink": {
														"name": "CGI_CASE_QUANTITY",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "CGI_STOCKABLE",
														"type": "String"
													},
													"sink": {
														"name": "CGI_STOCKABLE",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "CGI_PRINT_RECEIPT",
														"type": "String"
													},
													"sink": {
														"name": "CGI_PRINT_RECEIPT",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "CGI_PRINT_RECEIPT_FIXED",
														"type": "String"
													},
													"sink": {
														"name": "CGI_PRINT_RECEIPT_FIXED",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "CGI_EMPLOYEE_REQUIRED",
														"type": "String"
													},
													"sink": {
														"name": "CGI_EMPLOYEE_REQUIRED",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "CGI_ONE_PER_TRANSACTION",
														"type": "String"
													},
													"sink": {
														"name": "CGI_ONE_PER_TRANSACTION",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "CGI_PROMPT_FOR_NAME",
														"type": "String"
													},
													"sink": {
														"name": "CGI_PROMPT_FOR_NAME",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "CGI_ALLOW_FREE",
														"type": "String"
													},
													"sink": {
														"name": "CGI_ALLOW_FREE",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "CGI_ALLOW_CLUB_ACCOUNT",
														"type": "String"
													},
													"sink": {
														"name": "CGI_ALLOW_CLUB_ACCOUNT",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "CG_ID",
														"type": "String"
													},
													"sink": {
														"name": "CG_ID",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "CIC_ID",
														"type": "String"
													},
													"sink": {
														"name": "CIC_ID",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "CPIV_ID_ALTERNATE",
														"type": "String"
													},
													"sink": {
														"name": "CPIV_ID_ALTERNATE",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "CPIV_ID_PREFERRED",
														"type": "String"
													},
													"sink": {
														"name": "CPIV_ID_PREFERRED",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "D_ID",
														"type": "String"
													},
													"sink": {
														"name": "D_ID",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "PC_ID",
														"type": "String"
													},
													"sink": {
														"name": "PC_ID",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "SDT_ID",
														"type": "String"
													},
													"sink": {
														"name": "SDT_ID",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "SEM_ID",
														"type": "String"
													},
													"sink": {
														"name": "SEM_ID",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "TZL_ID_CREATED_LOCAL",
														"type": "String"
													},
													"sink": {
														"name": "TZL_ID_CREATED_LOCAL",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "CGI_ALLOW_INCREMENTAL_SERVICE",
														"type": "String"
													},
													"sink": {
														"name": "CGI_ALLOW_INCREMENTAL_SERVICE",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "CIG_ID",
														"type": "String"
													},
													"sink": {
														"name": "CIG_ID",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "CGI_ALLOW_DEDUCT",
														"type": "String"
													},
													"sink": {
														"name": "CGI_ALLOW_DEDUCT",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "CGI_COMMISSION_REQUIRED",
														"type": "String"
													},
													"sink": {
														"name": "CGI_COMMISSION_REQUIRED",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "CGI_SERVICE_EMPLOYEE_REQUIRED",
														"type": "String"
													},
													"sink": {
														"name": "CGI_SERVICE_EMPLOYEE_REQUIRED",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "CGI_VERIFY_PIN",
														"type": "String"
													},
													"sink": {
														"name": "CGI_VERIFY_PIN",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "CGI_SERVICE_COLOR_BUTTON",
														"type": "String"
													},
													"sink": {
														"name": "CGI_SERVICE_COLOR_BUTTON",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "CGI_SERVICE_COLOR_TEXT",
														"type": "String"
													},
													"sink": {
														"name": "CGI_SERVICE_COLOR_TEXT",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "CGI_SERVICES_COLOR_BUTTON",
														"type": "String"
													},
													"sink": {
														"name": "CGI_SERVICES_COLOR_BUTTON",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "CGI_SERVICES_COLOR_TEXT",
														"type": "String"
													},
													"sink": {
														"name": "CGI_SERVICES_COLOR_TEXT",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "CGI_MIN_QUANTITY",
														"type": "Decimal"
													},
													"sink": {
														"name": "CGI_MIN_QUANTITY",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "CGI_MAX_QUANTITY",
														"type": "Decimal"
													},
													"sink": {
														"name": "CGI_MAX_QUANTITY",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "CGI_MODIFIED_DW",
														"type": "DateTime"
													},
													"sink": {
														"name": "CGI_MODIFIED_DW",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"name": "CMG_ID",
														"type": "String"
													},
													"sink": {
														"name": "CMG_ID",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "CGI_ONLINE",
														"type": "String"
													},
													"sink": {
														"name": "CGI_ONLINE",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "CGI_ONLINE_FIXED",
														"type": "String"
													},
													"sink": {
														"name": "CGI_ONLINE_FIXED",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "CGI_ABC_PC_ID",
														"type": "String"
													},
													"sink": {
														"name": "CGI_ABC_PC_ID",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "CGI_ABC_PC_CLIENT_LEVEL",
														"type": "String"
													},
													"sink": {
														"name": "CGI_ABC_PC_CLIENT_LEVEL",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "CGI_RECURRING_SERVICE_SEARCH",
														"type": "String"
													},
													"sink": {
														"name": "CGI_RECURRING_SERVICE_SEARCH",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "COSR_ID",
														"type": "String"
													},
													"sink": {
														"name": "COSR_ID",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "CGI_ALLOW_CLUB_CREDIT",
														"type": "String"
													},
													"sink": {
														"name": "CGI_ALLOW_CLUB_CREDIT",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "CGIPTR_ABC_CODE",
														"type": "String"
													},
													"sink": {
														"name": "CGIPTR_ABC_CODE",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "CGI_ALLOW_CROSS_CLUB",
														"type": "String"
													},
													"sink": {
														"name": "CGI_ALLOW_CROSS_CLUB",
														"type": "String"
													}
												}
											]
										}
									},
									"inputs": [
										{
											"referenceName": "SRC_BETADATA_CATALOGITEMS",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "SNK_SYN_DT_STG_CATALOGITEMS_INCR",
											"type": "DatasetReference",
											"parameters": {}
										}
									]
								}
							]
						}
					},
					{
						"name": "Lookup1",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Truncate incr table",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderStoredProcedureName": "[[abcpi].[GetVPDToLoad]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "AzureSynapseAnalyticsDB",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": false
						}
					},
					{
						"name": "Truncate incr table",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "truncate table StgDatatrak.stg_catalogitems_incr;\nselect 0;",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "AzureSynapseAnalyticsDB",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Merge to Staging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Catalogitems",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[StgDatatrak].[STG_CATALOGITEMS_MERGE]"
						},
						"linkedServiceName": {
							"referenceName": "AzureSynapseAnalytics1",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"windowStart": {
						"type": "string"
					},
					"windowEnd": {
						"type": "string"
					}
				},
				"folder": {
					"name": "Oracle_SQLPOOL/Oracle_SQL_POOL_Group1"
				},
				"annotations": [],
				"lastPublishTime": "2023-02-08T11:25:31Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Catalogs_SQLPOOL')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Catalogs",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "Lookup1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('Lookup1').output.value",
								"type": "Expression"
							},
							"isSequential": false,
							"activities": [
								{
									"name": "Catalogs01",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [
										{
											"name": "Source",
											"value": "."
										},
										{
											"name": "Destination",
											"value": "ABCPI.STG_CATALOGS_INCR"
										}
									],
									"typeProperties": {
										"source": {
											"type": "OracleSource",
											"oracleReaderQuery": {
												"value": "select * from BETADATA.CATALOGS\nwhere CG_MODIFIED>= TO_DATE('@{formatDateTime(pipeline().parameters.windowStart, 'yyyy-MM-dd HH:mm' )}', 'YYYY-MM-DD HH24:MI') \nAND CG_MODIFIED< TO_DATE('@{formatDateTime(pipeline().parameters.windowEnd, 'yyyy-MM-dd HH:mm' )}', 'YYYY-MM-DD HH24:MI')\nAND VPD_ID in @{item().vpd_list}",
												"type": "Expression"
											},
											"partitionOption": "None"
										},
										"sink": {
											"type": "SqlDWSink",
											"allowPolyBase": true,
											"polyBaseSettings": {
												"rejectValue": 0,
												"rejectType": "value",
												"useTypeDefault": false
											}
										},
										"enableStaging": true,
										"stagingSettings": {
											"linkedServiceName": {
												"referenceName": "AzureBlobStorage1",
												"type": "LinkedServiceReference"
											},
											"path": "vifiles"
										},
										"parallelCopies": 32,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "VPD_ID",
														"type": "Decimal"
													},
													"sink": {
														"name": "VPD_ID",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "CG_ID",
														"type": "String"
													},
													"sink": {
														"name": "CG_ID",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "CG_CREATED",
														"type": "DateTime"
													},
													"sink": {
														"name": "CG_CREATED",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"name": "CG_MODIFIED",
														"type": "DateTime"
													},
													"sink": {
														"name": "CG_MODIFIED",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"name": "CG_ACTIVE",
														"type": "String"
													},
													"sink": {
														"name": "CG_ACTIVE",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "CG_REQUIRED",
														"type": "String"
													},
													"sink": {
														"name": "CG_REQUIRED",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "CG_NAME",
														"type": "String"
													},
													"sink": {
														"name": "CG_NAME",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "CG_NOTE",
														"type": "String"
													},
													"sink": {
														"name": "CG_NOTE",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "CG_VISIBLE",
														"type": "String"
													},
													"sink": {
														"name": "CG_VISIBLE",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "CG_ABC_CODE",
														"type": "String"
													},
													"sink": {
														"name": "CG_ABC_CODE",
														"type": "String"
													}
												}
											]
										}
									},
									"inputs": [
										{
											"referenceName": "SRC_BETADATA_CATALOGS",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "SNK_SYN_DT_STG_CATALOGS_INCR",
											"type": "DatasetReference",
											"parameters": {}
										}
									]
								}
							]
						}
					},
					{
						"name": "Lookup1",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Truncate incr table",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderStoredProcedureName": "[[abcpi].[GetVPDToLoad]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "AzureSynapseAnalyticsDB",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": false
						}
					},
					{
						"name": "Truncate incr table",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "truncate table StgDatatrak.stg_catalogs_incr;\nselect 0;",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "AzureSynapseAnalyticsDB",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Merge to Staging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Catalogs",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[StgDatatrak].[STG_CATALOGS_MERGE]"
						},
						"linkedServiceName": {
							"referenceName": "AzureSynapseAnalytics1",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"windowStart": {
						"type": "String"
					},
					"windowEnd": {
						"type": "String"
					}
				},
				"folder": {
					"name": "Oracle_SQLPOOL/Oracle_SQL_POOL_Group1"
				},
				"annotations": [],
				"lastPublishTime": "2023-02-08T11:25:30Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/CheckInLogs_SQLPOOL')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "ForEach1",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "Lookup1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('Lookup1').output.value",
								"type": "Expression"
							},
							"isSequential": false,
							"activities": [
								{
									"name": "CheckInLogs",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [
										{
											"name": "Source",
											"value": "."
										},
										{
											"name": "Destination",
											"value": "ABCPI.STG_CHECKINLOGS"
										}
									],
									"typeProperties": {
										"source": {
											"type": "OracleSource",
											"oracleReaderQuery": {
												"value": "SELECT /*+INDEX(cil,VPD_CIL_CHECKIN_DATE_LOCAL)*/  *\nfrom BETADATA.CHECKINLOGS cil\nwhere cil.CIL_CHECKIN_DATE_LOCAL >= TO_DATE('@{formatDateTime(pipeline().parameters.windowStart, 'yyyy-MM-dd HH:mm' )}', 'YYYY-MM-DD HH24:MI') \nAND cil.CIL_CHECKIN_DATE_LOCAL < TO_DATE('@{formatDateTime(pipeline().parameters.windowEnd, 'yyyy-MM-dd HH:mm' )}', 'YYYY-MM-DD HH24:MI')\nAND cil.VPD_ID in @{item().vpd_list}",
												"type": "Expression"
											},
											"partitionOption": "None",
											"queryTimeout": "02:00:00"
										},
										"sink": {
											"type": "SqlDWSink",
											"allowPolyBase": true,
											"polyBaseSettings": {
												"rejectValue": 0,
												"rejectType": "value",
												"useTypeDefault": false
											},
											"disableMetricsCollection": false
										},
										"enableStaging": true,
										"stagingSettings": {
											"linkedServiceName": {
												"referenceName": "AzureBlobStorage1",
												"type": "LinkedServiceReference"
											},
											"path": "vifiles"
										},
										"parallelCopies": 32,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "VPD_ID",
														"type": "Decimal"
													},
													"sink": {
														"name": "VPD_ID",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "CIL_ID",
														"type": "String"
													},
													"sink": {
														"name": "CIL_ID",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "CIL_CHECKIN_DATE",
														"type": "DateTime"
													},
													"sink": {
														"name": "CIL_CHECKIN_DATE",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"name": "CIL_CHECKIN_DATE_LOCAL",
														"type": "DateTime"
													},
													"sink": {
														"name": "CIL_CHECKIN_DATE_LOCAL",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"name": "CIL_CHECKIN_DATE_ONLY",
														"type": "Decimal"
													},
													"sink": {
														"name": "CIL_CHECKIN_DATE_ONLY",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "CIL_AGREEMENT_NUM",
														"type": "String"
													},
													"sink": {
														"name": "CIL_AGREEMENT_NUM",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "CIL_AGREEMENT_TYPE",
														"type": "String"
													},
													"sink": {
														"name": "CIL_AGREEMENT_TYPE",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "CIL_RENEWAL_TYPE",
														"type": "String"
													},
													"sink": {
														"name": "CIL_RENEWAL_TYPE",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "CIL_HAS_ALERTS",
														"type": "String"
													},
													"sink": {
														"name": "CIL_HAS_ALERTS",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "CIL_HAS_NOTES",
														"type": "String"
													},
													"sink": {
														"name": "CIL_HAS_NOTES",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "CIL_OVERRIDE_STATE",
														"type": "String"
													},
													"sink": {
														"name": "CIL_OVERRIDE_STATE",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "CIL_ACKNOWLEDGED",
														"type": "String"
													},
													"sink": {
														"name": "CIL_ACKNOWLEDGED",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "CIL_STATION_ID",
														"type": "String"
													},
													"sink": {
														"name": "CIL_STATION_ID",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "SPL_ID",
														"type": "String"
													},
													"sink": {
														"name": "SPL_ID",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "TZL_ID_CHECKIN_DATE_LOCAL",
														"type": "String"
													},
													"sink": {
														"name": "TZL_ID_CHECKIN_DATE_LOCAL",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "M_ID",
														"type": "String"
													},
													"sink": {
														"name": "M_ID",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "CIL_LAST_CHECKIN_DATE",
														"type": "DateTime"
													},
													"sink": {
														"name": "CIL_LAST_CHECKIN_DATE",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"name": "AH_ID",
														"type": "String"
													},
													"sink": {
														"name": "AH_ID",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "BES_ID",
														"type": "String"
													},
													"sink": {
														"name": "BES_ID",
														"type": "String"
													}
												}
											]
										}
									},
									"inputs": [
										{
											"referenceName": "SRC_BETADATA_CHECKINLOGS",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "SNK_SYN_DT_STG_CHECKINLOGS_INCR",
											"type": "DatasetReference",
											"parameters": {}
										}
									]
								}
							]
						}
					},
					{
						"name": "Lookup1",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Truncate incr table",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderStoredProcedureName": "[[abcpi].[GetVPDToLoad]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "AzureSynapseAnalyticsDB",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": false
						}
					},
					{
						"name": "Truncate incr table",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "truncate table StgDatatrak.stg_checkinlogs_incr;\nselect 0;",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "AzureSynapseAnalyticsDB",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Merge to Staging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "ForEach1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[StgDatatrak].[STG_CHECKINLOGS_MERGE]"
						},
						"linkedServiceName": {
							"referenceName": "AzureSynapseAnalytics1",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"windowStart": {
						"type": "String"
					},
					"windowEnd": {
						"type": "String"
					}
				},
				"folder": {
					"name": "Oracle_SQLPOOL/Oracle_SQL_POOL_Group2"
				},
				"annotations": [],
				"lastPublishTime": "2023-02-08T11:25:30Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/CheckIns_IsDelete_SQLPOOL')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Truncate stg_checkinlogs_deleted_check_incr",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "truncate table  abcpi.STG_CHECKINLOGS_DELETED_CHECK_INCR;\nselect 0;",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "AzureSynapseAnalyticsDB",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Update Deleted CheckIN Flag",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "ForEach1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[DimFactPI].[FactCheckInDeletedUpdate]"
						},
						"linkedServiceName": {
							"referenceName": "AzureSynapseAnalytics1",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Lookup1",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Truncate stg_checkinlogs_deleted_check_incr",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderStoredProcedureName": "[[abcpi].[GetVPDToLoad]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "AzureSynapseAnalyticsDB",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": false
						}
					},
					{
						"name": "ForEach1",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "Lookup1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('Lookup1').output.value",
								"type": "Expression"
							},
							"isSequential": false,
							"activities": [
								{
									"name": "Get30Days_CheckIns_SQLPOOL",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [
										{
											"name": "Source",
											"value": "BETADATA.CHECKINLOGS"
										},
										{
											"name": "Destination",
											"value": "abcpi.STG_CHECKINLOGS_DELETED_CHECK_INCR"
										}
									],
									"typeProperties": {
										"source": {
											"type": "OracleSource",
											"oracleReaderQuery": {
												"value": "SELECT /*+INDEX(cil,VPD_CIL_CHECKIN_DATE_LOCAL)*/  *\nfrom BETADATA.CHECKINLOGS cil\nwhere trunc(cil.CIL_CHECKIN_DATE_LOCAL)>trunc(sysdate-31) and  \ncil.VPD_ID in @{item().vpd_list}\n\n\n\n\n",
												"type": "Expression"
											},
											"partitionOption": "None"
										},
										"sink": {
											"type": "SqlDWSink",
											"allowPolyBase": true,
											"polyBaseSettings": {
												"rejectValue": 0,
												"rejectType": "value",
												"useTypeDefault": false
											}
										},
										"enableStaging": true,
										"stagingSettings": {
											"linkedServiceName": {
												"referenceName": "AzureBlobStorage1",
												"type": "LinkedServiceReference"
											},
											"path": "vifiles"
										},
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "VPD_ID",
														"type": "Decimal"
													},
													"sink": {
														"name": "VPD_ID",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "CIL_ID",
														"type": "String"
													},
													"sink": {
														"name": "CIL_ID",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "CIL_CHECKIN_DATE",
														"type": "DateTime"
													},
													"sink": {
														"name": "CIL_CHECKIN_DATE",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"name": "CIL_CHECKIN_DATE_LOCAL",
														"type": "DateTime"
													},
													"sink": {
														"name": "CIL_CHECKIN_DATE_LOCAL",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"name": "CIL_CHECKIN_DATE_ONLY",
														"type": "Decimal"
													},
													"sink": {
														"name": "CIL_CHECKIN_DATE_ONLY",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "CIL_AGREEMENT_NUM",
														"type": "String"
													},
													"sink": {
														"name": "CIL_AGREEMENT_NUM",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "CIL_AGREEMENT_TYPE",
														"type": "String"
													},
													"sink": {
														"name": "CIL_AGREEMENT_TYPE",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "CIL_RENEWAL_TYPE",
														"type": "String"
													},
													"sink": {
														"name": "CIL_RENEWAL_TYPE",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "CIL_HAS_ALERTS",
														"type": "String"
													},
													"sink": {
														"name": "CIL_HAS_ALERTS",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "CIL_HAS_NOTES",
														"type": "String"
													},
													"sink": {
														"name": "CIL_HAS_NOTES",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "CIL_OVERRIDE_STATE",
														"type": "String"
													},
													"sink": {
														"name": "CIL_OVERRIDE_STATE",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "CIL_ACKNOWLEDGED",
														"type": "String"
													},
													"sink": {
														"name": "CIL_ACKNOWLEDGED",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "CIL_STATION_ID",
														"type": "String"
													},
													"sink": {
														"name": "CIL_STATION_ID",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "SPL_ID",
														"type": "String"
													},
													"sink": {
														"name": "SPL_ID",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "TZL_ID_CHECKIN_DATE_LOCAL",
														"type": "String"
													},
													"sink": {
														"name": "TZL_ID_CHECKIN_DATE_LOCAL",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "M_ID",
														"type": "String"
													},
													"sink": {
														"name": "M_ID",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "CIL_LAST_CHECKIN_DATE",
														"type": "DateTime"
													},
													"sink": {
														"name": "CIL_LAST_CHECKIN_DATE",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"name": "AH_ID",
														"type": "String"
													},
													"sink": {
														"name": "AH_ID",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "BES_ID",
														"type": "String"
													},
													"sink": {
														"name": "BES_ID",
														"type": "String"
													}
												}
											]
										}
									},
									"inputs": [
										{
											"referenceName": "SRC_BETADATA_CHECKINLOGS",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "SNK_SYN_ABCPI_STG_CHECKINLOGS_DELETED_CHECK_INCR",
											"type": "DatasetReference",
											"parameters": {}
										}
									]
								}
							]
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"folder": {
					"name": "Oracle_SQLPOOL"
				},
				"annotations": [],
				"lastPublishTime": "2023-02-08T11:25:30Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/ChildTimeTracking_SQLPOOL')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "ForEach1",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "Lookup1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('Lookup1').output.value",
								"type": "Expression"
							},
							"isSequential": false,
							"activities": [
								{
									"name": "ChildTimeTracking",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [
										{
											"name": "Source",
											"value": "."
										},
										{
											"name": "Destination",
											"value": "ABCPI.STG_AGREEMENTS"
										}
									],
									"typeProperties": {
										"source": {
											"type": "OracleSource",
											"oracleReaderQuery": {
												"value": "select   * from BETADATA.CHILDTIMETRACKING\nwhere CTT_MODIFIED>= TO_DATE('@{formatDateTime(pipeline().parameters.windowStart, 'yyyy-MM-dd HH:mm' )}', 'YYYY-MM-DD HH24:MI') \nAND CTT_MODIFIED< TO_DATE('@{formatDateTime(pipeline().parameters.windowEnd, 'yyyy-MM-dd HH:mm' )}', 'YYYY-MM-DD HH24:MI')\nAND VPD_ID in @{item().vpd_list}",
												"type": "Expression"
											},
											"partitionOption": "None"
										},
										"sink": {
											"type": "SqlDWSink",
											"allowPolyBase": true,
											"polyBaseSettings": {
												"rejectValue": 0,
												"rejectType": "value",
												"useTypeDefault": false
											}
										},
										"enableStaging": true,
										"stagingSettings": {
											"linkedServiceName": {
												"referenceName": "AzureBlobStorage1",
												"type": "LinkedServiceReference"
											},
											"path": "vifiles"
										},
										"parallelCopies": 32,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "VPD_ID",
														"type": "Decimal"
													},
													"sink": {
														"name": "VPD_ID",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "CTT_ID",
														"type": "String"
													},
													"sink": {
														"name": "CTT_ID",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "CTT_CREATED",
														"type": "DateTime"
													},
													"sink": {
														"name": "CTT_CREATED",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"name": "CTT_MODIFIED",
														"type": "DateTime"
													},
													"sink": {
														"name": "CTT_MODIFIED",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"name": "CTT_ACTIVE",
														"type": "String"
													},
													"sink": {
														"name": "CTT_ACTIVE",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "CTT_CLOCK_IN",
														"type": "DateTime"
													},
													"sink": {
														"name": "CTT_CLOCK_IN",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"name": "CTT_CLOCK_IN_ALTERED",
														"type": "DateTime"
													},
													"sink": {
														"name": "CTT_CLOCK_IN_ALTERED",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"name": "CTT_CLOCK_OUT",
														"type": "DateTime"
													},
													"sink": {
														"name": "CTT_CLOCK_OUT",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"name": "CTT_CLOCK_OUT_ALTERED",
														"type": "DateTime"
													},
													"sink": {
														"name": "CTT_CLOCK_OUT_ALTERED",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"name": "CTT_CHILD_CLOCK_IN_VERIFIED",
														"type": "String"
													},
													"sink": {
														"name": "CTT_CHILD_CLOCK_IN_VERIFIED",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "CTT_CHILD_CLOCK_OUT_VERIFIED",
														"type": "String"
													},
													"sink": {
														"name": "CTT_CHILD_CLOCK_OUT_VERIFIED",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "CTT_MEMBER_CLOCK_IN_VERIFIED",
														"type": "String"
													},
													"sink": {
														"name": "CTT_MEMBER_CLOCK_IN_VERIFIED",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "CTT_MEMBER_CLOCK_OUT_VERIFIED",
														"type": "String"
													},
													"sink": {
														"name": "CTT_MEMBER_CLOCK_OUT_VERIFIED",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "CTT_COMMENT",
														"type": "String"
													},
													"sink": {
														"name": "CTT_COMMENT",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "MCD_ID",
														"type": "String"
													},
													"sink": {
														"name": "MCD_ID",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "SS_ID",
														"type": "String"
													},
													"sink": {
														"name": "SS_ID",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "TZL_ID_CLOCK_IN",
														"type": "String"
													},
													"sink": {
														"name": "TZL_ID_CLOCK_IN",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "TZL_ID_CLOCK_OUT",
														"type": "String"
													},
													"sink": {
														"name": "TZL_ID_CLOCK_OUT",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "TZL_ID_CLOCK_IN_MODIFIED",
														"type": "String"
													},
													"sink": {
														"name": "TZL_ID_CLOCK_IN_MODIFIED",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "TZL_ID_CLOCK_OUT_MODIFIED",
														"type": "String"
													},
													"sink": {
														"name": "TZL_ID_CLOCK_OUT_MODIFIED",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "E_ID_CLOCK_IN",
														"type": "String"
													},
													"sink": {
														"name": "E_ID_CLOCK_IN",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "E_ID_CLOCK_OUT",
														"type": "String"
													},
													"sink": {
														"name": "E_ID_CLOCK_OUT",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "M_ID_CLOCK_IN",
														"type": "String"
													},
													"sink": {
														"name": "M_ID_CLOCK_IN",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "M_ID_CLOCK_OUT",
														"type": "String"
													},
													"sink": {
														"name": "M_ID_CLOCK_OUT",
														"type": "String"
													}
												}
											]
										}
									},
									"inputs": [
										{
											"referenceName": "SRC_BETADATA_CHILDTIMETRACKING",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "SNK_SYN_DT_STG_CHILDTIMETRACKING_INCR",
											"type": "DatasetReference",
											"parameters": {}
										}
									]
								}
							]
						}
					},
					{
						"name": "Lookup1",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Truncate Incr table",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderStoredProcedureName": "[[abcpi].[GetVPDToLoad]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "AzureSynapseAnalyticsDB",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": false
						}
					},
					{
						"name": "Truncate Incr table",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "truncate table StgDatatrak.STG_CHILDTIMETRACKING_INCR;\nselect 0;",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "AzureSynapseAnalyticsDB",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": false
						}
					},
					{
						"name": "Merge to Staging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "ForEach1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[StgDatatrak].[STG_CHILDTIMETRACKING_MERGE]"
						},
						"linkedServiceName": {
							"referenceName": "AzureSynapseAnalytics1",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"windowStart": {
						"type": "String"
					},
					"windowEnd": {
						"type": "String"
					}
				},
				"folder": {
					"name": "Oracle_SQLPOOL/Oracle_SQL_POOL_Group1"
				},
				"annotations": [],
				"lastPublishTime": "2023-02-08T11:25:30Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Childnotes_SQLPOOL')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "ForEach1",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "Lookup1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('Lookup1').output.value",
								"type": "Expression"
							},
							"isSequential": false,
							"activities": [
								{
									"name": "Childnotes",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [
										{
											"name": "Source",
											"value": "."
										},
										{
											"name": "Destination",
											"value": "betadata.stg_agreements"
										}
									],
									"typeProperties": {
										"source": {
											"type": "OracleSource",
											"oracleReaderQuery": {
												"value": "select * from BETADATA.CHILDNOTES\nwhere CN_MODIFIED>= TO_DATE('@{formatDateTime(pipeline().parameters.windowStart, 'yyyy-MM-dd HH:mm' )}', 'YYYY-MM-DD HH24:MI') \nAND CN_MODIFIED< TO_DATE('@{formatDateTime(pipeline().parameters.windowEnd, 'yyyy-MM-dd HH:mm' )}', 'YYYY-MM-DD HH24:MI')\nAND VPD_ID in @{item().vpd_list}",
												"type": "Expression"
											},
											"partitionOption": "None"
										},
										"sink": {
											"type": "SqlDWSink",
											"allowPolyBase": true,
											"polyBaseSettings": {
												"rejectValue": 0,
												"rejectType": "value",
												"useTypeDefault": false
											}
										},
										"enableStaging": true,
										"stagingSettings": {
											"linkedServiceName": {
												"referenceName": "AzureBlobStorage1",
												"type": "LinkedServiceReference"
											},
											"path": "vifiles"
										},
										"parallelCopies": 32,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "VPD_ID",
														"type": "Decimal"
													},
													"sink": {
														"name": "VPD_ID",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "CN_ID",
														"type": "String"
													},
													"sink": {
														"name": "CN_ID",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "CN_CREATED",
														"type": "DateTime"
													},
													"sink": {
														"name": "CN_CREATED",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"name": "CN_CREATED_LOCAL",
														"type": "DateTime"
													},
													"sink": {
														"name": "CN_CREATED_LOCAL",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"name": "CN_MODIFIED",
														"type": "DateTime"
													},
													"sink": {
														"name": "CN_MODIFIED",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"name": "CN_ACTIVE",
														"type": "String"
													},
													"sink": {
														"name": "CN_ACTIVE",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "CN_NOTE",
														"type": "String"
													},
													"sink": {
														"name": "CN_NOTE",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "E_ID",
														"type": "String"
													},
													"sink": {
														"name": "E_ID",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "MCD_ID",
														"type": "String"
													},
													"sink": {
														"name": "MCD_ID",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "TZL_ID_CREATED",
														"type": "String"
													},
													"sink": {
														"name": "TZL_ID_CREATED",
														"type": "String"
													}
												}
											]
										}
									},
									"inputs": [
										{
											"referenceName": "SRC_BETADATA_CHILDNOTES",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "SNK_SYN_DT_STG_CHILDNOTES_INCR",
											"type": "DatasetReference",
											"parameters": {}
										}
									]
								}
							]
						}
					},
					{
						"name": "Lookup1",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Truncate incr tables",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderStoredProcedureName": "[[abcpi].[GetVPDToLoad]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "AzureSynapseAnalyticsDB",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": false
						}
					},
					{
						"name": "Truncate incr tables",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "truncate table STGDATATRAK.stg_childnotes_incr;\nselect 0;",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "AzureSynapseAnalyticsDB",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Merge to Staging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "ForEach1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[StgDatatrak].[STG_CHILDNOTES_MERGE]"
						},
						"linkedServiceName": {
							"referenceName": "AzureSynapseAnalytics1",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"windowStart": {
						"type": "String"
					},
					"windowEnd": {
						"type": "String"
					}
				},
				"folder": {
					"name": "Oracle_SQLPOOL/Oracle_SQL_POOL_Group2"
				},
				"annotations": [],
				"lastPublishTime": "2023-02-08T11:25:32Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Club_Copy_SQLPOOL')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "ClubCopy_SQLPOOL",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "OracleSource",
								"oracleReaderQuery": "select\nb.*, a.cggrp, a.cgcpy, a.cgclb, coalesce(CGGRP,CLUB_ABC_COMPANY_NAME) as organization_name  \nfrom dw.club_vw b\nleft join DW.ABC400FIL_CGFILF_ABC_VW a\non b.club_number_i=a.club_number_i\nwhere coalesce(CGGRP,CLUB_ABC_COMPANY_NAME)   NOT LIKE 'ABC%'\nAND coalesce(CGGRP,CLUB_ABC_COMPANY_NAME)   NOT like '%TEST%'  ",
								"partitionOption": "None"
							},
							"sink": {
								"type": "SqlDWSink",
								"preCopyScript": "truncate table StgDatatrak.stg_clubs",
								"allowPolyBase": true,
								"polyBaseSettings": {
									"rejectValue": 0,
									"rejectType": "value",
									"useTypeDefault": false
								},
								"disableMetricsCollection": false
							},
							"enableStaging": true,
							"stagingSettings": {
								"linkedServiceName": {
									"referenceName": "AzureBlobStorage1",
									"type": "LinkedServiceReference"
								},
								"path": "vifiles"
							},
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "CLUB_KEY",
											"type": "Byte[]"
										},
										"sink": {
											"name": "CLUB_KEY",
											"type": "Byte[]"
										}
									},
									{
										"source": {
											"name": "COMP_KEY",
											"type": "Decimal"
										},
										"sink": {
											"name": "COMP_KEY",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "CLUB_NUMBER_A",
											"type": "String"
										},
										"sink": {
											"name": "CLUB_NUMBER_A",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "CLUB_NUMBER_I",
											"type": "Decimal"
										},
										"sink": {
											"name": "CLUB_NUMBER_I",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "CLUB_NAME",
											"type": "String"
										},
										"sink": {
											"name": "CLUB_NAME",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "CLUB_ADDRESS_1",
											"type": "String"
										},
										"sink": {
											"name": "CLUB_ADDRESS_1",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "CLUB_ADDRESS_2",
											"type": "String"
										},
										"sink": {
											"name": "CLUB_ADDRESS_2",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "CLUB_CITY",
											"type": "String"
										},
										"sink": {
											"name": "CLUB_CITY",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "CLUB_STATE",
											"type": "String"
										},
										"sink": {
											"name": "CLUB_STATE",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "CLUB_ZIP",
											"type": "String"
										},
										"sink": {
											"name": "CLUB_ZIP",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "CLUB_ACTIVE",
											"type": "String"
										},
										"sink": {
											"name": "CLUB_ACTIVE",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "COMP_NAME",
											"type": "String"
										},
										"sink": {
											"name": "COMP_NAME",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "COMP_NUMBER",
											"type": "String"
										},
										"sink": {
											"name": "COMP_NUMBER",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "COMP_ADDRESS_1",
											"type": "String"
										},
										"sink": {
											"name": "COMP_ADDRESS_1",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "COMP_ADDRESS_2",
											"type": "String"
										},
										"sink": {
											"name": "COMP_ADDRESS_2",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "COMP_CITY",
											"type": "String"
										},
										"sink": {
											"name": "COMP_CITY",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "COMP_STATE",
											"type": "String"
										},
										"sink": {
											"name": "COMP_STATE",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "COMP_ZIP",
											"type": "String"
										},
										"sink": {
											"name": "COMP_ZIP",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "COMP_ACTIVE",
											"type": "String"
										},
										"sink": {
											"name": "COMP_ACTIVE",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "CLUB_PRESALE",
											"type": "String"
										},
										"sink": {
											"name": "CLUB_PRESALE",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "CLUB_VISIBLE",
											"type": "String"
										},
										"sink": {
											"name": "CLUB_VISIBLE",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "CLUB_ABC_COMPANY_NAME",
											"type": "String"
										},
										"sink": {
											"name": "CLUB_ABC_COMPANY_NAME",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "CLUB_ENTERED_DATE",
											"type": "DateTime"
										},
										"sink": {
											"name": "CLUB_ENTERED_DATE",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "CLUB_ABC_NAME",
											"type": "String"
										},
										"sink": {
											"name": "CLUB_ABC_NAME",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "CORP_NAME",
											"type": "String"
										},
										"sink": {
											"name": "CORP_NAME",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "CORP_TRANSFER_TOTAL_CHECK_INS",
											"type": "Decimal"
										},
										"sink": {
											"name": "CORP_TRANSFER_TOTAL_CHECK_INS",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "CORP_TRANSFER_PERCENT",
											"type": "Decimal"
										},
										"sink": {
											"name": "CORP_TRANSFER_PERCENT",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "CLUB_OPEN_DATE",
											"type": "DateTime"
										},
										"sink": {
											"name": "CLUB_OPEN_DATE",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "CLUBPAYMODE_KEY",
											"type": "String"
										},
										"sink": {
											"name": "CLUBPAYMODE_KEY",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "TZ_KEY",
											"type": "String"
										},
										"sink": {
											"name": "TZ_KEY",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "COMP_VPD_ID",
											"type": "Decimal"
										},
										"sink": {
											"name": "COMP_VPD_ID",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "LATITUDE",
											"type": "Decimal"
										},
										"sink": {
											"name": "LATITUDE",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "LONGITUDE",
											"type": "Decimal"
										},
										"sink": {
											"name": "LONGITUDE",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "CGGRP",
											"type": "String"
										},
										"sink": {
											"name": "CGGRP",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "CGCPY",
											"type": "String"
										},
										"sink": {
											"name": "CGCPY",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "CGCLB",
											"type": "Decimal"
										},
										"sink": {
											"name": "CGCLB",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ORGANIZATION_NAME",
											"type": "String"
										},
										"sink": {
											"name": "ORGANIZATION_NAME",
											"type": "String"
										}
									}
								]
							}
						},
						"inputs": [
							{
								"referenceName": "SourceDataset_5sa",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "SNK_SYN_DT_CLUBS",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"folder": {
					"name": "Oracle_SQLPOOL/Oracle_SQL_POOL_GroupNoDate"
				},
				"annotations": [],
				"lastPublishTime": "2023-02-08T11:25:31Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/DW_EFT_RECONCILIATION_DIFF_VW')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Copy data1",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Truncate table Sink",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "OracleSource",
								"oracleReaderQuery": "SELECT *\nFROM DW.DW_EFT_RECONCILIATION_DIFF_VW",
								"partitionOption": "None",
								"queryTimeout": "02:00:00"
							},
							"sink": {
								"type": "SqlDWSink",
								"maxConcurrentConnections": 6,
								"allowPolyBase": true,
								"polyBaseSettings": {
									"rejectValue": 0,
									"rejectType": "value",
									"useTypeDefault": true
								},
								"disableMetricsCollection": false
							},
							"enableStaging": true,
							"stagingSettings": {
								"linkedServiceName": {
									"referenceName": "AzureBlobStorage1",
									"type": "LinkedServiceReference"
								},
								"path": "pfviewsoracle",
								"enableCompression": true
							},
							"parallelCopies": 8,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "CNDOB_YYYYMMDD",
											"type": "Double"
										},
										"sink": {
											"name": "CNDOB_YYYYMMDD",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "STATUS",
											"type": "String"
										},
										"sink": {
											"name": "STATUS",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "CLUB_NUMBER_I",
											"type": "Decimal"
										},
										"sink": {
											"name": "CLUB_NUMBER_I",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "ETL_DATE_KEY",
											"type": "Decimal"
										},
										"sink": {
											"name": "ETL_DATE_KEY",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "CBCLB",
											"type": "Decimal"
										},
										"sink": {
											"name": "CBCLB",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "CBNME",
											"type": "String"
										},
										"sink": {
											"name": "CBNME",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "CWMBR",
											"type": "Decimal"
										},
										"sink": {
											"name": "CWMBR",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "CNLNM",
											"type": "String"
										},
										"sink": {
											"name": "CNLNM",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "CNFNM",
											"type": "String"
										},
										"sink": {
											"name": "CNFNM",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "CNMTC",
											"type": "String"
										},
										"sink": {
											"name": "CNMTC",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "CIDTE",
											"type": "Decimal"
										},
										"sink": {
											"name": "CIDTE",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "CWBDT",
											"type": "Decimal"
										},
										"sink": {
											"name": "CWBDT",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "CWTYP",
											"type": "String"
										},
										"sink": {
											"name": "CWTYP",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "CWMDE",
											"type": "String"
										},
										"sink": {
											"name": "CWMDE",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "CWFRQ",
											"type": "String"
										},
										"sink": {
											"name": "CWFRQ",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "CWAGE",
											"type": "String"
										},
										"sink": {
											"name": "CWAGE",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "CWTF4",
											"type": "String"
										},
										"sink": {
											"name": "CWTF4",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "CWSTD",
											"type": "Decimal"
										},
										"sink": {
											"name": "CWSTD",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "CWSTC",
											"type": "String"
										},
										"sink": {
											"name": "CWSTC",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "CWASC",
											"type": "String"
										},
										"sink": {
											"name": "CWASC",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "CWAST",
											"type": "String"
										},
										"sink": {
											"name": "CWAST",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "CURRENT_CDCDA",
											"type": "Decimal"
										},
										"sink": {
											"name": "CURRENT_CDCDA",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "PREVIOUS_CDCDA",
											"type": "Decimal"
										},
										"sink": {
											"name": "PREVIOUS_CDCDA",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "CDCCTCODE",
											"type": "String"
										},
										"sink": {
											"name": "CDCCTCODE",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "CDDTE",
											"type": "Decimal"
										},
										"sink": {
											"name": "CDDTE",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "CDTYP",
											"type": "String"
										},
										"sink": {
											"name": "CDTYP",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "NEXT_INVOICE_DATE",
											"type": "Double"
										},
										"sink": {
											"name": "NEXT_INVOICE_DATE",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "CURRENT_STDSC",
											"type": "String"
										},
										"sink": {
											"name": "CURRENT_STDSC",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PREVIOUS_STDSC",
											"type": "String"
										},
										"sink": {
											"name": "PREVIOUS_STDSC",
											"type": "String"
										}
									}
								]
							}
						},
						"inputs": [
							{
								"referenceName": "SRC_DW_EFT_RECONCILIATION_DIFF_VW",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "SNK_SYN_DW_EFT_RECONCILIATION_DIFF",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Truncate table Sink",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Check Did Job Success",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "TRUNCATE TABLE [DW].[DW_EFT_RECONCILIATION_DIFF];\r\nselect 1;",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "SNK_SYN_DW_EFT_RECONCILIATION_DIFF",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": false
						}
					},
					{
						"name": "Get Job Status",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "select 1\nfrom [dbo].[PF_VIEWS_JOBS_CHECK] \nwhere finish_time = cast(GETDATE() AT TIME ZONE 'UTC' AT TIME ZONE 'Eastern Standard Time' AS DATE) \nand FBI_JOB_NAME= 'EFT_RECONCILIATION_SMRY' and job_completed=1",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "SNK_DBO_PF_VIEWS_JOBS_CHECK",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "check Oracle Job",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Get Job Status",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "OracleSource",
								"oracleReaderQuery": "select JOB_NAME,START_TIME,FINISH_TIME,STATUS, 'PF.EFT_RECONCILIATION_SMRY' as FBI_JOB_NAME \r\nfrom dw.job_monitoring_vw \r\nwhere job_name = 'PF.EFT_RECONCILIATION_SMRY' and status = 'SUCCESS' and to_date(finish_time,'YYYY/MM/DD HH24:MI:SS') > trunc(sysdate)",
								"partitionOption": "None",
								"queryTimeout": "02:00:00"
							},
							"dataset": {
								"referenceName": "OracleTable1",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Check Did Job Success",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "check Oracle Job",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "select count(*) from pf_views_jobs_check \nwhere job_name = 'PF.EFT_RECONCILIATION_SMRY' and \n    status = 'SUCCESS' and cast(finish_time as date)=cast(GETDATE() AT TIME ZONE 'UTC' AT TIME ZONE 'Eastern Standard Time' AS DATE)\n    and FBI_JOB_NAME='PF.EFT_RECONCILIATION_SMRY'",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "SNK_DBO_PF_VIEWS_JOBS_CHECK",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Update Job Status",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Copy data1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "UPDATE [DW].[DW_EFT_RECONCILIATION_DIFF]\nSET AS_OF = GETDATE();\nSELECT 1\n",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "SNK_DBO_PF_VIEWS_JOBS_CHECK",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"folder": {
					"name": "EDW_DW_SQL_POOL"
				},
				"annotations": [],
				"lastPublishTime": "2023-02-23T16:21:18Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/DW_EFT_RECONCILIATION_DTL_VW')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Truncate table Sink",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Check Did Job Success",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "TRUNCATE TABLE [DW].[DW_EFT_RECONCILIATION_DTL];\nselect 1;",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "SNK_SVN_DW_EFT_RECONCILIATION_DTL",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": true
						}
					},
					{
						"name": "Get Job Status",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "select 1\nfrom [dbo].[PF_VIEWS_JOBS_CHECK] \nwhere finish_time = cast(GETDATE() AT TIME ZONE 'UTC' AT TIME ZONE 'Eastern Standard Time' AS DATE) \nand FBI_JOB_NAME= 'EFT_RECONCILIATION_SMRY' and job_completed=1",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "SNK_DBO_PF_VIEWS_JOBS_CHECK",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "check Oracle Job",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Get Job Status",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "OracleSource",
								"oracleReaderQuery": "select JOB_NAME,START_TIME,FINISH_TIME,STATUS, 'PF.EFT_RECONCILIATION_SMRY' as FBI_JOB_NAME \r\nfrom dw.job_monitoring_vw \r\nwhere job_name = 'PF.EFT_RECONCILIATION_SMRY' and status = 'SUCCESS' and to_date(finish_time,'YYYY/MM/DD HH24:MI:SS') > trunc(sysdate)",
								"partitionOption": "None",
								"queryTimeout": "02:00:00"
							},
							"dataset": {
								"referenceName": "OracleTable1",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Check Did Job Success",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "check Oracle Job",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "select count(*) from pf_views_jobs_check \nwhere job_name = 'PF.EFT_RECONCILIATION_SMRY' and \n    status = 'SUCCESS' and cast(finish_time as date)=cast(GETDATE() AT TIME ZONE 'UTC' AT TIME ZONE 'Eastern Standard Time' AS DATE)\n    and FBI_JOB_NAME='PF.EFT_RECONCILIATION_SMRY'",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "SNK_DBO_PF_VIEWS_JOBS_CHECK",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Update Job Status",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "ForEach1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "UPDATE [DW].[DW_EFT_RECONCILIATION_DTL]\nSET AS_OF = GETDATE();\nSELECT 1\n",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "SNK_DBO_PF_VIEWS_JOBS_CHECK",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "ForEach1",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "Lookup1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('Lookup1').output.value",
								"type": "Expression"
							},
							"isSequential": false,
							"activities": [
								{
									"name": "dw_",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "OracleSource",
											"oracleReaderQuery": {
												"value": "SELECT *\nFROM DW.DW_EFT_RECONCILIATION_DTL_VW\nWHERE CBCLB in @{item().cbcpy_list} ",
												"type": "Expression"
											},
											"partitionOption": "None",
											"convertDecimalToInteger": false,
											"queryTimeout": "24:00:00"
										},
										"sink": {
											"type": "SqlDWSink",
											"writeBatchTimeout": "10:23:00",
											"maxConcurrentConnections": 6,
											"allowPolyBase": true,
											"polyBaseSettings": {
												"rejectValue": 0,
												"rejectType": "value",
												"useTypeDefault": false
											},
											"disableMetricsCollection": false
										},
										"enableStaging": true,
										"stagingSettings": {
											"linkedServiceName": {
												"referenceName": "AzureBlobStorage1",
												"type": "LinkedServiceReference"
											},
											"path": "vifiles",
											"enableCompression": true
										},
										"parallelCopies": 8,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "ETL_DATE_KEY",
														"type": "Decimal"
													},
													"sink": {
														"name": "ETL_DATE_KEY",
														"type": "Single"
													}
												},
												{
													"source": {
														"name": "ETL_DATETIME",
														"type": "DateTime"
													},
													"sink": {
														"name": "ETL_DATETIME",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"name": "CLUB_NUMBER_I",
														"type": "Decimal"
													},
													"sink": {
														"name": "CLUB_NUMBER_I",
														"type": "Single"
													}
												},
												{
													"source": {
														"name": "CBCLB",
														"type": "Decimal"
													},
													"sink": {
														"name": "CBCLB",
														"type": "Single"
													}
												},
												{
													"source": {
														"name": "CBNME",
														"type": "String"
													},
													"sink": {
														"name": "CBNME",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "CGGRPM",
														"type": "String"
													},
													"sink": {
														"name": "CGGRPM",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "CGNMEM",
														"type": "String"
													},
													"sink": {
														"name": "CGNMEM",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "CWCLB",
														"type": "Decimal"
													},
													"sink": {
														"name": "CWCLB",
														"type": "Single"
													}
												},
												{
													"source": {
														"name": "CWMBR",
														"type": "Decimal"
													},
													"sink": {
														"name": "CWMBR",
														"type": "Single"
													}
												},
												{
													"source": {
														"name": "CWTYP",
														"type": "String"
													},
													"sink": {
														"name": "CWTYP",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "CWMDE",
														"type": "String"
													},
													"sink": {
														"name": "CWMDE",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "CWFRQ",
														"type": "String"
													},
													"sink": {
														"name": "CWFRQ",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "CWSTC",
														"type": "String"
													},
													"sink": {
														"name": "CWSTC",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "CWSTD",
														"type": "Decimal"
													},
													"sink": {
														"name": "CWSTD",
														"type": "Single"
													}
												},
												{
													"source": {
														"name": "CWBDT",
														"type": "Decimal"
													},
													"sink": {
														"name": "CWBDT",
														"type": "Single"
													}
												},
												{
													"source": {
														"name": "CWNDD",
														"type": "Decimal"
													},
													"sink": {
														"name": "CWNDD",
														"type": "Single"
													}
												},
												{
													"source": {
														"name": "CWAGE",
														"type": "String"
													},
													"sink": {
														"name": "CWAGE",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "CWTF4",
														"type": "String"
													},
													"sink": {
														"name": "CWTF4",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "CNFNM",
														"type": "String"
													},
													"sink": {
														"name": "CNFNM",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "CNMI",
														"type": "String"
													},
													"sink": {
														"name": "CNMI",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "CNLNM",
														"type": "String"
													},
													"sink": {
														"name": "CNLNM",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "CNMTC",
														"type": "String"
													},
													"sink": {
														"name": "CNMTC",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "CDDTE",
														"type": "Decimal"
													},
													"sink": {
														"name": "CDDTE",
														"type": "Single"
													}
												},
												{
													"source": {
														"name": "CDCDA",
														"type": "Decimal"
													},
													"sink": {
														"name": "CDCDA",
														"type": "Single"
													}
												},
												{
													"source": {
														"name": "CDTYP",
														"type": "String"
													},
													"sink": {
														"name": "CDTYP",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "CDWAV",
														"type": "String"
													},
													"sink": {
														"name": "CDWAV",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "CDCCTCODE",
														"type": "String"
													},
													"sink": {
														"name": "CDCCTCODE",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "STDSC",
														"type": "String"
													},
													"sink": {
														"name": "STDSC",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "CIDTE",
														"type": "Decimal"
													},
													"sink": {
														"name": "CIDTE",
														"type": "Single"
													}
												},
												{
													"source": {
														"name": "NEXT_INVOICE_DATE",
														"type": "Double"
													},
													"sink": {
														"name": "NEXT_INVOICE_DATE",
														"type": "Single"
													}
												},
												{
													"source": {
														"name": "CNDOB_YYYYMMDD",
														"type": "Double"
													},
													"sink": {
														"name": "CNDOB_YYYYMMDD",
														"type": "Single"
													}
												}
											]
										}
									},
									"inputs": [
										{
											"referenceName": "SRC_DW_EFT_RECONCILIATION_DTL_VW",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "SNK_SVN_DW_EFT_RECONCILIATION_DTL",
											"type": "DatasetReference",
											"parameters": {}
										}
									]
								}
							]
						}
					},
					{
						"name": "Lookup1",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Truncate table Sink",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderStoredProcedureName": "[[abcpi].[GetClubToLoad_300]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "AzureSynapseAnalyticsDB",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": false
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"folder": {
					"name": "EDW_DW_SQL_POOL"
				},
				"annotations": [],
				"lastPublishTime": "2023-02-23T16:21:18Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/DW_EFT_RECONCILIATION_SMRY_VW')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Copy data1",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Truncate table Sink",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "OracleSource",
								"oracleReaderQuery": "SELECT *\nFROM DW.DW_EFT_RECONCILIATION_SMRY_VW",
								"partitionOption": "None",
								"queryTimeout": "02:00:00"
							},
							"sink": {
								"type": "SqlDWSink",
								"maxConcurrentConnections": 6,
								"allowPolyBase": true,
								"polyBaseSettings": {
									"rejectValue": 0,
									"rejectType": "value",
									"useTypeDefault": true
								},
								"disableMetricsCollection": false
							},
							"enableStaging": true,
							"stagingSettings": {
								"linkedServiceName": {
									"referenceName": "AzureBlobStorage1",
									"type": "LinkedServiceReference"
								},
								"path": "pfviewsoracle",
								"enableCompression": true
							},
							"parallelCopies": 8,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "ETL_DATE_KEY",
											"type": "Decimal"
										},
										"sink": {
											"name": "ETL_DATE_KEY",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "CLUB_NUMBER_I",
											"type": "Decimal"
										},
										"sink": {
											"name": "CLUB_NUMBER_I",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "CLUB_NAME",
											"type": "String"
										},
										"sink": {
											"name": "CLUB_NAME",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PROFIT_CENTER",
											"type": "String"
										},
										"sink": {
											"name": "PROFIT_CENTER",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "INVOICE_AMOUNT",
											"type": "Double"
										},
										"sink": {
											"name": "INVOICE_AMOUNT",
											"type": "Single"
										}
									}
								]
							}
						},
						"inputs": [
							{
								"referenceName": "SRC_DW_EFT_RECONCILIATION_SMRY_VW",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "SNK_SYN_DW_EFT_RECONCILIATION_SMRY",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Truncate table Sink",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Check Did Job Success",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "TRUNCATE TABLE [DW].[DW_EFT_RECONCILIATION_SMRY];\nselect 1;",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "SNK_SYN_DW_EFT_RECONCILIATION_SMRY",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": true
						}
					},
					{
						"name": "Get Job Status",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "select 1\nfrom [dbo].[PF_VIEWS_JOBS_CHECK] \nwhere finish_time = cast(GETDATE() AT TIME ZONE 'UTC' AT TIME ZONE 'Eastern Standard Time' AS DATE) \nand FBI_JOB_NAME= 'EFT_RECONCILIATION_SMRY' and job_completed=1",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "SNK_DBO_PF_VIEWS_JOBS_CHECK",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "check Oracle Job",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Get Job Status",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "OracleSource",
								"oracleReaderQuery": "select JOB_NAME,START_TIME,FINISH_TIME,STATUS, 'PF.EFT_RECONCILIATION_SMRY' as FBI_JOB_NAME \r\nfrom dw.job_monitoring_vw \r\nwhere job_name = 'PF.EFT_RECONCILIATION_SMRY' and status = 'SUCCESS' and to_date(finish_time,'YYYY/MM/DD HH24:MI:SS') > trunc(sysdate)",
								"partitionOption": "None",
								"queryTimeout": "02:00:00"
							},
							"dataset": {
								"referenceName": "OracleTable1",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Check Did Job Success",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "check Oracle Job",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "select count(*) from pf_views_jobs_check \nwhere job_name = 'PF.EFT_RECONCILIATION_SMRY' and \n    status = 'SUCCESS' and cast(finish_time as date)=cast(GETDATE() AT TIME ZONE 'UTC' AT TIME ZONE 'Eastern Standard Time' AS DATE)\n    and FBI_JOB_NAME='PF.EFT_RECONCILIATION_SMRY'",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "SNK_DBO_PF_VIEWS_JOBS_CHECK",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Update Job Status",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Copy data1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "UPDATE [DW].[DW_EFT_RECONCILIATION_SMRY]\nSET AS_OF = GETDATE();\nSELECT 1\n",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "SNK_DBO_PF_VIEWS_JOBS_CHECK",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"folder": {
					"name": "EDW_DW_SQL_POOL"
				},
				"annotations": [],
				"lastPublishTime": "2023-02-23T16:21:18Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/DW_PF_ACTIVE_MEMBERS_SMRY_VW')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Delete Max Date records",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Check Did Job Success",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "DELETE\nfrom [DW].[PF_ACTIVE_MEMBERS_SMRY] \nwhere etl_date_key = (select max(etl_date_key) from [DW].[PF_ACTIVE_MEMBERS_SMRY]) ;\nSELECT 1;\n\n\n",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "SNK_SVN_DW_PF_ACTIVE_MEMBERS_SMRY",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": true
						}
					},
					{
						"name": "Get Job Status",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "select 1\nfrom [dbo].[PF_VIEWS_JOBS_CHECK] \nwhere finish_time = cast(GETDATE() AT TIME ZONE 'UTC' AT TIME ZONE 'Eastern Standard Time' AS DATE) \nand FBI_JOB_NAME= 'EFT_RECONCILIATION_SMRY' and job_completed=1",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "SNK_DBO_PF_VIEWS_JOBS_CHECK",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "check Oracle Job",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Get Job Status",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "OracleSource",
								"oracleReaderQuery": "select JOB_NAME,START_TIME,FINISH_TIME,STATUS, 'PF.EFT_RECONCILIATION_SMRY' as FBI_JOB_NAME \r\nfrom dw.job_monitoring_vw \r\nwhere job_name = 'PF.EFT_RECONCILIATION_SMRY' and status = 'SUCCESS' and to_date(finish_time,'YYYY/MM/DD HH24:MI:SS') > trunc(sysdate)",
								"partitionOption": "None",
								"queryTimeout": "02:00:00"
							},
							"dataset": {
								"referenceName": "OracleTable1",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Check Did Job Success",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "check Oracle Job",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "select count(*) from pf_views_jobs_check \nwhere job_name = 'PF.EFT_RECONCILIATION_SMRY' and \n    status = 'SUCCESS' and cast(finish_time as date)=cast(GETDATE() AT TIME ZONE 'UTC' AT TIME ZONE 'Eastern Standard Time' AS DATE)\n    and FBI_JOB_NAME='PF.EFT_RECONCILIATION_SMRY'",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "SNK_DBO_PF_VIEWS_JOBS_CHECK",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Update Job Status",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "ForEach1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "UPDATE [DW].[PF_ACTIVE_MEMBERS_SMRY]\nSET AS_OF = GETDATE();\nSELECT 1\n",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "SNK_DBO_PF_VIEWS_JOBS_CHECK",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "ForEach1",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "Lookup1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('Lookup1').output.value",
								"type": "Expression"
							},
							"isSequential": false,
							"activities": [
								{
									"name": "DW_TEST_DW_PF_ACTIVE_MEMBERS_SMRY_VW",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "OracleSource",
											"oracleReaderQuery": {
												"value": "SELECT *\nFROM DW.PF_ACTIVE_MEMBERS_SMRY_VW\nWHERE CLUB_NUMBER_I in @{item().cbcpy_list} AND\nETL_DATE_KEY >= to_number(@{pipeline().parameters.windowStart})",
												"type": "Expression"
											},
											"partitionOption": "None",
											"convertDecimalToInteger": false,
											"queryTimeout": "02:00:00"
										},
										"sink": {
											"type": "SqlDWSink",
											"maxConcurrentConnections": 6,
											"allowPolyBase": true,
											"polyBaseSettings": {
												"rejectValue": 0,
												"rejectType": "value",
												"useTypeDefault": false
											},
											"disableMetricsCollection": false
										},
										"enableStaging": true,
										"stagingSettings": {
											"linkedServiceName": {
												"referenceName": "AzureBlobStorage1",
												"type": "LinkedServiceReference"
											},
											"path": "vifiles",
											"enableCompression": true
										},
										"parallelCopies": 8,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "ETL_DATE_KEY",
														"type": "Decimal"
													},
													"sink": {
														"name": "ETL_DATE_KEY",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "CLUB_NUMBER_I",
														"type": "Decimal"
													},
													"sink": {
														"name": "CLUB_NUMBER_I",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "ACTIVE_MEMBERS",
														"type": "String"
													},
													"sink": {
														"name": "ACTIVE_MEMBERS",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "TOTAL_COUNT",
														"type": "Double"
													},
													"sink": {
														"name": "TOTAL_COUNT",
														"type": "Single"
													}
												},
												{
													"source": {
														"name": "TOTAL_AMOUNT",
														"type": "Double"
													},
													"sink": {
														"name": "TOTAL_AMOUNT",
														"type": "Single"
													}
												}
											]
										}
									},
									"inputs": [
										{
											"referenceName": "SRC_DW_PF_ACTIVE_MEMBERS_SMRY_VW",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "SNK_SVN_DW_PF_ACTIVE_MEMBERS_SMRY",
											"type": "DatasetReference",
											"parameters": {}
										}
									]
								}
							]
						}
					},
					{
						"name": "Lookup1",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Delete Max Date records",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderStoredProcedureName": "[[abcpi].[GetClubToLoad_300]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "AzureSynapseAnalyticsDB",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": false
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"windowStart": {
						"type": "string"
					}
				},
				"folder": {
					"name": "EDW_DW_SQL_POOL"
				},
				"annotations": [],
				"lastPublishTime": "2023-02-23T16:21:18Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/DW_PF_GENDER_SMRY_VW')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "delete max date records",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Check Did Job Success",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "DELETE\nfrom [DW].[PF_GENDER_SMRY] \nwhere etl_date_key = (select max(etl_date_key) from [DW].[PF_GENDER_SMRY]) \nAND SOURCE='EDW';\nSELECT 1;\n\n",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "SNK_SVN_DW_PF_GENDER_SMRY",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": true
						}
					},
					{
						"name": "Get Job Status",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "select 1\nfrom [dbo].[PF_VIEWS_JOBS_CHECK] \nwhere finish_time = cast(GETDATE() AT TIME ZONE 'UTC' AT TIME ZONE 'Eastern Standard Time' AS DATE) \nand FBI_JOB_NAME= 'EFT_RECONCILIATION_SMRY' and job_completed=1",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "SNK_DBO_PF_VIEWS_JOBS_CHECK",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "check Oracle Job",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Get Job Status",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "OracleSource",
								"oracleReaderQuery": "select JOB_NAME,START_TIME,FINISH_TIME,STATUS, 'PF.EFT_RECONCILIATION_SMRY' as FBI_JOB_NAME \r\nfrom dw.job_monitoring_vw \r\nwhere job_name = 'PF.EFT_RECONCILIATION_SMRY' and status = 'SUCCESS' and to_date(finish_time,'YYYY/MM/DD HH24:MI:SS') > trunc(sysdate)",
								"partitionOption": "None",
								"queryTimeout": "02:00:00"
							},
							"dataset": {
								"referenceName": "OracleTable1",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Check Did Job Success",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "check Oracle Job",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "select count(*) from pf_views_jobs_check \nwhere job_name = 'PF.EFT_RECONCILIATION_SMRY' and \n    status = 'SUCCESS' and cast(finish_time as date)=cast(GETDATE() AT TIME ZONE 'UTC' AT TIME ZONE 'Eastern Standard Time' AS DATE)\n    and FBI_JOB_NAME='PF.EFT_RECONCILIATION_SMRY'",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "SNK_DBO_PF_VIEWS_JOBS_CHECK",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Update Job Status",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "ForEach1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "UPDATE [DW].[PF_GENDER_SMRY]\nSET AS_OF = GETDATE()\nWHERE SOURCE='EDW';\nSELECT 1\n",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "SNK_DBO_PF_VIEWS_JOBS_CHECK",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "ForEach1",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "Lookup1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('Lookup1').output.value",
								"type": "Expression"
							},
							"isSequential": false,
							"activities": [
								{
									"name": "PF_GENDER_SMRY_VW",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "OracleSource",
											"oracleReaderQuery": {
												"value": "SELECT ETL_DATE_KEY\n      ,CLUB_NUMBER_I\n      ,GENDER\n      ,coalesce(TOTAL_COUNT,0) as TOTAL_COUNT\n      ,'EDW' as Source\nFROM DW.PF_GENDER_SMRY_VW\nWHERE CLUB_NUMBER_I in @{item().cbcpy_list} AND\nETL_DATE_KEY >= to_number(@{pipeline().parameters.windowStart})\n\n",
												"type": "Expression"
											},
											"partitionOption": "None",
											"convertDecimalToInteger": false,
											"queryTimeout": "02:00:00"
										},
										"sink": {
											"type": "SqlDWSink",
											"maxConcurrentConnections": 6,
											"allowPolyBase": true,
											"polyBaseSettings": {
												"rejectValue": 0,
												"rejectType": "value",
												"useTypeDefault": false
											},
											"disableMetricsCollection": false
										},
										"enableStaging": true,
										"stagingSettings": {
											"linkedServiceName": {
												"referenceName": "AzureBlobStorage1",
												"type": "LinkedServiceReference"
											},
											"path": "pfviewsoracle",
											"enableCompression": true
										},
										"parallelCopies": 8,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "ETL_DATE_KEY",
														"type": "Decimal"
													},
													"sink": {
														"name": "ETL_DATE_KEY",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "CLUB_NUMBER_I",
														"type": "Decimal"
													},
													"sink": {
														"name": "CLUB_NUMBER_I",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "GENDER",
														"type": "String"
													},
													"sink": {
														"name": "GENDER",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "TOTAL_COUNT",
														"type": "Double"
													},
													"sink": {
														"name": "TOTAL_COUNT",
														"type": "Single"
													}
												},
												{
													"source": {
														"name": "SOURCE",
														"type": "String"
													},
													"sink": {
														"name": "Source",
														"type": "String"
													}
												}
											]
										}
									},
									"inputs": [
										{
											"referenceName": "SRC_DW_PF_GENDER_SMRY_VW",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "SNK_SVN_DW_PF_GENDER_SMRY",
											"type": "DatasetReference",
											"parameters": {}
										}
									]
								}
							]
						}
					},
					{
						"name": "Lookup1",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "delete max date records",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderStoredProcedureName": "[[abcpi].[GetClubToLoad_300]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "AzureSynapseAnalyticsDB",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": false
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"windowStart": {
						"type": "string"
					}
				},
				"folder": {
					"name": "EDW_DW_SQL_POOL"
				},
				"annotations": [],
				"lastPublishTime": "2023-02-23T16:21:18Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/DW_PF_MEMBERSHIP_TYPE_SMRY_VW')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Delete MAx date records",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Check Did Job Success",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "DELETE\nfrom [DW].[PF_MEMBERSHIP_TYPE_SMRY] \nwhere etl_date_key = (select max(etl_date_key) from [DW].[PF_MEMBERSHIP_TYPE_SMRY]) ;\nSELECT 1;\n",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "SNK_SVN_PF_MEMERSHIP_TYPE_SMRY",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": true
						}
					},
					{
						"name": "Get Job Status",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "select 1\nfrom [dbo].[PF_VIEWS_JOBS_CHECK] \nwhere finish_time = cast(GETDATE() AT TIME ZONE 'UTC' AT TIME ZONE 'Eastern Standard Time' AS DATE) \nand FBI_JOB_NAME= 'EFT_RECONCILIATION_SMRY' and job_completed=1",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "SNK_DBO_PF_VIEWS_JOBS_CHECK",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "check Oracle Job",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Get Job Status",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "OracleSource",
								"oracleReaderQuery": "select JOB_NAME,START_TIME,FINISH_TIME,STATUS, 'PF.EFT_RECONCILIATION_SMRY' as FBI_JOB_NAME \r\nfrom dw.job_monitoring_vw \r\nwhere job_name = 'PF.EFT_RECONCILIATION_SMRY' and status = 'SUCCESS' and to_date(finish_time,'YYYY/MM/DD HH24:MI:SS') > trunc(sysdate)",
								"partitionOption": "None",
								"queryTimeout": "02:00:00"
							},
							"dataset": {
								"referenceName": "OracleTable1",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Check Did Job Success",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "check Oracle Job",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "select count(*) from pf_views_jobs_check \nwhere job_name = 'PF.EFT_RECONCILIATION_SMRY' and \n    status = 'SUCCESS' and cast(finish_time as date)=cast(GETDATE() AT TIME ZONE 'UTC' AT TIME ZONE 'Eastern Standard Time' AS DATE)\n    and FBI_JOB_NAME='PF.EFT_RECONCILIATION_SMRY'",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "SNK_DBO_PF_VIEWS_JOBS_CHECK",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Update Job Status",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "ForEach1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "UPDATE [DW].[PF_MEMBERSHIP_TYPE_SMRY]\nSET AS_OF = GETDATE();\nSELECT 1\n",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "SNK_DBO_PF_VIEWS_JOBS_CHECK",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "ForEach1",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "Lookup1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('Lookup1').output.value",
								"type": "Expression"
							},
							"isSequential": false,
							"activities": [
								{
									"name": "PF_MEMBERSHIP_TYPE_SMRY_VW",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "OracleSource",
											"oracleReaderQuery": {
												"value": "SELECT *\nFROM DW.PF_MEMBERSHIP_TYPE_SMRY_VW\nWHERE CLUB_NUMBER_I in @{item().cbcpy_list} AND\nETL_DATE_KEY >= to_number(@{pipeline().parameters.windowStart})",
												"type": "Expression"
											},
											"partitionOption": "None",
											"convertDecimalToInteger": false,
											"queryTimeout": "02:00:00"
										},
										"sink": {
											"type": "SqlDWSink",
											"maxConcurrentConnections": 6,
											"allowPolyBase": true,
											"polyBaseSettings": {
												"rejectValue": 0,
												"rejectType": "value",
												"useTypeDefault": false
											},
											"disableMetricsCollection": false
										},
										"enableStaging": true,
										"stagingSettings": {
											"linkedServiceName": {
												"referenceName": "AzureBlobStorage1",
												"type": "LinkedServiceReference"
											},
											"path": "pfviewsoracle",
											"enableCompression": true
										},
										"parallelCopies": 8,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "RFC_AMOUNT",
														"type": "Decimal"
													},
													"sink": {
														"name": "RFC_AMOUNT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "EXPIRE_COUNT",
														"type": "Decimal"
													},
													"sink": {
														"name": "EXPIRE_COUNT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "EXPIRE_AMOUNT",
														"type": "Decimal"
													},
													"sink": {
														"name": "EXPIRE_AMOUNT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "TRANSFER_IN_COUNT",
														"type": "Decimal"
													},
													"sink": {
														"name": "TRANSFER_IN_COUNT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "TRANSFER_IN_AMOUNT",
														"type": "Decimal"
													},
													"sink": {
														"name": "TRANSFER_IN_AMOUNT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "TRANSFER_OUT_COUNT",
														"type": "Decimal"
													},
													"sink": {
														"name": "TRANSFER_OUT_COUNT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "TRANSFER_OUT_AMOUNT",
														"type": "Decimal"
													},
													"sink": {
														"name": "TRANSFER_OUT_AMOUNT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "VOLUNTARY_CANCEL_COUNT",
														"type": "Decimal"
													},
													"sink": {
														"name": "VOLUNTARY_CANCEL_COUNT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "VOLUNTARY_CANCEL_AMOUNT",
														"type": "Decimal"
													},
													"sink": {
														"name": "VOLUNTARY_CANCEL_AMOUNT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "INVOLUNTARY_CANCEL_COUNT",
														"type": "Decimal"
													},
													"sink": {
														"name": "INVOLUNTARY_CANCEL_COUNT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "INVOLUNTARY_CANCEL_AMOUNT",
														"type": "Decimal"
													},
													"sink": {
														"name": "INVOLUNTARY_CANCEL_AMOUNT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "CONVERT_TO_BILLING_COUNT",
														"type": "Decimal"
													},
													"sink": {
														"name": "CONVERT_TO_BILLING_COUNT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "TOTAL_NEW_BILLING_COUNT",
														"type": "Decimal"
													},
													"sink": {
														"name": "TOTAL_NEW_BILLING_COUNT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "TOTAL_NEW_BILLING_AMOUNT",
														"type": "Decimal"
													},
													"sink": {
														"name": "TOTAL_NEW_BILLING_AMOUNT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "UPGRADE_COUNT",
														"type": "Decimal"
													},
													"sink": {
														"name": "UPGRADE_COUNT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "DOWNGRADE_COUNT",
														"type": "Decimal"
													},
													"sink": {
														"name": "DOWNGRADE_COUNT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "NO_IMPACT_COUNT",
														"type": "Decimal"
													},
													"sink": {
														"name": "NO_IMPACT_COUNT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "NET_IMPACT_AMOUNT",
														"type": "Decimal"
													},
													"sink": {
														"name": "NET_IMPACT_AMOUNT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "ACH_COUNT",
														"type": "Decimal"
													},
													"sink": {
														"name": "ACH_COUNT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "CC_COUNT",
														"type": "Decimal"
													},
													"sink": {
														"name": "CC_COUNT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "CANCEL_COUNT",
														"type": "Decimal"
													},
													"sink": {
														"name": "CANCEL_COUNT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "CANCEL_AMOUNT",
														"type": "Decimal"
													},
													"sink": {
														"name": "CANCEL_AMOUNT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "RFC_COUNT",
														"type": "Decimal"
													},
													"sink": {
														"name": "RFC_COUNT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "ETL_DATE_KEY",
														"type": "Decimal"
													},
													"sink": {
														"name": "ETL_DATE_KEY",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "CLUB_NUMBER_I",
														"type": "Decimal"
													},
													"sink": {
														"name": "CLUB_NUMBER_I",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "MEMBERSHIP_TYPE",
														"type": "String"
													},
													"sink": {
														"name": "MEMBERSHIP_TYPE",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "TOTAL_COUNT",
														"type": "Decimal"
													},
													"sink": {
														"name": "TOTAL_COUNT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "TOTAL_BILLING_COUNT",
														"type": "Decimal"
													},
													"sink": {
														"name": "TOTAL_BILLING_COUNT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "ACTIONS_DATE_KEY",
														"type": "String"
													},
													"sink": {
														"name": "ACTIONS_DATE_KEY",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "CLUB_JOINS_COUNT",
														"type": "Decimal"
													},
													"sink": {
														"name": "CLUB_JOINS_COUNT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "MOBILEINCLUB_COUNT",
														"type": "Decimal"
													},
													"sink": {
														"name": "MOBILEINCLUB_COUNT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "MOBILEASSISTED_COUNT",
														"type": "Decimal"
													},
													"sink": {
														"name": "MOBILEASSISTED_COUNT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "WEB_JOINS_COUNT",
														"type": "Decimal"
													},
													"sink": {
														"name": "WEB_JOINS_COUNT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "MOBILE_JOINS_COUNT",
														"type": "Decimal"
													},
													"sink": {
														"name": "MOBILE_JOINS_COUNT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "NEW_JOINS_COUNT",
														"type": "Decimal"
													},
													"sink": {
														"name": "NEW_JOINS_COUNT",
														"type": "Decimal"
													}
												}
											]
										}
									},
									"inputs": [
										{
											"referenceName": "SRC_DW_PF_MEMBERSHIP_TYPE_SMRY_VW",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "SNK_SVN_PF_MEMERSHIP_TYPE_SMRY",
											"type": "DatasetReference",
											"parameters": {}
										}
									]
								}
							]
						}
					},
					{
						"name": "Lookup1",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Delete MAx date records",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderStoredProcedureName": "[[abcpi].[GetClubToLoad_50]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "AzureSynapseAnalyticsDB",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": false
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"windowStart": {
						"type": "string"
					}
				},
				"folder": {
					"name": "EDW_DW_SQL_POOL"
				},
				"annotations": [],
				"lastPublishTime": "2023-02-23T16:21:19Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/DW_PF_MSS_DD_SMRY_VW')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "delete max date records",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Check Did Job Success",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "DELETE\nfrom [DW].[PF_MSS_DD_SMRY] \nwhere date_key = (select max(date_key) from [DW].[PF_MSS_DD_SMRY]) ;\nSELECT 1;\n",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "SNK_SYN_DW_PF_MSS_DD_SMRY",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": true
						}
					},
					{
						"name": "Get Job Status",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "select 1\nfrom [dbo].[PF_VIEWS_JOBS_CHECK] \nwhere finish_time = cast(GETDATE() AT TIME ZONE 'UTC' AT TIME ZONE 'Eastern Standard Time' AS DATE) \nand FBI_JOB_NAME= 'EFT_RECONCILIATION_SMRY' and job_completed=1",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "SNK_DBO_PF_VIEWS_JOBS_CHECK",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "check Oracle Job",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Get Job Status",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "OracleSource",
								"oracleReaderQuery": "select JOB_NAME,START_TIME,FINISH_TIME,STATUS, 'PF.EFT_RECONCILIATION_SMRY' as FBI_JOB_NAME \r\nfrom dw.job_monitoring_vw \r\nwhere job_name = 'PF.EFT_RECONCILIATION_SMRY' and status = 'SUCCESS' and to_date(finish_time,'YYYY/MM/DD HH24:MI:SS') > trunc(sysdate)",
								"partitionOption": "None",
								"queryTimeout": "02:00:00"
							},
							"dataset": {
								"referenceName": "OracleTable1",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Check Did Job Success",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "check Oracle Job",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "select count(*) from pf_views_jobs_check \nwhere job_name = 'PF.EFT_RECONCILIATION_SMRY' and \n    status = 'SUCCESS' and cast(finish_time as date)=cast(GETDATE() AT TIME ZONE 'UTC' AT TIME ZONE 'Eastern Standard Time' AS DATE)\n    and FBI_JOB_NAME='PF.EFT_RECONCILIATION_SMRY'",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "SNK_DBO_PF_VIEWS_JOBS_CHECK",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Update Job Status",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "ForEach1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "UPDATE [DW].[PF_MSS_DD_SMRY]\nSET AS_OF = GETDATE();\nSELECT 1\n",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "SNK_DBO_PF_VIEWS_JOBS_CHECK",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "ForEach1",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "Lookup1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('Lookup1').output.value",
								"type": "Expression"
							},
							"isSequential": false,
							"activities": [
								{
									"name": "PF_MSS_DD_SMRY_VW",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "OracleSource",
											"oracleReaderQuery": {
												"value": "SELECT *\nFROM DW.PF_MSS_DD_SMRY_VW\nWHERE CLUB_NUMBER_I in @{item().cbcpy_list} AND\nDATE_KEY >= to_number(@{pipeline().parameters.windowStart})\n\n",
												"type": "Expression"
											},
											"partitionOption": "None",
											"convertDecimalToInteger": false,
											"queryTimeout": "02:00:00"
										},
										"sink": {
											"type": "SqlDWSink",
											"maxConcurrentConnections": 6,
											"allowPolyBase": true,
											"polyBaseSettings": {
												"rejectValue": 0,
												"rejectType": "value",
												"useTypeDefault": false
											},
											"disableMetricsCollection": false
										},
										"enableStaging": true,
										"stagingSettings": {
											"linkedServiceName": {
												"referenceName": "AzureBlobStorage1",
												"type": "LinkedServiceReference"
											},
											"path": "pfviewsoracle",
											"enableCompression": true
										},
										"parallelCopies": 8,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "DATE_KEY",
														"type": "Decimal"
													},
													"sink": {
														"name": "DATE_KEY",
														"type": "Single"
													}
												},
												{
													"source": {
														"name": "CLUB_NUMBER_I",
														"type": "Decimal"
													},
													"sink": {
														"name": "CLUB_NUMBER_I",
														"type": "Single"
													}
												},
												{
													"source": {
														"name": "STARTING_EFT",
														"type": "Double"
													},
													"sink": {
														"name": "STARTING_EFT",
														"type": "Single"
													}
												},
												{
													"source": {
														"name": "DRAFT_EFT",
														"type": "Double"
													},
													"sink": {
														"name": "DRAFT_EFT",
														"type": "Single"
													}
												},
												{
													"source": {
														"name": "EFT_TO_DATE",
														"type": "Double"
													},
													"sink": {
														"name": "EFT_TO_DATE",
														"type": "Single"
													}
												},
												{
													"source": {
														"name": "GROWTH_PROJECTION",
														"type": "Double"
													},
													"sink": {
														"name": "GROWTH_PROJECTION",
														"type": "Single"
													}
												},
												{
													"source": {
														"name": "DAY",
														"type": "String"
													},
													"sink": {
														"name": "DAY",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "DAY_OF_MONTH",
														"type": "Decimal"
													},
													"sink": {
														"name": "DAY_OF_MONTH",
														"type": "Single"
													}
												},
												{
													"source": {
														"name": "CASH",
														"type": "Double"
													},
													"sink": {
														"name": "CASH",
														"type": "Single"
													}
												},
												{
													"source": {
														"name": "CASH_TO_DATE",
														"type": "Double"
													},
													"sink": {
														"name": "CASH_TO_DATE",
														"type": "Single"
													}
												},
												{
													"source": {
														"name": "CASH_PROJECTION",
														"type": "Double"
													},
													"sink": {
														"name": "CASH_PROJECTION",
														"type": "Single"
													}
												},
												{
													"source": {
														"name": "MEMBER_PROJECTION",
														"type": "Double"
													},
													"sink": {
														"name": "MEMBER_PROJECTION",
														"type": "Single"
													}
												},
												{
													"source": {
														"name": "GUESTS",
														"type": "Double"
													},
													"sink": {
														"name": "GUESTS",
														"type": "Single"
													}
												},
												{
													"source": {
														"name": "GUESTS_TO_DATE",
														"type": "Double"
													},
													"sink": {
														"name": "GUESTS_TO_DATE",
														"type": "Single"
													}
												},
												{
													"source": {
														"name": "GUESTS_PROJECTION",
														"type": "Double"
													},
													"sink": {
														"name": "GUESTS_PROJECTION",
														"type": "Single"
													}
												},
												{
													"source": {
														"name": "PROSPECT_CHECKINS",
														"type": "Double"
													},
													"sink": {
														"name": "PROSPECT_CHECKINS",
														"type": "Single"
													}
												},
												{
													"source": {
														"name": "PROSPECT_CHECKINS_TO_DATE",
														"type": "Double"
													},
													"sink": {
														"name": "PROSPECT_CHECKINS_TO_DATE",
														"type": "Single"
													}
												},
												{
													"source": {
														"name": "NEW_MEMBERS",
														"type": "Double"
													},
													"sink": {
														"name": "NEW_MEMBERS",
														"type": "Single"
													}
												},
												{
													"source": {
														"name": "NEW_MEMBERS_TO_DATE",
														"type": "Double"
													},
													"sink": {
														"name": "NEW_MEMBERS_TO_DATE",
														"type": "Single"
													}
												},
												{
													"source": {
														"name": "NEW_MEMBERS_PROJECTION",
														"type": "Double"
													},
													"sink": {
														"name": "NEW_MEMBERS_PROJECTION",
														"type": "Single"
													}
												},
												{
													"source": {
														"name": "CLOSING_W_BC_GUESTS",
														"type": "Double"
													},
													"sink": {
														"name": "CLOSING_W_BC_GUESTS",
														"type": "Single"
													}
												},
												{
													"source": {
														"name": "CLOSING_WO_BC_GUESTS",
														"type": "Double"
													},
													"sink": {
														"name": "CLOSING_WO_BC_GUESTS",
														"type": "Single"
													}
												},
												{
													"source": {
														"name": "INFO_CALLS",
														"type": "Double"
													},
													"sink": {
														"name": "INFO_CALLS",
														"type": "Single"
													}
												},
												{
													"source": {
														"name": "INFO_CALLS_TO_DATE",
														"type": "Double"
													},
													"sink": {
														"name": "INFO_CALLS_TO_DATE",
														"type": "Single"
													}
												},
												{
													"source": {
														"name": "MISSED_TOUR_ACTIVITIES",
														"type": "Double"
													},
													"sink": {
														"name": "MISSED_TOUR_ACTIVITIES",
														"type": "Single"
													}
												},
												{
													"source": {
														"name": "MISSED_TOUR_ACTIVITIES_TO_DATE",
														"type": "Double"
													},
													"sink": {
														"name": "MISSED_TOUR_ACTIVITIES_TO_DATE",
														"type": "Single"
													}
												},
												{
													"source": {
														"name": "MSS_CANCELS",
														"type": "Double"
													},
													"sink": {
														"name": "MSS_CANCELS",
														"type": "Single"
													}
												},
												{
													"source": {
														"name": "MSS_CANCELS_TO_DATE",
														"type": "Double"
													},
													"sink": {
														"name": "MSS_CANCELS_TO_DATE",
														"type": "Single"
													}
												},
												{
													"source": {
														"name": "MSS_CANCEL_PROJECTIONS",
														"type": "Double"
													},
													"sink": {
														"name": "MSS_CANCEL_PROJECTIONS",
														"type": "Single"
													}
												},
												{
													"source": {
														"name": "BC_GUESTS",
														"type": "Double"
													},
													"sink": {
														"name": "BC_GUESTS",
														"type": "Single"
													}
												},
												{
													"source": {
														"name": "BC_GUESTS_TO_DATE",
														"type": "Double"
													},
													"sink": {
														"name": "BC_GUESTS_TO_DATE",
														"type": "Single"
													}
												},
												{
													"source": {
														"name": "BC_GUESTS_PROJECTION",
														"type": "Double"
													},
													"sink": {
														"name": "BC_GUESTS_PROJECTION",
														"type": "Single"
													}
												},
												{
													"source": {
														"name": "EFT_MEMBERS",
														"type": "Double"
													},
													"sink": {
														"name": "EFT_MEMBERS",
														"type": "Single"
													}
												},
												{
													"source": {
														"name": "PREPAID_MEMBERS",
														"type": "Double"
													},
													"sink": {
														"name": "PREPAID_MEMBERS",
														"type": "Single"
													}
												},
												{
													"source": {
														"name": "DD_CANCELS",
														"type": "Double"
													},
													"sink": {
														"name": "DD_CANCELS",
														"type": "Single"
													}
												},
												{
													"source": {
														"name": "DD_CANCELS_TO_DATE",
														"type": "Double"
													},
													"sink": {
														"name": "DD_CANCELS_TO_DATE",
														"type": "Single"
													}
												},
												{
													"source": {
														"name": "DD_CANCEL_PROJECTIONS",
														"type": "Double"
													},
													"sink": {
														"name": "DD_CANCEL_PROJECTIONS",
														"type": "Single"
													}
												},
												{
													"source": {
														"name": "RFCS",
														"type": "Double"
													},
													"sink": {
														"name": "RFCS",
														"type": "Single"
													}
												},
												{
													"source": {
														"name": "RFCS_TO_DATE",
														"type": "Double"
													},
													"sink": {
														"name": "RFCS_TO_DATE",
														"type": "Single"
													}
												},
												{
													"source": {
														"name": "RFC_ATTRITION",
														"type": "Double"
													},
													"sink": {
														"name": "RFC_ATTRITION",
														"type": "Single"
													}
												},
												{
													"source": {
														"name": "VOLUNTARY_ATTRITION",
														"type": "Double"
													},
													"sink": {
														"name": "VOLUNTARY_ATTRITION",
														"type": "Single"
													}
												},
												{
													"source": {
														"name": "EFT_MEMBERS_FROM_1ST",
														"type": "Double"
													},
													"sink": {
														"name": "EFT_MEMBERS_FROM_1ST",
														"type": "Single"
													}
												},
												{
													"source": {
														"name": "JAN_ANNUAL_PROJECTIONS",
														"type": "Double"
													},
													"sink": {
														"name": "JAN_ANNUAL_PROJECTIONS",
														"type": "Single"
													}
												},
												{
													"source": {
														"name": "FEB_ANNUAL_PROJECTIONS",
														"type": "Double"
													},
													"sink": {
														"name": "FEB_ANNUAL_PROJECTIONS",
														"type": "Single"
													}
												},
												{
													"source": {
														"name": "MAR_ANNUAL_PROJECTIONS",
														"type": "Double"
													},
													"sink": {
														"name": "MAR_ANNUAL_PROJECTIONS",
														"type": "Single"
													}
												},
												{
													"source": {
														"name": "APR_ANNUAL_PROJECTIONS",
														"type": "Double"
													},
													"sink": {
														"name": "APR_ANNUAL_PROJECTIONS",
														"type": "Single"
													}
												},
												{
													"source": {
														"name": "MAY_ANNUAL_PROJECTIONS",
														"type": "Double"
													},
													"sink": {
														"name": "MAY_ANNUAL_PROJECTIONS",
														"type": "Single"
													}
												},
												{
													"source": {
														"name": "JUN_ANNUAL_PROJECTIONS",
														"type": "Double"
													},
													"sink": {
														"name": "JUN_ANNUAL_PROJECTIONS",
														"type": "Single"
													}
												},
												{
													"source": {
														"name": "JUL_ANNUAL_PROJECTIONS",
														"type": "Double"
													},
													"sink": {
														"name": "JUL_ANNUAL_PROJECTIONS",
														"type": "Single"
													}
												},
												{
													"source": {
														"name": "AUG_ANNUAL_PROJECTIONS",
														"type": "Double"
													},
													"sink": {
														"name": "AUG_ANNUAL_PROJECTIONS",
														"type": "Single"
													}
												},
												{
													"source": {
														"name": "SEP_ANNUAL_PROJECTIONS",
														"type": "Double"
													},
													"sink": {
														"name": "SEP_ANNUAL_PROJECTIONS",
														"type": "Single"
													}
												},
												{
													"source": {
														"name": "OCT_ANNUAL_PROJECTIONS",
														"type": "Double"
													},
													"sink": {
														"name": "OCT_ANNUAL_PROJECTIONS",
														"type": "Single"
													}
												},
												{
													"source": {
														"name": "NOV_ANNUAL_PROJECTIONS",
														"type": "Double"
													},
													"sink": {
														"name": "NOV_ANNUAL_PROJECTIONS",
														"type": "Single"
													}
												},
												{
													"source": {
														"name": "DEC_ANNUAL_PROJECTIONS",
														"type": "Double"
													},
													"sink": {
														"name": "DEC_ANNUAL_PROJECTIONS",
														"type": "Single"
													}
												}
											]
										}
									},
									"inputs": [
										{
											"referenceName": "SRC_DW_PF_MSS_DD_SMRY_VW",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "SNK_SYN_DW_PF_MSS_DD_SMRY",
											"type": "DatasetReference",
											"parameters": {}
										}
									]
								}
							]
						}
					},
					{
						"name": "Lookup1",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "delete max date records",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderStoredProcedureName": "[[abcpi].[GetClubToLoad_300]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "AzureSynapseAnalyticsDB",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": false
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"windowStart": {
						"type": "string"
					}
				},
				"folder": {
					"name": "EDW_DW_SQL_POOL"
				},
				"annotations": [],
				"lastPublishTime": "2023-02-23T16:21:18Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/DW_PF_PAYMODE_SMRY_VW')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Delete Max Date records",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Check Did Job Success",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "DELETE\nfrom [DW].[PF_PAYMODE_SMRY] \nwhere etl_date_key = (select max(etl_date_key) from [DW].[PF_PAYMODE_SMRY]) \nAND SOURCE='EDW';\nSELECT 1;\n",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "SNK_SVN_DW_PF_PAYMODE_SMRY",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": true
						}
					},
					{
						"name": "Get Job Status",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "select 1\nfrom [dbo].[PF_VIEWS_JOBS_CHECK] \nwhere finish_time = cast(GETDATE() AT TIME ZONE 'UTC' AT TIME ZONE 'Eastern Standard Time' AS DATE) \nand FBI_JOB_NAME= 'EFT_RECONCILIATION_SMRY' and job_completed=1",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "SNK_DBO_PF_VIEWS_JOBS_CHECK",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "check Oracle Job",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Get Job Status",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "OracleSource",
								"oracleReaderQuery": "select JOB_NAME,START_TIME,FINISH_TIME,STATUS, 'PF.EFT_RECONCILIATION_SMRY' as FBI_JOB_NAME \r\nfrom dw.job_monitoring_vw \r\nwhere job_name = 'PF.EFT_RECONCILIATION_SMRY' and status = 'SUCCESS' and to_date(finish_time,'YYYY/MM/DD HH24:MI:SS') > trunc(sysdate)",
								"partitionOption": "None",
								"queryTimeout": "02:00:00"
							},
							"dataset": {
								"referenceName": "OracleTable1",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Check Did Job Success",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "check Oracle Job",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "select count(*) from pf_views_jobs_check \nwhere job_name = 'PF.EFT_RECONCILIATION_SMRY' and \n    status = 'SUCCESS' and cast(finish_time as date)=cast(GETDATE() AT TIME ZONE 'UTC' AT TIME ZONE 'Eastern Standard Time' AS DATE)\n    and FBI_JOB_NAME='PF.EFT_RECONCILIATION_SMRY'",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "SNK_DBO_PF_VIEWS_JOBS_CHECK",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Update Job Status",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "ForEach1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "UPDATE [DW].[PF_PAYMODE_SMRY]\nSET AS_OF = GETDATE()\nWHERE SOURCE='EDW';\nSELECT 1\n",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "SNK_DBO_PF_VIEWS_JOBS_CHECK",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "ForEach1",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "Lookup1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('Lookup1').output.value",
								"type": "Expression"
							},
							"isSequential": false,
							"activities": [
								{
									"name": "PF_PAYMODE_SMRY_VW",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "OracleSource",
											"oracleReaderQuery": {
												"value": "SELECT ETL_DATE_KEY\n      ,CLUB_NUMBER_I\n      ,PAYMODE\n      ,coalesce(TOTAL_COUNT,0) as TOTAL_COUNT\n      ,'EDW' as Source\nFROM DW.pf_paymode_smry_vw\nWHERE CLUB_NUMBER_I in @{item().cbcpy_list} AND\nETL_DATE_KEY >= to_number(@{pipeline().parameters.windowStart})",
												"type": "Expression"
											},
											"partitionOption": "None",
											"convertDecimalToInteger": false,
											"queryTimeout": "02:00:00"
										},
										"sink": {
											"type": "SqlDWSink",
											"maxConcurrentConnections": 6,
											"allowPolyBase": true,
											"polyBaseSettings": {
												"rejectValue": 0,
												"rejectType": "value",
												"useTypeDefault": false
											},
											"disableMetricsCollection": false
										},
										"enableStaging": true,
										"stagingSettings": {
											"linkedServiceName": {
												"referenceName": "AzureBlobStorage1",
												"type": "LinkedServiceReference"
											},
											"path": "pfviewsoracle",
											"enableCompression": true
										},
										"parallelCopies": 8,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "ETL_DATE_KEY",
														"type": "Decimal"
													},
													"sink": {
														"name": "ETL_DATE_KEY",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "CLUB_NUMBER_I",
														"type": "Decimal"
													},
													"sink": {
														"name": "CLUB_NUMBER_I",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "PAYMODE",
														"type": "String"
													},
													"sink": {
														"name": "PAYMODE",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "TOTAL_COUNT",
														"type": "Double"
													},
													"sink": {
														"name": "TOTAL_COUNT",
														"type": "Single"
													}
												},
												{
													"source": {
														"name": "SOURCE",
														"type": "String"
													},
													"sink": {
														"name": "Source",
														"type": "String"
													}
												}
											]
										}
									},
									"inputs": [
										{
											"referenceName": "SRC_DW_PF_PAYMODE_SMRY_VW",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "SNK_SVN_DW_PF_PAYMODE_SMRY",
											"type": "DatasetReference",
											"parameters": {}
										}
									]
								}
							]
						}
					},
					{
						"name": "Lookup1",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Delete Max Date records",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderStoredProcedureName": "[[abcpi].[GetClubToLoad_300]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "AzureSynapseAnalyticsDB",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": false
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"windowStart": {
						"type": "string"
					}
				},
				"folder": {
					"name": "EDW_DW_SQL_POOL"
				},
				"annotations": [],
				"lastPublishTime": "2023-02-23T16:21:18Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/DW_TEST_DW_PF_ANNUAL_PROJECTION_SMRY_VW')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Delete Max Date records",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Check Did Job Success",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "DELETE\nfrom [DW].[PF_ANNUAL_PROJECTION_SMRY] \nwhere etl_date_key = (select max(etl_date_key) from [DW].[PF_ANNUAL_PROJECTION_SMRY]) ;\nSELECT 1;\n\n\n",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "SNK_SVN_DW_PF_ANNUAL_PROJECTION_SMRY",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": true
						}
					},
					{
						"name": "Get Job Status",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "select 1\nfrom [dbo].[PF_VIEWS_JOBS_CHECK] \nwhere finish_time = cast(GETDATE() AT TIME ZONE 'UTC' AT TIME ZONE 'Eastern Standard Time' AS DATE) \nand FBI_JOB_NAME= 'EFT_RECONCILIATION_SMRY' and job_completed=1",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "SNK_DBO_PF_VIEWS_JOBS_CHECK",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "check Oracle Job",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Get Job Status",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "OracleSource",
								"oracleReaderQuery": "select JOB_NAME,START_TIME,FINISH_TIME,STATUS, 'PF.EFT_RECONCILIATION_SMRY' as FBI_JOB_NAME \r\nfrom dw.job_monitoring_vw \r\nwhere job_name = 'PF.EFT_RECONCILIATION_SMRY' and status = 'SUCCESS' and to_date(finish_time,'YYYY/MM/DD HH24:MI:SS') > trunc(sysdate)",
								"partitionOption": "None",
								"queryTimeout": "02:00:00"
							},
							"dataset": {
								"referenceName": "OracleTable1",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Check Did Job Success",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "check Oracle Job",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "select count(*) from pf_views_jobs_check \nwhere job_name = 'PF.EFT_RECONCILIATION_SMRY' and \n    status = 'SUCCESS' and cast(finish_time as date)=cast(GETDATE() AT TIME ZONE 'UTC' AT TIME ZONE 'Eastern Standard Time' AS DATE)\n    and FBI_JOB_NAME='PF.EFT_RECONCILIATION_SMRY'",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "SNK_DBO_PF_VIEWS_JOBS_CHECK",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Update Job Status",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "ForEach1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "UPDATE [DW].[PF_ANNUAL_PROJECTION_SMRY]\nSET AS_OF = GETDATE();\nSELECT 1\n",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "SNK_DBO_PF_VIEWS_JOBS_CHECK",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "ForEach1",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "Lookup1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('Lookup1').output.value",
								"type": "Expression"
							},
							"isSequential": false,
							"activities": [
								{
									"name": "PF_ANNUAL_PROJECTION_SMRY",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "OracleSource",
											"oracleReaderQuery": {
												"value": "SELECT *\nFROM DW.PF_ANNUAL_PROJECTION_SMRY_VW\nWHERE CLUB_NUMBER_I in @{item().cbcpy_list} AND\nETL_DATE_KEY >= to_number(@{pipeline().parameters.windowStart})",
												"type": "Expression"
											},
											"partitionOption": "None",
											"convertDecimalToInteger": false,
											"queryTimeout": "02:00:00"
										},
										"sink": {
											"type": "SqlDWSink",
											"maxConcurrentConnections": 6,
											"allowPolyBase": true,
											"polyBaseSettings": {
												"rejectValue": 0,
												"rejectType": "value",
												"useTypeDefault": false
											},
											"disableMetricsCollection": false
										},
										"enableStaging": true,
										"stagingSettings": {
											"linkedServiceName": {
												"referenceName": "AzureBlobStorage1",
												"type": "LinkedServiceReference"
											},
											"path": "pfviewsoracle",
											"enableCompression": true
										},
										"parallelCopies": 8,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "ETL_DATE_KEY",
														"type": "Decimal"
													},
													"sink": {
														"name": "ETL_DATE_KEY",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "CLUB_NUMBER_I",
														"type": "Decimal"
													},
													"sink": {
														"name": "CLUB_NUMBER_I",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "ANNUAL_MONTH",
														"type": "String"
													},
													"sink": {
														"name": "ANNUAL_MONTH",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "ANNUAL_PROJECTION_COUNT",
														"type": "Decimal"
													},
													"sink": {
														"name": "ANNUAL_PROJECTION_COUNT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "ANNUAL_PROJECTION_AMOUNT",
														"type": "Decimal"
													},
													"sink": {
														"name": "ANNUAL_PROJECTION_AMOUNT",
														"type": "Decimal"
													}
												}
											]
										}
									},
									"inputs": [
										{
											"referenceName": "SRC_DW_PF_ANNUAL_PROJECTION_SMRY_VW",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "SNK_SVN_DW_PF_ANNUAL_PROJECTION_SMRY",
											"type": "DatasetReference",
											"parameters": {}
										}
									]
								}
							]
						}
					},
					{
						"name": "Lookup1",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Delete Max Date records",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderStoredProcedureName": "[[abcpi].[GetClubToLoad_300]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "AzureSynapseAnalyticsDB",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": false
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"windowStart": {
						"type": "string"
					}
				},
				"folder": {
					"name": "EDW_DW_SQL_POOL"
				},
				"annotations": [],
				"lastPublishTime": "2023-02-23T16:21:18Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/DW_TEST_DW_PF_DT_CHECKIN_SERVICE_SMRY_VW')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Delete Max Date records",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Check Did Job Success",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "DELETE\nfrom [DW].[PF_DT_CHECKIN_SERVICE_SMRY] \nwhere etl_date_key = (select max(etl_date_key) from [DW].[PF_DT_CHECKIN_SERVICE_SMRY]) ;\nSELECT 1;\n",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "SNK_SVN_DW_PF_DT_CHECKIN_SERVICE_SMRY",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": true
						}
					},
					{
						"name": "Get Job Status",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "select 1\nfrom [dbo].[PF_VIEWS_JOBS_CHECK] \nwhere finish_time = cast(GETDATE() AT TIME ZONE 'UTC' AT TIME ZONE 'Eastern Standard Time' AS DATE) \nand FBI_JOB_NAME= 'EFT_RECONCILIATION_SMRY' and job_completed=1",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "SNK_DBO_PF_VIEWS_JOBS_CHECK",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "check Oracle Job",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Get Job Status",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "OracleSource",
								"oracleReaderQuery": "select JOB_NAME,START_TIME,FINISH_TIME,STATUS, 'PF.EFT_RECONCILIATION_SMRY' as FBI_JOB_NAME \r\nfrom dw.job_monitoring_vw \r\nwhere job_name = 'PF.EFT_RECONCILIATION_SMRY' and status = 'SUCCESS' and to_date(finish_time,'YYYY/MM/DD HH24:MI:SS') > trunc(sysdate)",
								"partitionOption": "None",
								"queryTimeout": "02:00:00"
							},
							"dataset": {
								"referenceName": "OracleTable1",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Check Did Job Success",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "check Oracle Job",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "select count(*) from pf_views_jobs_check \nwhere job_name = 'PF.EFT_RECONCILIATION_SMRY' and \n    status = 'SUCCESS' and cast(finish_time as date)=cast(GETDATE() AT TIME ZONE 'UTC' AT TIME ZONE 'Eastern Standard Time' AS DATE)\n    and FBI_JOB_NAME='PF.EFT_RECONCILIATION_SMRY'",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "SNK_DBO_PF_VIEWS_JOBS_CHECK",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Update Job Status",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "ForEach1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "UPDATE [DW].[PF_DT_CHECKIN_SERVICE_SMRY]\nSET AS_OF = GETDATE();\nSELECT 1\n",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "SNK_DBO_PF_VIEWS_JOBS_CHECK",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "ForEach1",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "Lookup1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('Lookup1').output.value",
								"type": "Expression"
							},
							"isSequential": false,
							"activities": [
								{
									"name": "PF_DT_CHECKIN_SERVICE_SMRY_VW",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "OracleSource",
											"oracleReaderQuery": {
												"value": "SELECT *\nFROM DW.PF_DT_CHECKIN_SERVICE_SMRY_VW\nWHERE CLUB_NUMBER_I in @{item().cbcpy_list} AND\nETL_DATE_KEY >= to_number(@{pipeline().parameters.windowStart})",
												"type": "Expression"
											},
											"partitionOption": "None",
											"convertDecimalToInteger": false,
											"queryTimeout": "02:00:00"
										},
										"sink": {
											"type": "SqlDWSink",
											"maxConcurrentConnections": 6,
											"allowPolyBase": true,
											"polyBaseSettings": {
												"rejectValue": 0,
												"rejectType": "value",
												"useTypeDefault": false
											},
											"disableMetricsCollection": false
										},
										"enableStaging": true,
										"stagingSettings": {
											"linkedServiceName": {
												"referenceName": "AzureBlobStorage1",
												"type": "LinkedServiceReference"
											},
											"path": "pfviewsoracle",
											"enableCompression": true
										},
										"parallelCopies": 8,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "ETL_DATE_KEY",
														"type": "Decimal"
													},
													"sink": {
														"name": "ETL_DATE_KEY",
														"type": "Single"
													}
												},
												{
													"source": {
														"name": "CLUB_NUMBER_I",
														"type": "Decimal"
													},
													"sink": {
														"name": "CLUB_NUMBER_I",
														"type": "Single"
													}
												},
												{
													"source": {
														"name": "CHECKIN_SERVICE_USAGE_DATE_KEY",
														"type": "Double"
													},
													"sink": {
														"name": "CHECKIN_SERVICE_USAGE_DATE_KEY",
														"type": "Single"
													}
												},
												{
													"source": {
														"name": "CHECKIN_COUNT",
														"type": "Double"
													},
													"sink": {
														"name": "CHECKIN_COUNT",
														"type": "Single"
													}
												},
												{
													"source": {
														"name": "TANNING",
														"type": "Double"
													},
													"sink": {
														"name": "TANNING",
														"type": "Single"
													}
												},
												{
													"source": {
														"name": "HYDRO_MASSAGE",
														"type": "Double"
													},
													"sink": {
														"name": "HYDRO_MASSAGE",
														"type": "Single"
													}
												},
												{
													"source": {
														"name": "MASSAGE_CHAIR",
														"type": "Double"
													},
													"sink": {
														"name": "MASSAGE_CHAIR",
														"type": "Single"
													}
												},
												{
													"source": {
														"name": "PE_AT_PF",
														"type": "Double"
													},
													"sink": {
														"name": "PE_AT_PF",
														"type": "Single"
													}
												},
												{
													"source": {
														"name": "TOTAL_BODY_ENHANCEMENT",
														"type": "Double"
													},
													"sink": {
														"name": "TOTAL_BODY_ENHANCEMENT",
														"type": "Single"
													}
												},
												{
													"source": {
														"name": "BCM_BRING_A_GUEST",
														"type": "Double"
													},
													"sink": {
														"name": "BCM_BRING_A_GUEST",
														"type": "Single"
													}
												},
												{
													"source": {
														"name": "BLACK_CARD_CUTS",
														"type": "Double"
													},
													"sink": {
														"name": "BLACK_CARD_CUTS",
														"type": "Single"
													}
												},
												{
													"source": {
														"name": "SPRAY_TAN",
														"type": "Double"
													},
													"sink": {
														"name": "SPRAY_TAN",
														"type": "Single"
													}
												}
											]
										}
									},
									"inputs": [
										{
											"referenceName": "SRC_DW_PF_DT_CHECKIN_SERVICE_SMRY_VW",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "SNK_SVN_DW_PF_DT_CHECKIN_SERVICE_SMRY",
											"type": "DatasetReference",
											"parameters": {}
										}
									]
								}
							]
						}
					},
					{
						"name": "Lookup1",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Delete Max Date records",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderStoredProcedureName": "[[abcpi].[GetClubToLoad_300]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "AzureSynapseAnalyticsDB",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": false
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"windowStart": {
						"type": "string"
					}
				},
				"folder": {
					"name": "EDW_DW_SQL_POOL"
				},
				"annotations": [],
				"lastPublishTime": "2023-02-23T16:21:18Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Departments_SQLPOOL')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "ForEach1",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "Lookup1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('Lookup1').output.value",
								"type": "Expression"
							},
							"isSequential": false,
							"activities": [
								{
									"name": "DEPARTMENTS",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [
										{
											"name": "Source",
											"value": "."
										},
										{
											"name": "Destination",
											"value": "ABCPI.STG_DEPARTMENTS_INCR"
										}
									],
									"typeProperties": {
										"source": {
											"type": "OracleSource",
											"oracleReaderQuery": {
												"value": "select * from BETADATA.DEPARTMENTS\nwhere D_MODIFIED >= TO_DATE('@{formatDateTime(pipeline().parameters.windowStart, 'yyyy-MM-dd HH:mm' )}', 'YYYY-MM-DD HH24:MI') \nAND D_MODIFIED < TO_DATE('@{formatDateTime(pipeline().parameters.windowEnd, 'yyyy-MM-dd HH:mm' )}', 'YYYY-MM-DD HH24:MI')\nAND VPD_ID in @{item().vpd_list}",
												"type": "Expression"
											},
											"partitionOption": "None"
										},
										"sink": {
											"type": "SqlDWSink",
											"allowPolyBase": true,
											"polyBaseSettings": {
												"rejectValue": 0,
												"rejectType": "value",
												"useTypeDefault": false
											}
										},
										"enableStaging": true,
										"stagingSettings": {
											"linkedServiceName": {
												"referenceName": "AzureBlobStorage1",
												"type": "LinkedServiceReference"
											},
											"path": "vifiles"
										},
										"parallelCopies": 32,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "VPD_ID",
														"type": "Decimal"
													},
													"sink": {
														"name": "VPD_ID",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "D_ID",
														"type": "String"
													},
													"sink": {
														"name": "D_ID",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "D_CREATED",
														"type": "DateTime"
													},
													"sink": {
														"name": "D_CREATED",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"name": "D_MODIFIED",
														"type": "DateTime"
													},
													"sink": {
														"name": "D_MODIFIED",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"name": "D_ACTIVE",
														"type": "String"
													},
													"sink": {
														"name": "D_ACTIVE",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "D_NAME",
														"type": "String"
													},
													"sink": {
														"name": "D_NAME",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "D_SHOW_IN_CALENDAR",
														"type": "String"
													},
													"sink": {
														"name": "D_SHOW_IN_CALENDAR",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "D_SHOW_ONLINE",
														"type": "String"
													},
													"sink": {
														"name": "D_SHOW_ONLINE",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "D_SALESPERSON_ONLINE",
														"type": "String"
													},
													"sink": {
														"name": "D_SALESPERSON_ONLINE",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "D_ADP_CODE",
														"type": "String"
													},
													"sink": {
														"name": "D_ADP_CODE",
														"type": "String"
													}
												}
											]
										}
									},
									"inputs": [
										{
											"referenceName": "SRC_BETADATA_DEPARTMENTS",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "SNK_SYN_DT_STG_DEPARTMENTS_INCR",
											"type": "DatasetReference",
											"parameters": {}
										}
									]
								}
							]
						}
					},
					{
						"name": "Lookup1",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "truncate incr table",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderStoredProcedureName": "[[abcpi].[GetVPDToLoad]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "AzureSynapseAnalyticsDB",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": false
						}
					},
					{
						"name": "truncate incr table",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "truncate table StgDatatrak.stg_departments_incr;\nselect 0;",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "AzureSynapseAnalyticsDB",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Merge to Staging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "ForEach1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[StgDatatrak].[STG_DEPARTMENTS_MERGE]"
						},
						"linkedServiceName": {
							"referenceName": "AzureSynapseAnalytics1",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"windowStart": {
						"type": "String"
					},
					"windowEnd": {
						"type": "String"
					}
				},
				"folder": {
					"name": "Oracle_SQLPOOL/Oracle_SQL_POOL_Group2"
				},
				"annotations": [],
				"lastPublishTime": "2023-02-08T11:25:25Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/EDW_ACTION_STATUS_CODES_PRD_SQLPOOL')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Truncate Incr table",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "truncate table [PF].[EDW_ACTION_STATUS_CODES_PRD_INCR];\nselect 0;",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "AzureSynapseAnalyticsDB",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": false
						}
					},
					{
						"name": "Merge to Staging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "EDW_ACTION_STATUS_CODES_PRD",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[PF].[EDW_ACTION_STATUS_CODES_PRD_MERGE]"
						},
						"linkedServiceName": {
							"referenceName": "AzureSynapseAnalytics1",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "EDW_ACTION_STATUS_CODES_PRD",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Truncate Incr table",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "OracleSource",
								"oracleReaderQuery": {
									"value": "SELECT *\nFROM pf.EDW_ACTION_STATUS_CODES_PRD\n",
									"type": "Expression"
								},
								"partitionOption": "None",
								"convertDecimalToInteger": false,
								"queryTimeout": "02:00:00"
							},
							"sink": {
								"type": "SqlDWSink",
								"maxConcurrentConnections": 6,
								"allowPolyBase": true,
								"polyBaseSettings": {
									"rejectValue": 0,
									"rejectType": "value",
									"useTypeDefault": false
								},
								"disableMetricsCollection": false
							},
							"enableStaging": true,
							"stagingSettings": {
								"linkedServiceName": {
									"referenceName": "AzureBlobStorage1",
									"type": "LinkedServiceReference"
								},
								"path": "vifiles",
								"enableCompression": false
							},
							"parallelCopies": 8,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "STCDE",
											"type": "String"
										},
										"sink": {
											"name": "STCDE",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "STDSC",
											"type": "String"
										},
										"sink": {
											"name": "STDSC",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "STCHG",
											"type": "String"
										},
										"sink": {
											"name": "STCHG",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "STTYP",
											"type": "String"
										},
										"sink": {
											"name": "STTYP",
											"type": "String"
										}
									}
								]
							}
						},
						"inputs": [
							{
								"referenceName": "SRC_PF_Royalty",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "SNK_SYN_EDW_ACTION_STATUS_CODES_PRD_INCR",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"folder": {
					"name": "EDW_PF_SQL_POOL"
				},
				"annotations": [],
				"lastPublishTime": "2023-02-23T16:21:18Z"
			},
			"dependsOn": []
		}
	]
}