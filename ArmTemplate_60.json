{
	"$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
	"contentVersion": "1.0.0.0",
	"parameters": {
		"factoryName": {
			"type": "string",
			"metadata": "Data Factory name",
			"defaultValue": "PlanetFitnessDF"
		}
	},
	"variables": {
		"factoryId": "[concat('Microsoft.DataFactory/factories/', parameters('factoryName'))]"
	},
	"resources": [
		{
			"name": "[concat(parameters('factoryName'), '/ABC400FIL_INVSCDFIL_SQLPOOL')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "ForEach1",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "Lookup1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('Lookup1').output.value",
								"type": "Expression"
							},
							"isSequential": false,
							"batchCount": 50,
							"activities": [
								{
									"name": "ABC400FIL_INVSCDFIL",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "Db2Source",
											"query": {
												"value": "SELECT\na.INVCLB,\na.INVMBR,\na.INV#PMT,\na.INVFRQ,\na.INVPCNTR,\na.INVTC$,\na.INVTD$,\na.INVR#P,\na.INVRC$,\na.INVRD$,\na.INVRP$,\na.INVFDT,\na.INVDOM,\na.INVEXPDLY,\na.INVEXP,\na.INVRNWDLY,\na.INVRNW,\na.INVRNWDOM,\na.INVARF,\na.INVOEF,\na.INVLASTP,\na.INVLEFT,\na.INVSEQ,\na.INVACT,\na.INVENT,\na.INVRSCH\nFROM ABC400FIL.invscdfil a\nWHERE a.INVCLB in @{item().cbcpy_list}\nAND a.invact='Y' and a.invent >= 20030101 with UR",
												"type": "Expression"
											}
										},
										"sink": {
											"type": "SqlDWSink",
											"allowPolyBase": true,
											"polyBaseSettings": {
												"rejectValue": 0,
												"rejectType": "value",
												"useTypeDefault": false
											}
										},
										"enableStaging": true,
										"stagingSettings": {
											"linkedServiceName": {
												"referenceName": "AzureBlobStorage1",
												"type": "LinkedServiceReference"
											},
											"path": "vifiles"
										},
										"parallelCopies": 32,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "INVCLB",
														"type": "Decimal"
													},
													"sink": {
														"name": "INVCLB",
														"type": "Int32"
													}
												},
												{
													"source": {
														"name": "INVMBR",
														"type": "Decimal"
													},
													"sink": {
														"name": "INVMBR",
														"type": "Int32"
													}
												},
												{
													"source": {
														"name": "INV#PMT",
														"type": "Decimal"
													},
													"sink": {
														"name": "INV#PMT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "INVFRQ",
														"type": "String"
													},
													"sink": {
														"name": "INVFRQ",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "INVPCNTR",
														"type": "String"
													},
													"sink": {
														"name": "INVPCNTR",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "INVTC$",
														"type": "Decimal"
													},
													"sink": {
														"name": "INVTC$",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "INVTD$",
														"type": "Decimal"
													},
													"sink": {
														"name": "INVTD$",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "INVR#P",
														"type": "Decimal"
													},
													"sink": {
														"name": "INVR#P",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "INVRC$",
														"type": "Decimal"
													},
													"sink": {
														"name": "INVRC$",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "INVRD$",
														"type": "Decimal"
													},
													"sink": {
														"name": "INVRD$",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "INVRP$",
														"type": "Decimal"
													},
													"sink": {
														"name": "INVRP$",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "INVFDT",
														"type": "Decimal"
													},
													"sink": {
														"name": "INVFDT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "INVDOM",
														"type": "Decimal"
													},
													"sink": {
														"name": "INVDOM",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "INVEXPDLY",
														"type": "Decimal"
													},
													"sink": {
														"name": "INVEXPDLY",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "INVEXP",
														"type": "Decimal"
													},
													"sink": {
														"name": "INVEXP",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "INVRNWDLY",
														"type": "Decimal"
													},
													"sink": {
														"name": "INVRNWDLY",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "INVRNW",
														"type": "Decimal"
													},
													"sink": {
														"name": "INVRNW",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "INVRNWDOM",
														"type": "Decimal"
													},
													"sink": {
														"name": "INVRNWDOM",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "INVARF",
														"type": "String"
													},
													"sink": {
														"name": "INVARF",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "INVOEF",
														"type": "String"
													},
													"sink": {
														"name": "INVOEF",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "INVLASTP",
														"type": "Decimal"
													},
													"sink": {
														"name": "INVLASTP",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "INVLEFT",
														"type": "Decimal"
													},
													"sink": {
														"name": "INVLEFT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "INVSEQ",
														"type": "Decimal"
													},
													"sink": {
														"name": "INVSEQ",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "INVACT",
														"type": "String"
													},
													"sink": {
														"name": "INVACT",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "INVENT",
														"type": "Decimal"
													},
													"sink": {
														"name": "INVENT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "INVRSCH",
														"type": "String"
													},
													"sink": {
														"name": "INVRSCH",
														"type": "String"
													}
												}
											]
										}
									},
									"inputs": [
										{
											"referenceName": "Iseries_Prod",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "SNK_SYN_ISERIES_INVSCDFIL_INCR",
											"type": "DatasetReference",
											"parameters": {}
										}
									]
								}
							]
						}
					},
					{
						"name": "Lookup1",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Truncate Incr table",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderStoredProcedureName": "[[abcpi].[GetClubToLoad_50]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "AzureSynapseAnalyticsDB",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": false
						}
					},
					{
						"name": "Truncate Incr table",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "truncate table StgIseries.ABC400FIL_INVSCDFIL_INCR;\nselect 0;",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "AzureSynapseAnalyticsDB",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": false
						}
					},
					{
						"name": "Merge to Staging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "ForEach1",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[StgIseries].[ABC400FIL_INVSCDFIL_Merge]"
						},
						"linkedServiceName": {
							"referenceName": "AzureSynapseAnalytics1",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"folder": {
					"name": "Iseries_SQLPOOL/Load_Source_Iseries_Group1_SQLPOOL"
				},
				"annotations": [],
				"lastPublishTime": "2023-02-15T14:53:18Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/ABC400FIL_MPBFIL_SQLPOOL')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "ForEach1",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "Lookup1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('Lookup1').output.value",
								"type": "Expression"
							},
							"isSequential": false,
							"batchCount": 50,
							"activities": [
								{
									"name": "ABC400FIL_MPBFIL_1",
									"description": "",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "Db2Source",
											"query": {
												"value": "SELECT a.* \nFROM ABC400FIL.MPBFIL a\nWHERE  a.MPBDTE between int(@{pipeline().parameters.windowStart}) AND int(@{pipeline().parameters.windowEnd})\nAND  a.MPBCLI in @{item().cbcpy_list} with UR",
												"type": "Expression"
											}
										},
										"sink": {
											"type": "SqlDWSink",
											"allowPolyBase": true,
											"polyBaseSettings": {
												"rejectValue": 0,
												"rejectType": "value",
												"useTypeDefault": false
											}
										},
										"enableStaging": true,
										"stagingSettings": {
											"linkedServiceName": {
												"referenceName": "AzureBlobStorage1",
												"type": "LinkedServiceReference"
											},
											"path": "vifiles"
										},
										"parallelCopies": 32,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "MPBTYPE",
														"type": "String"
													},
													"sink": {
														"name": "MPBTYPE",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "MPBDTE",
														"type": "Decimal"
													},
													"sink": {
														"name": "MPBDTE",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "MPBCUS",
														"type": "Decimal"
													},
													"sink": {
														"name": "MPBCUS",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "MPBCLI",
														"type": "Decimal"
													},
													"sink": {
														"name": "MPBCLI",
														"type": "Int32"
													}
												},
												{
													"source": {
														"name": "MPBTXT",
														"type": "String"
													},
													"sink": {
														"name": "MPBTXT",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "MPBCTY",
														"type": "String"
													},
													"sink": {
														"name": "MPBCTY",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "MPBINVCNT",
														"type": "Decimal"
													},
													"sink": {
														"name": "MPBINVCNT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "MPBINVTOT",
														"type": "Decimal"
													},
													"sink": {
														"name": "MPBINVTOT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "MPBXMTCNT",
														"type": "Decimal"
													},
													"sink": {
														"name": "MPBXMTCNT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "MPBXMTTOT",
														"type": "Decimal"
													},
													"sink": {
														"name": "MPBXMTTOT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "MPBREJCNT",
														"type": "Decimal"
													},
													"sink": {
														"name": "MPBREJCNT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "MPBREJTOT",
														"type": "Decimal"
													},
													"sink": {
														"name": "MPBREJTOT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "MPBNETCNT",
														"type": "Decimal"
													},
													"sink": {
														"name": "MPBNETCNT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "MPBNETTOT",
														"type": "Decimal"
													},
													"sink": {
														"name": "MPBNETTOT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "MPBABCAMT",
														"type": "Decimal"
													},
													"sink": {
														"name": "MPBABCAMT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "MPBTCLUB",
														"type": "Decimal"
													},
													"sink": {
														"name": "MPBTCLUB",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "MPBTCUST",
														"type": "Decimal"
													},
													"sink": {
														"name": "MPBTCUST",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "MPBTCLBAMT",
														"type": "Decimal"
													},
													"sink": {
														"name": "MPBTCLBAMT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "MPBEFTPCT",
														"type": "Decimal"
													},
													"sink": {
														"name": "MPBEFTPCT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "MPBEFTAMT",
														"type": "Decimal"
													},
													"sink": {
														"name": "MPBEFTAMT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "MPBCCDPCTA",
														"type": "Decimal"
													},
													"sink": {
														"name": "MPBCCDPCTA",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "MPBCCDAMTA",
														"type": "Decimal"
													},
													"sink": {
														"name": "MPBCCDAMTA",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "MPBCCDPCTB",
														"type": "Decimal"
													},
													"sink": {
														"name": "MPBCCDPCTB",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "MPBCCDAMTB",
														"type": "Decimal"
													},
													"sink": {
														"name": "MPBCCDAMTB",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "MPBCCDPCTD",
														"type": "Decimal"
													},
													"sink": {
														"name": "MPBCCDPCTD",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "MPBCCDAMTD",
														"type": "Decimal"
													},
													"sink": {
														"name": "MPBCCDAMTD",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "MPBCCDPCTM",
														"type": "Decimal"
													},
													"sink": {
														"name": "MPBCCDPCTM",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "MPBCCDAMTM",
														"type": "Decimal"
													},
													"sink": {
														"name": "MPBCCDAMTM",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "MPBCCDPCTV",
														"type": "Decimal"
													},
													"sink": {
														"name": "MPBCCDPCTV",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "MPBCCDAMTV",
														"type": "Decimal"
													},
													"sink": {
														"name": "MPBCCDAMTV",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "MPBXMTDTE",
														"type": "Decimal"
													},
													"sink": {
														"name": "MPBXMTDTE",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "MPBREJDTE",
														"type": "Decimal"
													},
													"sink": {
														"name": "MPBREJDTE",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "MPBDWLDTE",
														"type": "Decimal"
													},
													"sink": {
														"name": "MPBDWLDTE",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "MPBPRTDTE",
														"type": "Decimal"
													},
													"sink": {
														"name": "MPBPRTDTE",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "MPBEFTCNT",
														"type": "Decimal"
													},
													"sink": {
														"name": "MPBEFTCNT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "MPBEFTTOT",
														"type": "Decimal"
													},
													"sink": {
														"name": "MPBEFTTOT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "MPBETTAAMT",
														"type": "Decimal"
													},
													"sink": {
														"name": "MPBETTAAMT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "MPBETT$AMT",
														"type": "Decimal"
													},
													"sink": {
														"name": "MPBETT$AMT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "MPBEFTXCNT",
														"type": "Decimal"
													},
													"sink": {
														"name": "MPBEFTXCNT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "MPBEFTXAMT",
														"type": "Decimal"
													},
													"sink": {
														"name": "MPBEFTXAMT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "MPBEFTECNT",
														"type": "Decimal"
													},
													"sink": {
														"name": "MPBEFTECNT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "MPBEFTEAMT",
														"type": "Decimal"
													},
													"sink": {
														"name": "MPBEFTEAMT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "MPBERJAAMT",
														"type": "Decimal"
													},
													"sink": {
														"name": "MPBERJAAMT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "MPBERJ$AMT",
														"type": "Decimal"
													},
													"sink": {
														"name": "MPBERJ$AMT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "MPBEFTNAMT",
														"type": "Decimal"
													},
													"sink": {
														"name": "MPBEFTNAMT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "MPBEFTAAMT",
														"type": "Decimal"
													},
													"sink": {
														"name": "MPBEFTAAMT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "MPBEFT$AMT",
														"type": "Decimal"
													},
													"sink": {
														"name": "MPBEFT$AMT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "MPBCCDCNT",
														"type": "Decimal"
													},
													"sink": {
														"name": "MPBCCDCNT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "MPBCCDTOT",
														"type": "Decimal"
													},
													"sink": {
														"name": "MPBCCDTOT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "MPBCCTAAMT",
														"type": "Decimal"
													},
													"sink": {
														"name": "MPBCCTAAMT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "MPBCCT$AMT",
														"type": "Decimal"
													},
													"sink": {
														"name": "MPBCCT$AMT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "MPBCCDXCNT",
														"type": "Decimal"
													},
													"sink": {
														"name": "MPBCCDXCNT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "MPBCCDXAMT",
														"type": "Decimal"
													},
													"sink": {
														"name": "MPBCCDXAMT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "MPBCCDECNT",
														"type": "Decimal"
													},
													"sink": {
														"name": "MPBCCDECNT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "MPBCCDEAMT",
														"type": "Decimal"
													},
													"sink": {
														"name": "MPBCCDEAMT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "MPBCRJAAMT",
														"type": "Decimal"
													},
													"sink": {
														"name": "MPBCRJAAMT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "MPBCRJ$AMT",
														"type": "Decimal"
													},
													"sink": {
														"name": "MPBCRJ$AMT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "MPBCCDNAMT",
														"type": "Decimal"
													},
													"sink": {
														"name": "MPBCCDNAMT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "MPBCCDAAMT",
														"type": "Decimal"
													},
													"sink": {
														"name": "MPBCCDAAMT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "MPBCCDA$AM",
														"type": "Decimal"
													},
													"sink": {
														"name": "MPBCCDA$AM",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "MPBAMXCNT",
														"type": "Decimal"
													},
													"sink": {
														"name": "MPBAMXCNT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "MPBAMXTOT",
														"type": "Decimal"
													},
													"sink": {
														"name": "MPBAMXTOT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "MPBAMXXCNT",
														"type": "Decimal"
													},
													"sink": {
														"name": "MPBAMXXCNT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "MPBAMXXAMT",
														"type": "Decimal"
													},
													"sink": {
														"name": "MPBAMXXAMT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "MPBAMXECNT",
														"type": "Decimal"
													},
													"sink": {
														"name": "MPBAMXECNT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "MPBAMXEAMT",
														"type": "Decimal"
													},
													"sink": {
														"name": "MPBAMXEAMT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "MPBAMXEAAM",
														"type": "Decimal"
													},
													"sink": {
														"name": "MPBAMXEAAM",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "MPBAMXE$AM",
														"type": "Decimal"
													},
													"sink": {
														"name": "MPBAMXE$AM",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "MPBAMXNAMT",
														"type": "Decimal"
													},
													"sink": {
														"name": "MPBAMXNAMT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "MPBAMXAAAM",
														"type": "Decimal"
													},
													"sink": {
														"name": "MPBAMXAAAM",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "MPBAMXA$AM",
														"type": "Decimal"
													},
													"sink": {
														"name": "MPBAMXA$AM",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "MPBDINCNT",
														"type": "Decimal"
													},
													"sink": {
														"name": "MPBDINCNT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "MPBDINTOT",
														"type": "Decimal"
													},
													"sink": {
														"name": "MPBDINTOT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "MPBDINXCNT",
														"type": "Decimal"
													},
													"sink": {
														"name": "MPBDINXCNT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "MPBDINXAMT",
														"type": "Decimal"
													},
													"sink": {
														"name": "MPBDINXAMT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "MPBDINECNT",
														"type": "Decimal"
													},
													"sink": {
														"name": "MPBDINECNT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "MPBDINEAMT",
														"type": "Decimal"
													},
													"sink": {
														"name": "MPBDINEAMT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "MPBDINEAAM",
														"type": "Decimal"
													},
													"sink": {
														"name": "MPBDINEAAM",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "MPBDINE$AM",
														"type": "Decimal"
													},
													"sink": {
														"name": "MPBDINE$AM",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "MPBDINNAMT",
														"type": "Decimal"
													},
													"sink": {
														"name": "MPBDINNAMT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "MPBDINAAAM",
														"type": "Decimal"
													},
													"sink": {
														"name": "MPBDINAAAM",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "MPBDINA$AM",
														"type": "Decimal"
													},
													"sink": {
														"name": "MPBDINA$AM",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "MPBDISCNT",
														"type": "Decimal"
													},
													"sink": {
														"name": "MPBDISCNT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "MPBDISTOT",
														"type": "Decimal"
													},
													"sink": {
														"name": "MPBDISTOT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "MPBDISXCNT",
														"type": "Decimal"
													},
													"sink": {
														"name": "MPBDISXCNT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "MPBDISXAMT",
														"type": "Decimal"
													},
													"sink": {
														"name": "MPBDISXAMT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "MPBDISECNT",
														"type": "Decimal"
													},
													"sink": {
														"name": "MPBDISECNT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "MPBDISEAMT",
														"type": "Decimal"
													},
													"sink": {
														"name": "MPBDISEAMT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "MPBDISEAAM",
														"type": "Decimal"
													},
													"sink": {
														"name": "MPBDISEAAM",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "MPBDISE$AM",
														"type": "Decimal"
													},
													"sink": {
														"name": "MPBDISE$AM",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "MPBDISNAMT",
														"type": "Decimal"
													},
													"sink": {
														"name": "MPBDISNAMT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "MPBDISAAAM",
														"type": "Decimal"
													},
													"sink": {
														"name": "MPBDISAAAM",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "MPBDISA$AM",
														"type": "Decimal"
													},
													"sink": {
														"name": "MPBDISA$AM",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "MPBMASCNT",
														"type": "Decimal"
													},
													"sink": {
														"name": "MPBMASCNT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "MPBMASTOT",
														"type": "Decimal"
													},
													"sink": {
														"name": "MPBMASTOT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "MPBMASXCNT",
														"type": "Decimal"
													},
													"sink": {
														"name": "MPBMASXCNT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "MPBMASXAMT",
														"type": "Decimal"
													},
													"sink": {
														"name": "MPBMASXAMT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "MPBMASECNT",
														"type": "Decimal"
													},
													"sink": {
														"name": "MPBMASECNT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "MPBMASEAMT",
														"type": "Decimal"
													},
													"sink": {
														"name": "MPBMASEAMT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "MPBMASEAAM",
														"type": "Decimal"
													},
													"sink": {
														"name": "MPBMASEAAM",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "MPBMASE$AM",
														"type": "Decimal"
													},
													"sink": {
														"name": "MPBMASE$AM",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "MPBMASNAMT",
														"type": "Decimal"
													},
													"sink": {
														"name": "MPBMASNAMT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "MPBMASAAAM",
														"type": "Decimal"
													},
													"sink": {
														"name": "MPBMASAAAM",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "MPBMASA$AM",
														"type": "Decimal"
													},
													"sink": {
														"name": "MPBMASA$AM",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "MPBVISCNT",
														"type": "Decimal"
													},
													"sink": {
														"name": "MPBVISCNT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "MPBVISTOT",
														"type": "Decimal"
													},
													"sink": {
														"name": "MPBVISTOT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "MPBVISXCNT",
														"type": "Decimal"
													},
													"sink": {
														"name": "MPBVISXCNT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "MPBVISXAMT",
														"type": "Decimal"
													},
													"sink": {
														"name": "MPBVISXAMT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "MPBVISECNT",
														"type": "Decimal"
													},
													"sink": {
														"name": "MPBVISECNT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "MPBVISEAMT",
														"type": "Decimal"
													},
													"sink": {
														"name": "MPBVISEAMT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "MPBVISEAAM",
														"type": "Decimal"
													},
													"sink": {
														"name": "MPBVISEAAM",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "MPBVISE$AM",
														"type": "Decimal"
													},
													"sink": {
														"name": "MPBVISE$AM",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "MPBVISNAMT",
														"type": "Decimal"
													},
													"sink": {
														"name": "MPBVISNAMT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "MPBVISAAAM",
														"type": "Decimal"
													},
													"sink": {
														"name": "MPBVISAAAM",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "MPBVISA$AM",
														"type": "Decimal"
													},
													"sink": {
														"name": "MPBVISA$AM",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "MPBLDERR",
														"type": "String"
													},
													"sink": {
														"name": "MPBLDERR",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "MPBWF1",
														"type": "String"
													},
													"sink": {
														"name": "MPBWF1",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "MPBWF2",
														"type": "String"
													},
													"sink": {
														"name": "MPBWF2",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "MPBWF3",
														"type": "String"
													},
													"sink": {
														"name": "MPBWF3",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "MPBWF4",
														"type": "String"
													},
													"sink": {
														"name": "MPBWF4",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "MPBWF5",
														"type": "String"
													},
													"sink": {
														"name": "MPBWF5",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "MPBWF6",
														"type": "String"
													},
													"sink": {
														"name": "MPBWF6",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "MPBWF7",
														"type": "String"
													},
													"sink": {
														"name": "MPBWF7",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "MPBWF8",
														"type": "String"
													},
													"sink": {
														"name": "MPBWF8",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "MPBWF9",
														"type": "String"
													},
													"sink": {
														"name": "MPBWF9",
														"type": "String"
													}
												}
											]
										}
									},
									"inputs": [
										{
											"referenceName": "Iseries_Prod",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "SNK_SYN_ISERIES_MPBFIL_INCR",
											"type": "DatasetReference",
											"parameters": {}
										}
									]
								}
							]
						}
					},
					{
						"name": "Truncate Incr table",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "truncate table StgIseries.ABC400FIL_MPBFIL_INCR;\nselect 0;",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "AzureSynapseAnalyticsDB",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": false
						}
					},
					{
						"name": "Merge to Staging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "ForEach1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[StgIseries].[ABC400FIL_mpbfil_Merge]"
						},
						"linkedServiceName": {
							"referenceName": "AzureSynapseAnalytics1",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Lookup1",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Truncate Incr table",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderStoredProcedureName": "[[abcpi].[GetClubToLoad_50]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "AzureSynapseAnalyticsDB",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": false
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"windowStart": {
						"type": "String"
					},
					"windowEnd": {
						"type": "String"
					}
				},
				"folder": {
					"name": "Iseries_SQLPOOL/Load_Source_Iseries_Group3_SQLPOOL"
				},
				"annotations": [],
				"lastPublishTime": "2023-02-24T15:45:49Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/ABC400FIL_MPPFIL_SQLPOOL')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "ForEach1",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "Lookup1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('Lookup1').output.value",
								"type": "Expression"
							},
							"isSequential": false,
							"batchCount": 50,
							"activities": [
								{
									"name": "ABC400FIL_MPPFIL_1",
									"description": "",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "Db2Source",
											"query": {
												"value": "SELECT a.* \nFROM ABC400FIL.MPPFIL a\nWHERE  a.MPPDTE between int(@{pipeline().parameters.windowStart}) AND int(@{pipeline().parameters.windowEnd})\nAND  a.MPPCLI in @{item().cbcpy_list} with UR",
												"type": "Expression"
											}
										},
										"sink": {
											"type": "SqlDWSink",
											"allowPolyBase": true,
											"polyBaseSettings": {
												"rejectValue": 0,
												"rejectType": "value",
												"useTypeDefault": false
											}
										},
										"enableStaging": true,
										"stagingSettings": {
											"linkedServiceName": {
												"referenceName": "AzureBlobStorage1",
												"type": "LinkedServiceReference"
											},
											"path": "vifiles"
										},
										"parallelCopies": 32,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "MPPBTYP",
														"type": "String"
													},
													"sink": {
														"name": "MPPBTYP",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "MPPDTE",
														"type": "Decimal"
													},
													"sink": {
														"name": "MPPDTE",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "MPPCUS",
														"type": "Decimal"
													},
													"sink": {
														"name": "MPPCUS",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "MPPCLI",
														"type": "Decimal"
													},
													"sink": {
														"name": "MPPCLI",
														"type": "Int32"
													}
												},
												{
													"source": {
														"name": "MPPMBR",
														"type": "Decimal"
													},
													"sink": {
														"name": "MPPMBR",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "MPPMBRA",
														"type": "String"
													},
													"sink": {
														"name": "MPPMBRA",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "MPPCLI#",
														"type": "String"
													},
													"sink": {
														"name": "MPPCLI#",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "MPPSEQ",
														"type": "Decimal"
													},
													"sink": {
														"name": "MPPSEQ",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "MPPGUID",
														"type": "String"
													},
													"sink": {
														"name": "MPPGUID",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "MPPFNM",
														"type": "String"
													},
													"sink": {
														"name": "MPPFNM",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "MPPLNM",
														"type": "String"
													},
													"sink": {
														"name": "MPPLNM",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "MPPFNMD",
														"type": "String"
													},
													"sink": {
														"name": "MPPFNMD",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "MPPLNMD",
														"type": "String"
													},
													"sink": {
														"name": "MPPLNMD",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "MPPCTY",
														"type": "String"
													},
													"sink": {
														"name": "MPPCTY",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "MPPTYP",
														"type": "String"
													},
													"sink": {
														"name": "MPPTYP",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "MPPBRN",
														"type": "String"
													},
													"sink": {
														"name": "MPPBRN",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "MPPBAN",
														"type": "Byte[]"
													},
													"sink": {
														"name": "MPPBAN",
														"type": "Byte[]"
													}
												},
												{
													"source": {
														"name": "MPPBAT",
														"type": "String"
													},
													"sink": {
														"name": "MPPBAT",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "MPPINV",
														"type": "Decimal"
													},
													"sink": {
														"name": "MPPINV",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "MPPREJ",
														"type": "Decimal"
													},
													"sink": {
														"name": "MPPREJ",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "MPPNET",
														"type": "Decimal"
													},
													"sink": {
														"name": "MPPNET",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "MPPABCAMT",
														"type": "Decimal"
													},
													"sink": {
														"name": "MPPABCAMT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "MPPIPCT",
														"type": "Decimal"
													},
													"sink": {
														"name": "MPPIPCT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "MPPIAMT",
														"type": "Decimal"
													},
													"sink": {
														"name": "MPPIAMT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "MPPDPCT",
														"type": "Decimal"
													},
													"sink": {
														"name": "MPPDPCT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "MPPDAMT",
														"type": "Decimal"
													},
													"sink": {
														"name": "MPPDAMT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "MPPCPCT",
														"type": "Decimal"
													},
													"sink": {
														"name": "MPPCPCT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "MPPCAMT",
														"type": "Decimal"
													},
													"sink": {
														"name": "MPPCAMT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "MPPSTAT",
														"type": "String"
													},
													"sink": {
														"name": "MPPSTAT",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "MPPRETCD",
														"type": "String"
													},
													"sink": {
														"name": "MPPRETCD",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "MPPCGBCD",
														"type": "String"
													},
													"sink": {
														"name": "MPPCGBCD",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "MPPORGDTE",
														"type": "Decimal"
													},
													"sink": {
														"name": "MPPORGDTE",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "MPPREPDTE",
														"type": "Decimal"
													},
													"sink": {
														"name": "MPPREPDTE",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "MPPFCLBAMT",
														"type": "Decimal"
													},
													"sink": {
														"name": "MPPFCLBAMT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "MPPTCLBAMT",
														"type": "Decimal"
													},
													"sink": {
														"name": "MPPTCLBAMT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "MPPTIPCT",
														"type": "Decimal"
													},
													"sink": {
														"name": "MPPTIPCT",
														"type": "Decimal"
													}
												}
											]
										}
									},
									"inputs": [
										{
											"referenceName": "Iseries_Prod",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "SNK_SYN_ISERIES_MPPFIL_INCR",
											"type": "DatasetReference",
											"parameters": {}
										}
									]
								}
							]
						}
					},
					{
						"name": "Truncate Incr table",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "truncate table StgIseries.ABC400FIL_MPPFIL_INCR;\nselect 0;",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "AzureSynapseAnalyticsDB",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": false
						}
					},
					{
						"name": "Merge to Staging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "ForEach1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[StgIseries].[ABC400FIL_mppfil_Merge]"
						},
						"linkedServiceName": {
							"referenceName": "AzureSynapseAnalytics1",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Lookup1",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Truncate Incr table",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderStoredProcedureName": "[[abcpi].[GetClubToLoad_50]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "AzureSynapseAnalyticsDB",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": false
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"windowStart": {
						"type": "String"
					},
					"windowEnd": {
						"type": "String"
					}
				},
				"folder": {
					"name": "Iseries_SQLPOOL/Load_Source_Iseries_Group3_SQLPOOL"
				},
				"annotations": [],
				"lastPublishTime": "2023-02-24T15:45:49Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/ABC400FIL_PJTFIL_SQLPOOL')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "ForEach1",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "Lookup1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('Lookup1').output.value",
								"type": "Expression"
							},
							"isSequential": false,
							"batchCount": 50,
							"activities": [
								{
									"name": "ABC400FIL_PJTFIL",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "Db2Source",
											"query": {
												"value": "SELECT \nPJTPRJCDE\n      ,PJTCLB\n      ,PJTPRJDTE\n      ,(case when PJTSRTCDE= '1' then '1' when PJTSRTCDE= '2' then '2' else '3' end) as PJTSRTCDE\n      ,PJTCCTCODE\n      ,PJTOCUR$\n      ,PJTOTOT#\n      ,PJTOCUR#\n      ,PJTOCURC\n      ,PJTOPCUR$\n      ,PJTOPCUR#\n      ,PJTOPCURC\n      ,PJTOP130$\n      ,PJTOP130#\n      ,PJTOP130C\n      ,PJTOP3160$\n      ,PJTOP3160#\n      ,PJTOP3160C\n      ,PJTOP6190$\n      ,PJTOP6190#\n      ,PJTOP6190C\n      ,PJTOP91UP$\n      ,PJTOP91UP#\n      ,PJTOP91UPC\n      ,PJTOBALC\n      ,PJTOBAL#\n      ,PJTOBAL$\n      ,PJTOMOINV$\n      ,PJTONTDC\n      ,PJTONTD#\n      ,PJTONTINV$\n      ,PJTONTBAL$\n      ,PJTOINVPD$\n      ,PJTOINVPD#\n      ,PJTOINVPDC\n      ,PJTICUR$\n      ,PJTITOT#\n      ,PJTICUR#\n      ,PJTICURC\n      ,PJTIPCUR$\n      ,PJTIPCUR#\n      ,PJTIPCURC\n      ,PJTIP130$\n      ,PJTIP130#\n      ,PJTIP130C\n      ,PJTIP3160$\n      ,PJTIP3160#\n      ,PJTIP3160C\n      ,PJTIP6190$\n      ,PJTIP6190#\n      ,PJTIP6190C\n      ,PJTIP91UP$\n      ,PJTIP91UP#\n      ,PJTIP91UPC\n      ,PJTIBALC\n      ,PJTIBAL#\n      ,PJTIBAL$\n      ,PJTIMOINV$\n      ,PJTINTD#\n      ,PJTINTDC\n      ,PJTINTINV$\n      ,PJTINTBAL$\n      ,PJTIINVPD$\n      ,PJTIINVPD#\n      ,PJTIINVPDC\n      ,PJTCUR$\n      ,PJTTOT#\n      ,PJTCUR#\n      ,PJTCURC\n      ,PJTPCUR$\n      ,PJTPCUR#\n      ,PJTPCURC\n      ,PJTP130$\n      ,PJTP130#\n      ,PJTP130C\n      ,PJTP3160$\n      ,PJTP3160#\n      ,PJTP3160C\n      ,PJTP6190$\n      ,PJTP6190#\n      ,PJTP6190C\n      ,PJTP91UP$\n      ,PJTP91UP#\n      ,PJTP91UPC\n      ,PJTBAL#\n      ,PJTBALC\n      ,PJTBAL$\n      ,PJTMOINV$\n      ,PJTNTD#\n      ,PJTNTDC\n      ,PJTNTINV$\n      ,PJTNTBAL$\n      ,PJTPIF#\n      ,PJTINVPD$\n      ,PJTINVPD#\n      ,PJTINVPDC\n      ,PJTCPN#\n      ,PJTCPNMO$\n      ,PJTDFT#\n      ,PJTDFTMO$\n      ,PJTCCD#\n      ,PJTCCDMO$\n      ,PJTPRB#\n      ,PJTPRBMO$\n\nFROM ABC400FIL.PJTFIL a\nWHERE a.PJTCLB in @{item().cbcpy_list}\nAND a.PJTPRJDTE between int(@{pipeline().parameters.windowStart}) AND int(@{pipeline().parameters.windowEnd}) WITH UR",
												"type": "Expression"
											}
										},
										"sink": {
											"type": "SqlDWSink",
											"allowPolyBase": true,
											"polyBaseSettings": {
												"rejectValue": 0,
												"rejectType": "value",
												"useTypeDefault": false
											}
										},
										"enableStaging": true,
										"stagingSettings": {
											"linkedServiceName": {
												"referenceName": "AzureBlobStorage1",
												"type": "LinkedServiceReference"
											},
											"path": "vifiles"
										},
										"parallelCopies": 32,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "PJTPRJCDE",
														"type": "String"
													},
													"sink": {
														"name": "PJTPRJCDE",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "PJTCLB",
														"type": "Decimal"
													},
													"sink": {
														"name": "PJTCLB",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "PJTPRJDTE",
														"type": "Decimal"
													},
													"sink": {
														"name": "PJTPRJDTE",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "PJTSRTCDE",
														"type": "String"
													},
													"sink": {
														"name": "PJTSRTCDE",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "PJTCCTCODE",
														"type": "String"
													},
													"sink": {
														"name": "PJTCCTCODE",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "PJTOCUR$",
														"type": "Decimal"
													},
													"sink": {
														"name": "PJTOCUR$",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "PJTOTOT#",
														"type": "Decimal"
													},
													"sink": {
														"name": "PJTOTOT#",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "PJTOCUR#",
														"type": "Decimal"
													},
													"sink": {
														"name": "PJTOCUR#",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "PJTOCURC",
														"type": "Decimal"
													},
													"sink": {
														"name": "PJTOCURC",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "PJTOPCUR$",
														"type": "Decimal"
													},
													"sink": {
														"name": "PJTOPCUR$",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "PJTOPCUR#",
														"type": "Decimal"
													},
													"sink": {
														"name": "PJTOPCUR#",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "PJTOPCURC",
														"type": "Decimal"
													},
													"sink": {
														"name": "PJTOPCURC",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "PJTOP130$",
														"type": "Decimal"
													},
													"sink": {
														"name": "PJTOP130$",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "PJTOP130#",
														"type": "Decimal"
													},
													"sink": {
														"name": "PJTOP130#",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "PJTOP130C",
														"type": "Decimal"
													},
													"sink": {
														"name": "PJTOP130C",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "PJTOP3160$",
														"type": "Decimal"
													},
													"sink": {
														"name": "PJTOP3160$",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "PJTOP3160#",
														"type": "Decimal"
													},
													"sink": {
														"name": "PJTOP3160#",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "PJTOP3160C",
														"type": "Decimal"
													},
													"sink": {
														"name": "PJTOP3160C",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "PJTOP6190$",
														"type": "Decimal"
													},
													"sink": {
														"name": "PJTOP6190$",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "PJTOP6190#",
														"type": "Decimal"
													},
													"sink": {
														"name": "PJTOP6190#",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "PJTOP6190C",
														"type": "Decimal"
													},
													"sink": {
														"name": "PJTOP6190C",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "PJTOP91UP$",
														"type": "Decimal"
													},
													"sink": {
														"name": "PJTOP91UP$",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "PJTOP91UP#",
														"type": "Decimal"
													},
													"sink": {
														"name": "PJTOP91UP#",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "PJTOP91UPC",
														"type": "Decimal"
													},
													"sink": {
														"name": "PJTOP91UPC",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "PJTOBALC",
														"type": "Decimal"
													},
													"sink": {
														"name": "PJTOBALC",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "PJTOBAL#",
														"type": "Decimal"
													},
													"sink": {
														"name": "PJTOBAL#",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "PJTOBAL$",
														"type": "Decimal"
													},
													"sink": {
														"name": "PJTOBAL$",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "PJTOMOINV$",
														"type": "Decimal"
													},
													"sink": {
														"name": "PJTOMOINV$",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "PJTONTDC",
														"type": "Decimal"
													},
													"sink": {
														"name": "PJTONTDC",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "PJTONTD#",
														"type": "Decimal"
													},
													"sink": {
														"name": "PJTONTD#",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "PJTONTINV$",
														"type": "Decimal"
													},
													"sink": {
														"name": "PJTONTINV$",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "PJTONTBAL$",
														"type": "Decimal"
													},
													"sink": {
														"name": "PJTONTBAL$",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "PJTOINVPD$",
														"type": "Decimal"
													},
													"sink": {
														"name": "PJTOINVPD$",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "PJTOINVPD#",
														"type": "Decimal"
													},
													"sink": {
														"name": "PJTOINVPD#",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "PJTOINVPDC",
														"type": "Decimal"
													},
													"sink": {
														"name": "PJTOINVPDC",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "PJTICUR$",
														"type": "Decimal"
													},
													"sink": {
														"name": "PJTICUR$",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "PJTITOT#",
														"type": "Decimal"
													},
													"sink": {
														"name": "PJTITOT#",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "PJTICUR#",
														"type": "Decimal"
													},
													"sink": {
														"name": "PJTICUR#",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "PJTICURC",
														"type": "Decimal"
													},
													"sink": {
														"name": "PJTICURC",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "PJTIPCUR$",
														"type": "Decimal"
													},
													"sink": {
														"name": "PJTIPCUR$",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "PJTIPCUR#",
														"type": "Decimal"
													},
													"sink": {
														"name": "PJTIPCUR#",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "PJTIPCURC",
														"type": "Decimal"
													},
													"sink": {
														"name": "PJTIPCURC",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "PJTIP130$",
														"type": "Decimal"
													},
													"sink": {
														"name": "PJTIP130$",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "PJTIP130#",
														"type": "Decimal"
													},
													"sink": {
														"name": "PJTIP130#",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "PJTIP130C",
														"type": "Decimal"
													},
													"sink": {
														"name": "PJTIP130C",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "PJTIP3160$",
														"type": "Decimal"
													},
													"sink": {
														"name": "PJTIP3160$",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "PJTIP3160#",
														"type": "Decimal"
													},
													"sink": {
														"name": "PJTIP3160#",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "PJTIP3160C",
														"type": "Decimal"
													},
													"sink": {
														"name": "PJTIP3160C",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "PJTIP6190$",
														"type": "Decimal"
													},
													"sink": {
														"name": "PJTIP6190$",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "PJTIP6190#",
														"type": "Decimal"
													},
													"sink": {
														"name": "PJTIP6190#",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "PJTIP6190C",
														"type": "Decimal"
													},
													"sink": {
														"name": "PJTIP6190C",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "PJTIP91UP$",
														"type": "Decimal"
													},
													"sink": {
														"name": "PJTIP91UP$",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "PJTIP91UP#",
														"type": "Decimal"
													},
													"sink": {
														"name": "PJTIP91UP#",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "PJTIP91UPC",
														"type": "Decimal"
													},
													"sink": {
														"name": "PJTIP91UPC",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "PJTIBALC",
														"type": "Decimal"
													},
													"sink": {
														"name": "PJTIBALC",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "PJTIBAL#",
														"type": "Decimal"
													},
													"sink": {
														"name": "PJTIBAL#",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "PJTIBAL$",
														"type": "Decimal"
													},
													"sink": {
														"name": "PJTIBAL$",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "PJTIMOINV$",
														"type": "Decimal"
													},
													"sink": {
														"name": "PJTIMOINV$",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "PJTINTD#",
														"type": "Decimal"
													},
													"sink": {
														"name": "PJTINTD#",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "PJTINTDC",
														"type": "Decimal"
													},
													"sink": {
														"name": "PJTINTDC",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "PJTINTINV$",
														"type": "Decimal"
													},
													"sink": {
														"name": "PJTINTINV$",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "PJTINTBAL$",
														"type": "Decimal"
													},
													"sink": {
														"name": "PJTINTBAL$",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "PJTIINVPD$",
														"type": "Decimal"
													},
													"sink": {
														"name": "PJTIINVPD$",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "PJTIINVPD#",
														"type": "Decimal"
													},
													"sink": {
														"name": "PJTIINVPD#",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "PJTIINVPDC",
														"type": "Decimal"
													},
													"sink": {
														"name": "PJTIINVPDC",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "PJTCUR$",
														"type": "Decimal"
													},
													"sink": {
														"name": "PJTCUR$",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "PJTTOT#",
														"type": "Decimal"
													},
													"sink": {
														"name": "PJTTOT#",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "PJTCUR#",
														"type": "Decimal"
													},
													"sink": {
														"name": "PJTCUR#",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "PJTCURC",
														"type": "Decimal"
													},
													"sink": {
														"name": "PJTCURC",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "PJTPCUR$",
														"type": "Decimal"
													},
													"sink": {
														"name": "PJTPCUR$",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "PJTPCUR#",
														"type": "Decimal"
													},
													"sink": {
														"name": "PJTPCUR#",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "PJTPCURC",
														"type": "Decimal"
													},
													"sink": {
														"name": "PJTPCURC",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "PJTP130$",
														"type": "Decimal"
													},
													"sink": {
														"name": "PJTP130$",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "PJTP130#",
														"type": "Decimal"
													},
													"sink": {
														"name": "PJTP130#",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "PJTP130C",
														"type": "Decimal"
													},
													"sink": {
														"name": "PJTP130C",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "PJTP3160$",
														"type": "Decimal"
													},
													"sink": {
														"name": "PJTP3160$",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "PJTP3160#",
														"type": "Decimal"
													},
													"sink": {
														"name": "PJTP3160#",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "PJTP3160C",
														"type": "Decimal"
													},
													"sink": {
														"name": "PJTP3160C",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "PJTP6190$",
														"type": "Decimal"
													},
													"sink": {
														"name": "PJTP6190$",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "PJTP6190#",
														"type": "Decimal"
													},
													"sink": {
														"name": "PJTP6190#",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "PJTP6190C",
														"type": "Decimal"
													},
													"sink": {
														"name": "PJTP6190C",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "PJTP91UP$",
														"type": "Decimal"
													},
													"sink": {
														"name": "PJTP91UP$",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "PJTP91UP#",
														"type": "Decimal"
													},
													"sink": {
														"name": "PJTP91UP#",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "PJTP91UPC",
														"type": "Decimal"
													},
													"sink": {
														"name": "PJTP91UPC",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "PJTBAL#",
														"type": "Decimal"
													},
													"sink": {
														"name": "PJTBAL#",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "PJTBALC",
														"type": "Decimal"
													},
													"sink": {
														"name": "PJTBALC",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "PJTBAL$",
														"type": "Decimal"
													},
													"sink": {
														"name": "PJTBAL$",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "PJTMOINV$",
														"type": "Decimal"
													},
													"sink": {
														"name": "PJTMOINV$",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "PJTNTD#",
														"type": "Decimal"
													},
													"sink": {
														"name": "PJTNTD#",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "PJTNTDC",
														"type": "Decimal"
													},
													"sink": {
														"name": "PJTNTDC",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "PJTNTINV$",
														"type": "Decimal"
													},
													"sink": {
														"name": "PJTNTINV$",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "PJTNTBAL$",
														"type": "Decimal"
													},
													"sink": {
														"name": "PJTNTBAL$",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "PJTPIF#",
														"type": "Decimal"
													},
													"sink": {
														"name": "PJTPIF#",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "PJTINVPD$",
														"type": "Decimal"
													},
													"sink": {
														"name": "PJTINVPD$",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "PJTINVPD#",
														"type": "Decimal"
													},
													"sink": {
														"name": "PJTINVPD#",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "PJTINVPDC",
														"type": "Decimal"
													},
													"sink": {
														"name": "PJTINVPDC",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "PJTCPN#",
														"type": "Decimal"
													},
													"sink": {
														"name": "PJTCPN#",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "PJTCPNMO$",
														"type": "Decimal"
													},
													"sink": {
														"name": "PJTCPNMO$",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "PJTDFT#",
														"type": "Decimal"
													},
													"sink": {
														"name": "PJTDFT#",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "PJTDFTMO$",
														"type": "Decimal"
													},
													"sink": {
														"name": "PJTDFTMO$",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "PJTCCD#",
														"type": "Decimal"
													},
													"sink": {
														"name": "PJTCCD#",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "PJTCCDMO$",
														"type": "Decimal"
													},
													"sink": {
														"name": "PJTCCDMO$",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "PJTPRB#",
														"type": "Decimal"
													},
													"sink": {
														"name": "PJTPRB#",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "PJTPRBMO$",
														"type": "Decimal"
													},
													"sink": {
														"name": "PJTPRBMO$",
														"type": "Decimal"
													}
												}
											]
										}
									},
									"inputs": [
										{
											"referenceName": "Iseries_Prod",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "SNK_SYN_ISERIES_PJTFIL_INCR",
											"type": "DatasetReference",
											"parameters": {}
										}
									]
								}
							]
						}
					},
					{
						"name": "Lookup1",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Truncate Incr table",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderStoredProcedureName": "[[abcpi].[GetClubToLoad_50]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "AzureSynapseAnalyticsDB",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": false
						}
					},
					{
						"name": "Truncate Incr table",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "truncate table StgIseries.ABC400FIL_PJTFIL_INCR;\nselect 0;\n",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "AzureSynapseAnalyticsDB",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": false
						}
					},
					{
						"name": "Merge to Staging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "ForEach1",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[StgIseries].[ABC400FIL_pjtfil_Merge]"
						},
						"linkedServiceName": {
							"referenceName": "AzureSynapseAnalytics1",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"windowStart": {
						"type": "string"
					},
					"windowEnd": {
						"type": "string"
					}
				},
				"folder": {
					"name": "Iseries_SQLPOOL/Load_Source_Iseries_Group2_SQLPOOL"
				},
				"annotations": [],
				"lastPublishTime": "2023-02-17T13:11:25Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/ABC400FIL_PTFIL_SQLPOOL')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Truncate Incr table",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "truncate table StgIseries.ABC400FIL_PTFIL_INCR;\nselect 0;",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "AzureSynapseAnalyticsDB",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": false
						}
					},
					{
						"name": "Merge to Staging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "ABC400FIL_PTFIL_SQLPOOL",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[StgIseries].[ABC400FIL_PTFIL_Merge]"
						},
						"linkedServiceName": {
							"referenceName": "AzureSynapseAnalytics1",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "ABC400FIL_PTFIL_SQLPOOL",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Truncate Incr table",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "Db2Source",
								"query": {
									"value": "SELECT a.*\nFROM ABC400FIL.PTFIL a  with UR",
									"type": "Expression"
								}
							},
							"sink": {
								"type": "SqlDWSink",
								"allowPolyBase": true,
								"polyBaseSettings": {
									"rejectValue": 0,
									"rejectType": "value",
									"useTypeDefault": false
								},
								"disableMetricsCollection": false
							},
							"enableStaging": true,
							"stagingSettings": {
								"linkedServiceName": {
									"referenceName": "AzureBlobStorage1",
									"type": "LinkedServiceReference"
								},
								"path": "vifiles"
							},
							"parallelCopies": 32,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "PTCDE",
											"type": "String"
										},
										"sink": {
											"name": "PTCDE",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PTDSC",
											"type": "String"
										},
										"sink": {
											"name": "PTDSC",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PTCHG",
											"type": "String"
										},
										"sink": {
											"name": "PTCHG",
											"type": "String"
										}
									}
								]
							}
						},
						"inputs": [
							{
								"referenceName": "SRC_ABC400FIL",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "SNK_SYN_ISERIES_PTFIL_INCR",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"folder": {
					"name": "Iseries_SQLPOOL/Load_Source_Iseries_GroupNoDate_SQLPOOL"
				},
				"annotations": [],
				"lastPublishTime": "2023-02-15T14:53:19Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/ABC400FIL_RFCFILNEW_SQLPOOL')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "ForEach1",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "Lookup1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('Lookup1').output.value",
								"type": "Expression"
							},
							"isSequential": false,
							"batchCount": 50,
							"activities": [
								{
									"name": "ABC400FIL_RFCFILNEW",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "Db2Source",
											"query": {
												"value": "SELECT a.* \nFROM ABC400FIL.RFCFILNEW a\nWHERE a.RFNDTE between int(@{pipeline().parameters.windowStart}) AND int(@{pipeline().parameters.windowEnd})\nAND a.RFNCLB in @{item().cbcpy_list} with UR",
												"type": "Expression"
											}
										},
										"sink": {
											"type": "SqlDWSink",
											"allowPolyBase": true,
											"polyBaseSettings": {
												"rejectValue": 0,
												"rejectType": "value",
												"useTypeDefault": false
											}
										},
										"enableStaging": true,
										"stagingSettings": {
											"linkedServiceName": {
												"referenceName": "AzureBlobStorage1",
												"type": "LinkedServiceReference"
											},
											"path": "vifiles"
										},
										"parallelCopies": 32,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "RFNCLB",
														"type": "Decimal"
													},
													"sink": {
														"name": "RFNCLB",
														"type": "Int32"
													}
												},
												{
													"source": {
														"name": "RFNMBR",
														"type": "Decimal"
													},
													"sink": {
														"name": "RFNMBR",
														"type": "Int32"
													}
												},
												{
													"source": {
														"name": "RFNDTE",
														"type": "Decimal"
													},
													"sink": {
														"name": "RFNDTE",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "RFNTYP",
														"type": "String"
													},
													"sink": {
														"name": "RFNTYP",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "RFNMDE",
														"type": "String"
													},
													"sink": {
														"name": "RFNMDE",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "RFNFRQ",
														"type": "String"
													},
													"sink": {
														"name": "RFNFRQ",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "RFNSNDCOL",
														"type": "String"
													},
													"sink": {
														"name": "RFNSNDCOL",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "RFNPMTAMT",
														"type": "Decimal"
													},
													"sink": {
														"name": "RFNPMTAMT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "RFNBALAMT",
														"type": "Decimal"
													},
													"sink": {
														"name": "RFNBALAMT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "RFNPSTDUE",
														"type": "Decimal"
													},
													"sink": {
														"name": "RFNPSTDUE",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "RFNPCSAMT",
														"type": "Decimal"
													},
													"sink": {
														"name": "RFNPCSAMT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "RFNDFTCDE",
														"type": "String"
													},
													"sink": {
														"name": "RFNDFTCDE",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "RFNRFCCYC",
														"type": "String"
													},
													"sink": {
														"name": "RFNRFCCYC",
														"type": "String"
													}
												}
											]
										}
									},
									"inputs": [
										{
											"referenceName": "Iseries_Prod",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "SNK_SYN_ISERIES_RFCFILNEW_INCR",
											"type": "DatasetReference",
											"parameters": {}
										}
									]
								}
							]
						}
					},
					{
						"name": "Lookup1",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Truncate Incr table",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderStoredProcedureName": "[[abcpi].[GetClubToLoad_50]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "AzureSynapseAnalyticsDB",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": false
						}
					},
					{
						"name": "Truncate Incr table",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "truncate table StgIseries.ABC400FIL_RFCFILNEW_INCR;\nselect 0;",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "AzureSynapseAnalyticsDB",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": false
						}
					},
					{
						"name": "Merge to Staging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "ForEach1",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[StgIseries].[ABC400FIL_rfcfilnew_Merge]"
						},
						"linkedServiceName": {
							"referenceName": "AzureSynapseAnalytics1",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"windowStart": {
						"type": "string"
					},
					"windowEnd": {
						"type": "string"
					}
				},
				"folder": {
					"name": "Iseries_SQLPOOL/Load_Source_Iseries_Group2_SQLPOOL"
				},
				"annotations": [],
				"lastPublishTime": "2023-02-17T13:11:25Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/ABC400FIL_STFIL_SQLPOOL')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Truncate Incr table",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "truncate table StgIseries.ABC400FIL_STFIL_INCR;\nselect 0;",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "AzureSynapseAnalyticsDB",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": false
						}
					},
					{
						"name": "Merge to Staging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "ABC400FIL_STFIL_SQLPOOL",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[StgIseries].[ABC400FIL_STFIL_MERGE]"
						},
						"linkedServiceName": {
							"referenceName": "AzureSynapseAnalytics1",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "ABC400FIL_STFIL_SQLPOOL",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Truncate Incr table",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [
							{
								"name": "Source",
								"value": "ABC400FIL.STFIL"
							},
							{
								"name": "Destination",
								"value": "StgIseries.ABC400FIL_STFIL_INCR"
							}
						],
						"typeProperties": {
							"source": {
								"type": "Db2Source",
								"query": "SELECT *\nFROM ABC400FIL.STFIL  WITH UR"
							},
							"sink": {
								"type": "SqlDWSink",
								"allowPolyBase": true,
								"polyBaseSettings": {
									"rejectValue": 0,
									"rejectType": "value",
									"useTypeDefault": false
								}
							},
							"enableStaging": true,
							"stagingSettings": {
								"linkedServiceName": {
									"referenceName": "AzureBlobStorage1",
									"type": "LinkedServiceReference"
								},
								"path": "vifiles"
							},
							"parallelCopies": 32,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "STCDE",
											"type": "String"
										},
										"sink": {
											"name": "STCDE",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "STDSC",
											"type": "String"
										},
										"sink": {
											"name": "STDSC",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "STCHG",
											"type": "String"
										},
										"sink": {
											"name": "STCHG",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "STCSC",
											"type": "String"
										},
										"sink": {
											"name": "STCSC",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "STTYP",
											"type": "String"
										},
										"sink": {
											"name": "STTYP",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "STADE",
											"type": "String"
										},
										"sink": {
											"name": "STADE",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "STF01",
											"type": "String"
										},
										"sink": {
											"name": "STF01",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "STF02",
											"type": "String"
										},
										"sink": {
											"name": "STF02",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "STF03",
											"type": "String"
										},
										"sink": {
											"name": "STF03",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "STF04",
											"type": "String"
										},
										"sink": {
											"name": "STF04",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "STF05",
											"type": "String"
										},
										"sink": {
											"name": "STF05",
											"type": "String"
										}
									}
								]
							}
						},
						"inputs": [
							{
								"referenceName": "SRC_ABC400FIL",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "SNK_SYN_ISERIES_STFIL_INCR",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"folder": {
					"name": "Iseries_SQLPOOL/Load_Source_Iseries_GroupNoDate_SQLPOOL"
				},
				"annotations": [],
				"lastPublishTime": "2023-02-08T11:25:31Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/ABC400FIL_TBNEWEXT_SQLPOOL')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Truncate Incr table",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "truncate table StgIseries.ABC400FIL_TBNEWEXT_INCR;\nselect 0;",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "AzureSynapseAnalyticsDB",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": false
						}
					},
					{
						"name": "Merge to Staging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "ABC400FIL_TBNEWEXT_SQLPOOL",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[StgIseries].[ABC400FIL_TBNEWEXT_Merge]"
						},
						"linkedServiceName": {
							"referenceName": "AzureSynapseAnalytics1",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "ABC400FIL_TBNEWEXT_SQLPOOL",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Truncate Incr table",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "Db2Source",
								"query": {
									"value": "SELECT a.*\nFROM ABC400FIL.TBNEWEXT a\nWHERE a.TBDTE between int(@{pipeline().parameters.windowStart}) AND int(@{pipeline().parameters.windowEnd}) with UR",
									"type": "Expression"
								}
							},
							"sink": {
								"type": "SqlDWSink",
								"allowPolyBase": true,
								"polyBaseSettings": {
									"rejectValue": 0,
									"rejectType": "value",
									"useTypeDefault": false
								}
							},
							"enableStaging": true,
							"stagingSettings": {
								"linkedServiceName": {
									"referenceName": "AzureBlobStorage1",
									"type": "LinkedServiceReference"
								},
								"path": "vifiles"
							},
							"parallelCopies": 32,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "TBDTE",
											"type": "Decimal"
										},
										"sink": {
											"name": "TBDTE",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "TBNUM",
											"type": "Decimal"
										},
										"sink": {
											"name": "TBNUM",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "TBBLDUSR",
											"type": "String"
										},
										"sink": {
											"name": "TBBLDUSR",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "TBBLDCDE",
											"type": "String"
										},
										"sink": {
											"name": "TBBLDCDE",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "TBBLDBSC",
											"type": "String"
										},
										"sink": {
											"name": "TBBLDBSC",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "TBBLDBSD",
											"type": "Decimal"
										},
										"sink": {
											"name": "TBBLDBSD",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "TBBLDDTE",
											"type": "Decimal"
										},
										"sink": {
											"name": "TBBLDDTE",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "TBBLDTIM",
											"type": "Decimal"
										},
										"sink": {
											"name": "TBBLDTIM",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "TBPUTDTE",
											"type": "Decimal"
										},
										"sink": {
											"name": "TBPUTDTE",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "TBPUTTIM",
											"type": "Decimal"
										},
										"sink": {
											"name": "TBPUTTIM",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "TBCLSDTE",
											"type": "Decimal"
										},
										"sink": {
											"name": "TBCLSDTE",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "TBCLSTIM",
											"type": "Decimal"
										},
										"sink": {
											"name": "TBCLSTIM",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "TBPNDPMT#",
											"type": "Decimal"
										},
										"sink": {
											"name": "TBPNDPMT#",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "TBPNDLTE#",
											"type": "Decimal"
										},
										"sink": {
											"name": "TBPNDLTE#",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "TBPNDSRV#",
											"type": "Decimal"
										},
										"sink": {
											"name": "TBPNDSRV#",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "TBPNDCNV#",
											"type": "Decimal"
										},
										"sink": {
											"name": "TBPNDCNV#",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "TBPNDTOT#",
											"type": "Decimal"
										},
										"sink": {
											"name": "TBPNDTOT#",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "TBPNDPMT$",
											"type": "Decimal"
										},
										"sink": {
											"name": "TBPNDPMT$",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "TBPNDLTE$",
											"type": "Decimal"
										},
										"sink": {
											"name": "TBPNDLTE$",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "TBPNDSRV$",
											"type": "Decimal"
										},
										"sink": {
											"name": "TBPNDSRV$",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "TBPNDCNV$",
											"type": "Decimal"
										},
										"sink": {
											"name": "TBPNDCNV$",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "TBPNDTOT$",
											"type": "Decimal"
										},
										"sink": {
											"name": "TBPNDTOT$",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "TBPSTPMT#",
											"type": "Decimal"
										},
										"sink": {
											"name": "TBPSTPMT#",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "TBPSTLTE#",
											"type": "Decimal"
										},
										"sink": {
											"name": "TBPSTLTE#",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "TBPSTSRV#",
											"type": "Decimal"
										},
										"sink": {
											"name": "TBPSTSRV#",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "TBPSTCNV#",
											"type": "Decimal"
										},
										"sink": {
											"name": "TBPSTCNV#",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "TBPSTTOT#",
											"type": "Decimal"
										},
										"sink": {
											"name": "TBPSTTOT#",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "TBPSTPMT$",
											"type": "Decimal"
										},
										"sink": {
											"name": "TBPSTPMT$",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "TBPSTLTE$",
											"type": "Decimal"
										},
										"sink": {
											"name": "TBPSTLTE$",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "TBPSTSRV$",
											"type": "Decimal"
										},
										"sink": {
											"name": "TBPSTSRV$",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "TBPSTCNV$",
											"type": "Decimal"
										},
										"sink": {
											"name": "TBPSTCNV$",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "TBPSTTOT$",
											"type": "Decimal"
										},
										"sink": {
											"name": "TBPSTTOT$",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "TBATMPMT#",
											"type": "Decimal"
										},
										"sink": {
											"name": "TBATMPMT#",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "TBATMLTE#",
											"type": "Decimal"
										},
										"sink": {
											"name": "TBATMLTE#",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "TBATMSRV#",
											"type": "Decimal"
										},
										"sink": {
											"name": "TBATMSRV#",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "TBATMCNV#",
											"type": "Decimal"
										},
										"sink": {
											"name": "TBATMCNV#",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "TBATMTOT#",
											"type": "Decimal"
										},
										"sink": {
											"name": "TBATMTOT#",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "TBATMPMT$",
											"type": "Decimal"
										},
										"sink": {
											"name": "TBATMPMT$",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "TBATMLTE$",
											"type": "Decimal"
										},
										"sink": {
											"name": "TBATMLTE$",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "TBATMSRV$",
											"type": "Decimal"
										},
										"sink": {
											"name": "TBATMSRV$",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "TBATMCNV$",
											"type": "Decimal"
										},
										"sink": {
											"name": "TBATMCNV$",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "TBATMTOT$",
											"type": "Decimal"
										},
										"sink": {
											"name": "TBATMTOT$",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "TBDCLPMT#",
											"type": "Decimal"
										},
										"sink": {
											"name": "TBDCLPMT#",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "TBDCLLTE#",
											"type": "Decimal"
										},
										"sink": {
											"name": "TBDCLLTE#",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "TBDCLSRV#",
											"type": "Decimal"
										},
										"sink": {
											"name": "TBDCLSRV#",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "TBDCLCNV#",
											"type": "Decimal"
										},
										"sink": {
											"name": "TBDCLCNV#",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "TBDCLTOT#",
											"type": "Decimal"
										},
										"sink": {
											"name": "TBDCLTOT#",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "TBDCLPMT$",
											"type": "Decimal"
										},
										"sink": {
											"name": "TBDCLPMT$",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "TBDCLLTE$",
											"type": "Decimal"
										},
										"sink": {
											"name": "TBDCLLTE$",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "TBDCLSRV$",
											"type": "Decimal"
										},
										"sink": {
											"name": "TBDCLSRV$",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "TBDCLCNV$",
											"type": "Decimal"
										},
										"sink": {
											"name": "TBDCLCNV$",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "TBDCLTOT$",
											"type": "Decimal"
										},
										"sink": {
											"name": "TBDCLTOT$",
											"type": "Decimal"
										}
									}
								]
							}
						},
						"inputs": [
							{
								"referenceName": "Iseries_Prod",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "SNK_SYN_ISERIES_TBNEWEXT_INCR",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"windowStart": {
						"type": "String"
					},
					"windowEnd": {
						"type": "String"
					}
				},
				"folder": {
					"name": "Iseries_SQLPOOL/Load_Source_Iseries_Group3_SQLPOOL"
				},
				"annotations": [],
				"lastPublishTime": "2023-02-24T15:45:49Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/ABC400FIL_TCFIL_SQLPOOL')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Truncate Incr table",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "truncate table StgIseries.ABC400FIL_TCFIL_INCR;\nselect 0;",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "AzureSynapseAnalyticsDB",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": false
						}
					},
					{
						"name": "Merge to Staging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "ABC400FIL_TCFIL_SQLPOOL",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[StgIseries].[ABC400FIL_TCFIL_MERGE]"
						},
						"linkedServiceName": {
							"referenceName": "AzureSynapseAnalytics1",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "ABC400FIL_TCFIL_SQLPOOL",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Truncate Incr table",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "Db2Source",
								"query": "SELECT *\nFROM ABC400FIL.TCFIL  WITH UR"
							},
							"sink": {
								"type": "SqlDWSink",
								"allowPolyBase": true,
								"polyBaseSettings": {
									"rejectValue": 0,
									"rejectType": "value",
									"useTypeDefault": false
								}
							},
							"enableStaging": true,
							"stagingSettings": {
								"linkedServiceName": {
									"referenceName": "AzureBlobStorage1",
									"type": "LinkedServiceReference"
								},
								"path": "vifiles"
							},
							"parallelCopies": 32,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "TCCDE",
											"type": "String"
										},
										"sink": {
											"name": "TCCDE",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "TCTXT",
											"type": "String"
										},
										"sink": {
											"name": "TCTXT",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "TCTYP",
											"type": "String"
										},
										"sink": {
											"name": "TCTYP",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "TCSGN",
											"type": "String"
										},
										"sink": {
											"name": "TCSGN",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "TCGRP",
											"type": "String"
										},
										"sink": {
											"name": "TCGRP",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "TCRSC",
											"type": "String"
										},
										"sink": {
											"name": "TCRSC",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "TCLPM",
											"type": "String"
										},
										"sink": {
											"name": "TCLPM",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "TCSTC",
											"type": "String"
										},
										"sink": {
											"name": "TCSTC",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "TCLTR",
											"type": "String"
										},
										"sink": {
											"name": "TCLTR",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "TCCPN",
											"type": "String"
										},
										"sink": {
											"name": "TCCPN",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "TCPMC",
											"type": "String"
										},
										"sink": {
											"name": "TCPMC",
											"type": "String"
										}
									}
								]
							}
						},
						"inputs": [
							{
								"referenceName": "SRC_ABC400FIL",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "SNK_SYN_ISERIES_TCFIL_INCR",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"folder": {
					"name": "Iseries_SQLPOOL/Load_Source_Iseries_GroupNoDate_SQLPOOL"
				},
				"annotations": [],
				"lastPublishTime": "2023-02-09T15:34:53Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/ABC400FIL_TFRATBL_SQLPOOL')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Truncate Incr table",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "truncate table StgIseries.ABC400FIL_TFRATBL_INCR;\nselect 0;",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "AzureSynapseAnalyticsDB",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": false
						}
					},
					{
						"name": "Merge to Staging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "ForEach1",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[StgIseries].[ABC400FIL_tfratbl_Merge]"
						},
						"linkedServiceName": {
							"referenceName": "AzureSynapseAnalytics1",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Lookup1",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Truncate Incr table",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderStoredProcedureName": "[[abcpi].[GetClubToLoad_50]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "AzureSynapseAnalyticsDB",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": false
						}
					},
					{
						"name": "ForEach1",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "Lookup1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('Lookup1').output.value",
								"type": "Expression"
							},
							"isSequential": false,
							"batchCount": 50,
							"activities": [
								{
									"name": "ABC400FIL_TFRATBL",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "Db2Source",
											"query": {
												"value": "SELECT a.*\nFROM ABC400FIL.tfratbl a\nWHERE a.TRTOCLB in @{item().cbcpy_list} and a.trtoord=9 \nand a.TRTRNENT >= TO_DATE('@{formatDateTime(pipeline().parameters.windowStart, 'yyyy-MM-dd HH:mm' )}', 'YYYY-MM-DD HH24:MI')  \nAND   a.TRTRNENT <  TO_DATE('@{formatDateTime(pipeline().parameters.windowEnd, 'yyyy-MM-dd HH:mm' )}', 'YYYY-MM-DD HH24:MI')  with UR",
												"type": "Expression"
											}
										},
										"sink": {
											"type": "SqlDWSink",
											"allowPolyBase": true,
											"polyBaseSettings": {
												"rejectValue": 0,
												"rejectType": "value",
												"useTypeDefault": false
											}
										},
										"enableStaging": true,
										"stagingSettings": {
											"linkedServiceName": {
												"referenceName": "AzureBlobStorage1",
												"type": "LinkedServiceReference"
											},
											"path": "vifiles"
										},
										"parallelCopies": 32,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "TRFNM",
														"type": "String"
													},
													"sink": {
														"name": "TRFNM",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "TRMI",
														"type": "String"
													},
													"sink": {
														"name": "TRMI",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "TRLNM",
														"type": "String"
													},
													"sink": {
														"name": "TRLNM",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "TRACCD",
														"type": "String"
													},
													"sink": {
														"name": "TRACCD",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "TRAD1",
														"type": "String"
													},
													"sink": {
														"name": "TRAD1",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "TRAD2",
														"type": "String"
													},
													"sink": {
														"name": "TRAD2",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "TRCTY",
														"type": "String"
													},
													"sink": {
														"name": "TRCTY",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "TRSTE",
														"type": "String"
													},
													"sink": {
														"name": "TRSTE",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "TRZIP",
														"type": "String"
													},
													"sink": {
														"name": "TRZIP",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "TREMAIL",
														"type": "String"
													},
													"sink": {
														"name": "TREMAIL",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "TRBEMAIL",
														"type": "String"
													},
													"sink": {
														"name": "TRBEMAIL",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "TRDATE",
														"type": "Decimal"
													},
													"sink": {
														"name": "TRDATE",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "TRREASCD",
														"type": "String"
													},
													"sink": {
														"name": "TRREASCD",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "TRTRNFEE",
														"type": "Decimal"
													},
													"sink": {
														"name": "TRTRNFEE",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "TRSKPFLG",
														"type": "String"
													},
													"sink": {
														"name": "TRSKPFLG",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "TRFCPY",
														"type": "String"
													},
													"sink": {
														"name": "TRFCPY",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "TRFRCLB",
														"type": "Decimal"
													},
													"sink": {
														"name": "TRFRCLB",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "TRFRMEM",
														"type": "Decimal"
													},
													"sink": {
														"name": "TRFRMEM",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "TRFRCLBEML",
														"type": "String"
													},
													"sink": {
														"name": "TRFRCLBEML",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "TRFRORD",
														"type": "Decimal"
													},
													"sink": {
														"name": "TRFRORD",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "TRFRTAX",
														"type": "Decimal"
													},
													"sink": {
														"name": "TRFRTAX",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "TRFRNTYP",
														"type": "String"
													},
													"sink": {
														"name": "TRFRNTYP",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "TRTCPY",
														"type": "String"
													},
													"sink": {
														"name": "TRTCPY",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "TRTOCLB",
														"type": "Decimal"
													},
													"sink": {
														"name": "TRTOCLB",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "TRTOMEM",
														"type": "Decimal"
													},
													"sink": {
														"name": "TRTOMEM",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "TRTOCLBEML",
														"type": "String"
													},
													"sink": {
														"name": "TRTOCLBEML",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "TRTOORD",
														"type": "Decimal"
													},
													"sink": {
														"name": "TRTOORD",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "TRTOTAX",
														"type": "Decimal"
													},
													"sink": {
														"name": "TRTOTAX",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "TRTRNTYP",
														"type": "String"
													},
													"sink": {
														"name": "TRTRNTYP",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "TRTRNPGM",
														"type": "String"
													},
													"sink": {
														"name": "TRTRNPGM",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "TRTRNUSR",
														"type": "String"
													},
													"sink": {
														"name": "TRTRNUSR",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "TRTRNENT",
														"type": "DateTime"
													},
													"sink": {
														"name": "TRTRNENT",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"name": "TREMLSNT",
														"type": "String"
													},
													"sink": {
														"name": "TREMLSNT",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "TRAST",
														"type": "String"
													},
													"sink": {
														"name": "TRAST",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "TRSTC",
														"type": "String"
													},
													"sink": {
														"name": "TRSTC",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "TRSTD",
														"type": "Decimal"
													},
													"sink": {
														"name": "TRSTD",
														"type": "Decimal"
													}
												}
											]
										}
									},
									"inputs": [
										{
											"referenceName": "SRC_ABC400FIL",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "SNK_SYN_ISERIES_TFRATBL_INCR",
											"type": "DatasetReference",
											"parameters": {}
										}
									]
								}
							]
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"windowStart": {
						"type": "string"
					},
					"windowEnd": {
						"type": "string"
					}
				},
				"folder": {
					"name": "Iseries_SQLPOOL/Load_Source_Iseries_Group2_SQLPOOL"
				},
				"annotations": [],
				"lastPublishTime": "2023-02-17T13:11:25Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/ABC400FIL_xxxtpetbl_tpe_control_transaction_response_code_SQLPOOL')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Truncate Incr table",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "truncate table StgIseries.ABC400FIL_XXXTPETBL_TPE_CONTROL_TRANSACTION_RESPONSE_CODE_INCR;\nselect 0;",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "AzureSynapseAnalyticsDB",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": false
						}
					},
					{
						"name": "Merge to Staging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "ABC400FIL_xxxtpetbl_tpe_control_trans_response_code",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[StgIseries].[ABC400FIL_xxxtpetbl_tpe_control_transaction_response_code_Merge]"
						},
						"linkedServiceName": {
							"referenceName": "AzureSynapseAnalytics1",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "ABC400FIL_xxxtpetbl_tpe_control_trans_response_code",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Truncate Incr table",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "Db2Source",
								"query": {
									"value": "SELECT \n TCT_PROCESSORCODE,\n TCT_RESPONSECODE,\n TCT_RESPONSETEXT,\n TCT_RESPONSEITS,\n TCT_ABCPOSTCODE,\n TCT_CCDUPDATERCODE\nFROM XXXTPETBL.TPE_CONTROL_TRANSACTION_RESPONSE_CODE  WITH UR",
									"type": "Expression"
								}
							},
							"sink": {
								"type": "SqlDWSink",
								"allowPolyBase": true,
								"polyBaseSettings": {
									"rejectValue": 0,
									"rejectType": "value",
									"useTypeDefault": false
								}
							},
							"enableStaging": true,
							"stagingSettings": {
								"linkedServiceName": {
									"referenceName": "AzureBlobStorage1",
									"type": "LinkedServiceReference"
								},
								"path": "vifiles"
							},
							"parallelCopies": 32,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "TCT_PROCESSORCODE",
											"type": "String"
										},
										"sink": {
											"name": "TCT_PROCESSORCODE",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "TCT_RESPONSECODE",
											"type": "String"
										},
										"sink": {
											"name": "TCT_RESPONSECODE",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "TCT_RESPONSETEXT",
											"type": "String"
										},
										"sink": {
											"name": "TCT_RESPONSETEXT",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "TCT_RESPONSEITS",
											"type": "DateTime"
										},
										"sink": {
											"name": "TCT_RESPONSEITS",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "TCT_ABCPOSTCODE",
											"type": "String"
										},
										"sink": {
											"name": "TCT_ABCPOSTCODE",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "TCT_CCDUPDATERCODE",
											"type": "String"
										},
										"sink": {
											"name": "TCT_CCDUPDATERCODE",
											"type": "String"
										}
									}
								]
							}
						},
						"inputs": [
							{
								"referenceName": "SRC_ABC400FIL",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "SNK_SYN_ISERIES_XXXTPETBL_TPE_CONTROL_TRANSACTION_RESPONSE_CODE_INCR",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"folder": {
					"name": "Iseries_SQLPOOL/Load_Source_Iseries_GroupNoDate_SQLPOOL"
				},
				"annotations": [],
				"lastPublishTime": "2023-02-09T15:34:55Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/ABC400MMF_CCDUPDARCF_SQLPOOL')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "ABC400MMF_CCDUPDARCF_SQLPOOL",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Truncate Incr table",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "Db2Source",
								"query": {
									"value": "SELECT * FROM ABC400MMF.CCDUPDARCF\nWHERE DCUCDATE between int(@{pipeline().parameters.windowStart})  and   int(@{pipeline().parameters.windowEnd}) with UR",
									"type": "Expression"
								}
							},
							"sink": {
								"type": "SqlDWSink",
								"allowPolyBase": true,
								"polyBaseSettings": {
									"rejectValue": 0,
									"rejectType": "value",
									"useTypeDefault": false
								},
								"disableMetricsCollection": false
							},
							"enableStaging": true,
							"stagingSettings": {
								"linkedServiceName": {
									"referenceName": "AzureBlobStorage1",
									"type": "LinkedServiceReference"
								},
								"path": "vifiles"
							},
							"parallelCopies": 32,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "DCUCLB#",
											"type": "Decimal"
										},
										"sink": {
											"name": "DCUCLB#",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "DCUMBR#",
											"type": "Decimal"
										},
										"sink": {
											"name": "DCUMBR#",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "DCUCDATE",
											"type": "Decimal"
										},
										"sink": {
											"name": "DCUCDATE",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "DCUCNTRY",
											"type": "String"
										},
										"sink": {
											"name": "DCUCNTRY",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "DCURCODED",
											"type": "String"
										},
										"sink": {
											"name": "DCURCODED",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "DCUFDRSPD",
											"type": "String"
										},
										"sink": {
											"name": "DCUFDRSPD",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "DCUFDREAD",
											"type": "String"
										},
										"sink": {
											"name": "DCUFDREAD",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "DCURCODE",
											"type": "String"
										},
										"sink": {
											"name": "DCURCODE",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "DCUFDRSP",
											"type": "String"
										},
										"sink": {
											"name": "DCUFDRSP",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "DCUFDREA",
											"type": "String"
										},
										"sink": {
											"name": "DCUFDREA",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "DCUBDATE",
											"type": "Decimal"
										},
										"sink": {
											"name": "DCUBDATE",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "DCUSDATE",
											"type": "Decimal"
										},
										"sink": {
											"name": "DCUSDATE",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "DCURDATE",
											"type": "Decimal"
										},
										"sink": {
											"name": "DCURDATE",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "DCUBCODE",
											"type": "String"
										},
										"sink": {
											"name": "DCUBCODE",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "DCUUDATE",
											"type": "Decimal"
										},
										"sink": {
											"name": "DCUUDATE",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "DCUPDATE",
											"type": "Decimal"
										},
										"sink": {
											"name": "DCUPDATE",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "DCUCLSACT",
											"type": "String"
										},
										"sink": {
											"name": "DCUCLSACT",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "DCUASTRIK",
											"type": "String"
										},
										"sink": {
											"name": "DCUASTRIK",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "DCUOCCTYP",
											"type": "String"
										},
										"sink": {
											"name": "DCUOCCTYP",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "DCUOACCT#",
											"type": "String"
										},
										"sink": {
											"name": "DCUOACCT#",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "DCUOEXPDT",
											"type": "String"
										},
										"sink": {
											"name": "DCUOEXPDT",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "DCUNCCTYP",
											"type": "String"
										},
										"sink": {
											"name": "DCUNCCTYP",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "DCUNACCT#",
											"type": "String"
										},
										"sink": {
											"name": "DCUNACCT#",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "DCUNEXPDT",
											"type": "String"
										},
										"sink": {
											"name": "DCUNEXPDT",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "DCUNPDESC",
											"type": "String"
										},
										"sink": {
											"name": "DCUNPDESC",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "DCUSOURCE",
											"type": "String"
										},
										"sink": {
											"name": "DCUSOURCE",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "DCUGUID",
											"type": "String"
										},
										"sink": {
											"name": "DCUGUID",
											"type": "String"
										}
									}
								]
							}
						},
						"inputs": [
							{
								"referenceName": "SRC_ABC400FIL",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "SNK_SYN_ISERIES_ABC400MMF_CCDUPDARCF_INCR",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Truncate Incr table",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "truncate table StgIseries.ABC400MMF_CCDUPDARCF_INCR;\nselect 0;",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "AzureSynapseAnalyticsDB",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": false
						}
					},
					{
						"name": "Merge to Staging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "ABC400MMF_CCDUPDARCF_SQLPOOL",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[StgIseries].[ABC400MMF_Ccdupdarcf_Merge]"
						},
						"linkedServiceName": {
							"referenceName": "AzureSynapseAnalytics1",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"windowStart": {
						"type": "string"
					},
					"windowEnd": {
						"type": "string"
					}
				},
				"folder": {
					"name": "Iseries_SQLPOOL/Load_Source_Iseries_Group4_SQLPOOL"
				},
				"annotations": [],
				"lastPublishTime": "2023-02-08T11:25:31Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/ACCESSSCHEMELOCATIONS_SQLPOOL')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "ForEach1",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "Lookup1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('Lookup1').output.value",
								"type": "Expression"
							},
							"isSequential": false,
							"activities": [
								{
									"name": "ACCESSSCHEMELOCATIONS_SQLPOOL",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "OracleSource",
											"oracleReaderQuery": {
												"value": "select \n/*+INDEX(t,ASCH_SPL_IDX)*/ *  from BETADATA.ACCESSSCHEMELOCATIONS t\nWHERE VPD_ID in @{item().vpd_list}",
												"type": "Expression"
											},
											"partitionOption": "None"
										},
										"sink": {
											"type": "SqlDWSink",
											"allowPolyBase": true,
											"polyBaseSettings": {
												"rejectValue": 0,
												"rejectType": "value",
												"useTypeDefault": false
											}
										},
										"enableStaging": true,
										"stagingSettings": {
											"linkedServiceName": {
												"referenceName": "AzureBlobStorage1",
												"type": "LinkedServiceReference"
											},
											"path": "vifiles"
										},
										"parallelCopies": 32,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "VPD_ID",
														"type": "Decimal"
													},
													"sink": {
														"name": "VPD_ID",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "ATL_ID",
														"type": "String"
													},
													"sink": {
														"name": "ATL_ID",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "SPL_ID_FROM",
														"type": "String"
													},
													"sink": {
														"name": "SPL_ID_FROM",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "SPL_ID_TO",
														"type": "String"
													},
													"sink": {
														"name": "SPL_ID_TO",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "ASCH_ID",
														"type": "String"
													},
													"sink": {
														"name": "ASCH_ID",
														"type": "String"
													}
												}
											]
										}
									},
									"inputs": [
										{
											"referenceName": "SRC_BETADATA_ACCESSSCHEMELOCATIONS",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "SNK_SYN_DT_ACCESSSCHEMELOCATIONS_INCR",
											"type": "DatasetReference",
											"parameters": {}
										}
									]
								}
							]
						}
					},
					{
						"name": "Lookup1",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Truncate incr table",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderStoredProcedureName": "[[abcpi].[GetVPDToLoad]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "AzureSynapseAnalyticsDB",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": false
						}
					},
					{
						"name": "Truncate incr table",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "truncate table StgDatatrak.stg_ACCESSSCHEMELOCATIONS_incr;\nselect 0;",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "AzureSynapseAnalyticsDB",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Merge to Staging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "ForEach1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[StgDatatrak].[STG_ACCESSSCHEMELOCATIONS_MERGE]"
						},
						"linkedServiceName": {
							"referenceName": "AzureSynapseAnalytics1",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"folder": {
					"name": "Oracle_SQLPOOL/Oracle_SQL_POOL_GroupNoDate"
				},
				"annotations": [],
				"lastPublishTime": "2023-02-08T11:25:20Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/ACCOUNTINFOTYPES_SQLPOOL')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "ACCOUNTINFOTYPES_INCR",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [
							{
								"name": "Source",
								"value": "."
							},
							{
								"name": "Destination",
								"value": "StgDatatrak.STG_ACCOUNTINFOTYPES_INCR"
							}
						],
						"typeProperties": {
							"source": {
								"type": "OracleSource",
								"oracleReaderQuery": "select * from betadata.accountinfotypes;",
								"partitionOption": "None",
								"queryTimeout": "02:00:00"
							},
							"sink": {
								"type": "SqlDWSink",
								"preCopyScript": "Truncate table StgDatatrak.stg_accountinfotypes_incr;",
								"allowPolyBase": true,
								"polyBaseSettings": {
									"rejectValue": 0,
									"rejectType": "value",
									"useTypeDefault": false
								},
								"disableMetricsCollection": false
							},
							"enableStaging": true,
							"stagingSettings": {
								"linkedServiceName": {
									"referenceName": "AzureBlobStorage1",
									"type": "LinkedServiceReference"
								},
								"path": "vifiles"
							},
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "AIT_ID",
											"type": "String"
										},
										"sink": {
											"name": "AIT_ID",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "AIT_NAME",
											"type": "String"
										},
										"sink": {
											"name": "AIT_NAME",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "AIT_METHOD",
											"type": "String"
										},
										"sink": {
											"name": "AIT_METHOD",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "AIT_PPT_ABC_CODE",
											"type": "String"
										},
										"sink": {
											"name": "AIT_PPT_ABC_CODE",
											"type": "String"
										}
									}
								]
							}
						},
						"inputs": [
							{
								"referenceName": "SRC_BETADATA_ACCOUNTINFOTYPES",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "SNK_SYN_DT_ACCOUNTINFOTYPES_INCR",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Merge to Staging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "ACCOUNTINFOTYPES_INCR",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[StgDatatrak].[STG_ACCOUNTINFOTYPES_MERGE]"
						},
						"linkedServiceName": {
							"referenceName": "AzureSynapseAnalytics1",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"folder": {
					"name": "Oracle_SQLPOOL/Oracle_SQL_POOL_GroupNoDate"
				},
				"annotations": [],
				"lastPublishTime": "2023-02-08T11:25:30Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/ACCOUNTINFO_SQLPOOL')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "ForEach1",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "Lookup1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('Lookup1').output.value",
								"type": "Expression"
							},
							"isSequential": false,
							"activities": [
								{
									"name": "ACCOUNTINFO",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [
										{
											"name": "Source",
											"value": "."
										},
										{
											"name": "Destination",
											"value": "ABCPI.STG_ACCOUNTINFO"
										}
									],
									"typeProperties": {
										"source": {
											"type": "OracleSource",
											"oracleReaderQuery": {
												"value": "select /*+INDEX(t,AI_MODIFIED ASC)*/ * from BETADATA.ACCOUNTINFO t\nwhere AI_MODIFIED >= TO_DATE('@{formatDateTime(pipeline().parameters.windowStart, 'yyyy-MM-dd HH:mm' )}', 'YYYY-MM-DD HH24:MI') \nAND AI_MODIFIED < TO_DATE('@{formatDateTime(pipeline().parameters.windowEnd, 'yyyy-MM-dd HH:mm' )}', 'YYYY-MM-DD HH24:MI')\nAND VPD_ID in @{item().vpd_list}",
												"type": "Expression"
											},
											"partitionOption": "None"
										},
										"sink": {
											"type": "SqlDWSink",
											"allowPolyBase": true,
											"polyBaseSettings": {
												"rejectValue": 0,
												"rejectType": "value",
												"useTypeDefault": false
											}
										},
										"enableStaging": true,
										"stagingSettings": {
											"linkedServiceName": {
												"referenceName": "AzureBlobStorage1",
												"type": "LinkedServiceReference"
											}
										},
										"parallelCopies": 32,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "VPD_ID",
														"type": "Decimal"
													},
													"sink": {
														"name": "VPD_ID",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "AI_ID",
														"type": "String"
													},
													"sink": {
														"name": "AI_ID",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "AI_CREATED",
														"type": "DateTime"
													},
													"sink": {
														"name": "AI_CREATED",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"name": "AI_MODIFIED",
														"type": "DateTime"
													},
													"sink": {
														"name": "AI_MODIFIED",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"name": "AI_NAME_FIRST",
														"type": "String"
													},
													"sink": {
														"name": "AI_NAME_FIRST",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "AI_NAME_LAST",
														"type": "String"
													},
													"sink": {
														"name": "AI_NAME_LAST",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "AI_ROUTING",
														"type": "String"
													},
													"sink": {
														"name": "AI_ROUTING",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "AI_BANK_NAME",
														"type": "String"
													},
													"sink": {
														"name": "AI_BANK_NAME",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "AI_ACCOUNT_ENC_KEY",
														"type": "String"
													},
													"sink": {
														"name": "AI_ACCOUNT_ENC_KEY",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "AI_ACCOUNT_ENC_DATA",
														"type": "String"
													},
													"sink": {
														"name": "AI_ACCOUNT_ENC_DATA",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "AI_ACCOUNT_LAST_FOUR",
														"type": "String"
													},
													"sink": {
														"name": "AI_ACCOUNT_LAST_FOUR",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "AI_EXPIRATION",
														"type": "DateTime"
													},
													"sink": {
														"name": "AI_EXPIRATION",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"name": "AI_ZIP",
														"type": "String"
													},
													"sink": {
														"name": "AI_ZIP",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "AIT_ID",
														"type": "String"
													},
													"sink": {
														"name": "AIT_ID",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "M_ID",
														"type": "String"
													},
													"sink": {
														"name": "M_ID",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "AI_ACCOUNT_LENGTH",
														"type": "Decimal"
													},
													"sink": {
														"name": "AI_ACCOUNT_LENGTH",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "AI_SWIPED",
														"type": "String"
													},
													"sink": {
														"name": "AI_SWIPED",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "AI_ACTIVE",
														"type": "String"
													},
													"sink": {
														"name": "AI_ACTIVE",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "AI_HARD_DECLINE",
														"type": "String"
													},
													"sink": {
														"name": "AI_HARD_DECLINE",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "AI_MODIFIED_LOCAL",
														"type": "DateTime"
													},
													"sink": {
														"name": "AI_MODIFIED_LOCAL",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"name": "TZL_ID_MODIFIED_LOCAL",
														"type": "String"
													},
													"sink": {
														"name": "TZL_ID_MODIFIED_LOCAL",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "DOC_ID",
														"type": "String"
													},
													"sink": {
														"name": "DOC_ID",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "HASH_ID",
														"type": "Decimal"
													},
													"sink": {
														"name": "HASH_ID",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "AI_UPDATE_ATTEMPTED",
														"type": "String"
													},
													"sink": {
														"name": "AI_UPDATE_ATTEMPTED",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "BIC_ROUTING_NUMBER",
														"type": "String"
													},
													"sink": {
														"name": "BIC_ROUTING_NUMBER",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "AI_VERISHIELD_KEY",
														"type": "String"
													},
													"sink": {
														"name": "AI_VERISHIELD_KEY",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "AI_VERISHIELD_DATA",
														"type": "String"
													},
													"sink": {
														"name": "AI_VERISHIELD_DATA",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "AI_PAYMENT_METHOD_MODIFIED",
														"type": "DateTime"
													},
													"sink": {
														"name": "AI_PAYMENT_METHOD_MODIFIED",
														"type": "DateTime"
													}
												}
											]
										}
									},
									"inputs": [
										{
											"referenceName": "SRC_BETADATA_ACCOUNTINFO",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "SNK_SYN_DT_STG_ACCOUNTINFO_INCR",
											"type": "DatasetReference",
											"parameters": {}
										}
									]
								}
							]
						}
					},
					{
						"name": "Lookup1",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Truncate incr table",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderStoredProcedureName": "[[abcpi].[GetVPDToLoad]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "AzureSynapseAnalyticsDB",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": false
						}
					},
					{
						"name": "Truncate incr table",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "truncate table StgDatatrak.STG_ACCOUNTINFO_INCR;\nSELECT 0;",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "AzureSynapseAnalyticsDB",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Merge to Staging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "ForEach1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[StgDatatrak].[STG_ACCOUNTINFO_MERGE]"
						},
						"linkedServiceName": {
							"referenceName": "AzureSynapseAnalytics1",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"windowStart": {
						"type": "String"
					},
					"windowEnd": {
						"type": "String"
					}
				},
				"folder": {
					"name": "Oracle_SQLPOOL/Oracle_SQL_POOL_Group1"
				},
				"annotations": [],
				"lastPublishTime": "2023-02-08T11:25:31Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/ACCOUNTING_BUNDLED_ACH_RETURN_SQLPOOL')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Merge to Staging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "ACCOUNTING_BUNDLED_RETURN",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Accounting].[Bundled_ACH_RETURN_Merge]"
						},
						"linkedServiceName": {
							"referenceName": "AzureSynapseAnalytics1",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Truncate Incr table",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "truncate table ACCOUNTING.BUNDLED_ACH_RETURN_INCR;\nselect 0;",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "AzureSynapseAnalyticsDB",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": false
						}
					},
					{
						"name": "ACCOUNTING_BUNDLED_RETURN",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Truncate Incr table",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": {
									"value": "\nselect abar.bar_id as id\n    ,abar.tran_unique_transaction_number\n    ,acae.cae_transaction_type AS 'transaction_key'\n\t,acae.cae_posting_date\n    ,NULL as 'bae_posting_date'\n    ,aset.stlm_posting_date as 'client_settlement_date'\n    ,ol.loc_number\n\t,ol.loc_name\n    ,om.m_number as 'member_number'\n    ,app.pp_account_number as 'payor_account_number'\n    ,om.m_name_first\n    ,om.m_name_last\n    ,acae.cae_transaction_type as 'transaction_type'\n    ,acae.cae_type as 'type'\n    ,acae.cae_amount as 'amount'\n    ,apm.pame_subtype as 'pame_subtype'\n    ,CASE when apm.pame_type IS NULL then 'OTHER' else apm.pame_type end as  'pame_brand'\n    ,abar.bar_number as 'ar_number'\n    ,NULL AS 'pame_routing'\n\t,abup.bpay_status as 'pay_status'\n    ,CAST(abup.bpay_posting_date as date) 'ar_transaction_date'\n    ,abup.bpay_number as 'pay_number'\n\t,abar.bar_modified as transaction_modified_date\nFROM StgRCM.abcbilling_client_account_entry acae\nINNER JOIN StgRCM.abcbilling_client_account aca on acae.client_id = aca.client_id\nINNER JOIN StgRCM.organization_location ol on aca.loc_id = ol.loc_id\nINNER JOIN StgRCM.abcbilling_bundled_ach_return abar on acae.cae_transaction_id = abar.bar_id\nLEFT JOIN StgRCM.abcbilling_settlement aset on acae.stlm_id = aset.stlm_id\nINNER JOIN StgRCM.abcbilling_bundled_payment abup on abar.bpay_id = abup.bpay_id\nLEFT JOIN StgRCM.abcbilling_payment_method apm on abup.tok_id = apm.tok_id\nLEFT JOIN StgRCM.abcbilling_payor_profile app on apm.payor_id = app.payor_id\nLEFT JOIN StgRCM.organization_member om on app.m_id = om.m_id\nWHERE bar_modified  >= CONVERT(datetime,'@{formatDateTime(pipeline().parameters.windowStart, 'yyyy-MM-dd HH:mm' )}')\n\tAND bar_modified   < CONVERT(datetime,'@{formatDateTime(pipeline().parameters.windowEnd, 'yyyy-MM-dd HH:mm' )}')\n",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "SqlDWSink",
								"allowPolyBase": true,
								"polyBaseSettings": {
									"rejectValue": 0,
									"rejectType": "value",
									"useTypeDefault": false
								}
							},
							"enableStaging": true,
							"stagingSettings": {
								"linkedServiceName": {
									"referenceName": "AzureBlobStorage1",
									"type": "LinkedServiceReference"
								},
								"path": "vifiles"
							},
							"parallelCopies": 32,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "id",
											"type": "String"
										},
										"sink": {
											"name": "id",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "tran_unique_transaction_number",
											"type": "String"
										},
										"sink": {
											"name": "tran_unique_transaction_number",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "transaction_key",
											"type": "String"
										},
										"sink": {
											"name": "transaction_key",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "cae_posting_date",
											"type": "DateTime"
										},
										"sink": {
											"name": "cae_posting_date",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "bae_posting_date",
											"type": "Int32"
										},
										"sink": {
											"name": "bae_posting_date",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "client_settlement_date",
											"type": "DateTime"
										},
										"sink": {
											"name": "client_settlement_date",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "loc_number",
											"type": "String"
										},
										"sink": {
											"name": "loc_number",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "loc_name",
											"type": "String"
										},
										"sink": {
											"name": "loc_name",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "member_number",
											"type": "String"
										},
										"sink": {
											"name": "member_number",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "payor_account_number",
											"type": "String"
										},
										"sink": {
											"name": "payor_account_number",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "m_name_first",
											"type": "String"
										},
										"sink": {
											"name": "m_name_first",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "m_name_last",
											"type": "String"
										},
										"sink": {
											"name": "m_name_last",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "transaction_type",
											"type": "String"
										},
										"sink": {
											"name": "transaction_type",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "type",
											"type": "String"
										},
										"sink": {
											"name": "type",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "amount",
											"type": "Decimal"
										},
										"sink": {
											"name": "amount",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "pame_subtype",
											"type": "String"
										},
										"sink": {
											"name": "pame_subtype",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "pame_brand",
											"type": "String"
										},
										"sink": {
											"name": "pame_brand",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ar_number",
											"type": "String"
										},
										"sink": {
											"name": "ar_number",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "pame_routing",
											"type": "Int32"
										},
										"sink": {
											"name": "pame_routing",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "pay_status",
											"type": "String"
										},
										"sink": {
											"name": "pay_status",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ar_transaction_date",
											"type": "DateTime"
										},
										"sink": {
											"name": "ar_transaction_date",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "pay_number",
											"type": "String"
										},
										"sink": {
											"name": "pay_number",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "transaction_modified_date",
											"type": "DateTime"
										},
										"sink": {
											"name": "transaction_modified_date",
											"type": "DateTime"
										}
									}
								]
							}
						},
						"inputs": [
							{
								"referenceName": "AzureSynapseAnalyticsDB",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "SNK_SYN_ACCOUNTING_BUNDLED_ACH_RETURN_INCR",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"windowStart": {
						"type": "string"
					},
					"windowEnd": {
						"type": "string"
					}
				},
				"folder": {
					"name": "RCM_SQLPOOL"
				},
				"annotations": [],
				"lastPublishTime": "2021-11-12T10:18:39Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/ACCOUNTING_BUNDLED_CHARGEBACK_SQLPOOL')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Merge to Staging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "ACCOUNTING_BUNDLED_CHARGEBACK",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Accounting].[Bundled_CHARGEBACK_Merge]"
						},
						"linkedServiceName": {
							"referenceName": "AzureSynapseAnalytics1",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Truncate Incr table",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "truncate table ACCOUNTING.BUNDLED_CHARGEBACK_INCR;\nselect 0;",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "AzureSynapseAnalyticsDB",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": false
						}
					},
					{
						"name": "ACCOUNTING_BUNDLED_CHARGEBACK",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Truncate Incr table",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": {
									"value": "\nselect abuc.bcb_id as id\n     ,abuc.tran_unique_transaction_number\n    ,acae.cae_transaction_type AS 'transaction_key'\t\n\t,acae.cae_posting_date\n    ,NULL as 'bae_posting_date'\n    ,aset.stlm_posting_date 'client_settlement_date'\n    ,ol.loc_number\n\t,ol.loc_name\n    ,om.m_number 'member_number'\n    ,app.pp_account_number 'payor_account_number'\n    ,om.m_name_first\n    ,om.m_name_last\n    ,acae.cae_transaction_type as 'bae_transaction_type'\n    ,acae.cae_type as 'bae_type'\n    ,acae.cae_amount as 'bae_amount'\n    ,apm.pame_subtype\n    ,case when apm.pame_type IS NULL then 'OTHER' else apm.pame_type end as  'pame_brand'\n    ,abuc.bcb_number as 'cb_number'\n\t,abup.bpay_status as 'pay_status'\n    ,cast(abup.bpay_effective_date as date) as 'cb_transaction_date'\n    ,abup.bpay_number as 'pay_number'\t\n\t,abuc.bcb_modified as transaction_modified_date\nFROM StgRCM.abcbilling_client_account_entry acae\nINNER JOIN StgRCM.abcbilling_client_account aca on acae.client_id = aca.client_id\nINNER JOIN StgRCM.organization_location ol on aca.loc_id = ol.loc_id\nINNER JOIN StgRCM.abcbilling_bundled_chargeback abuc on acae.cae_transaction_id = abuc.bcb_id\nLEFT JOIN StgRCM.abcbilling_settlement aset on acae.stlm_id = aset.stlm_id\nleft JOIN StgRCM.abcbilling_bundled_payment abup on abuc.bpay_id = abup.bpay_id\nleft JOIN StgRCM.abcbilling_payment_method apm on abup.pame_id = apm.pame_id\nleft JOIN StgRCM.abcbilling_payor_profile app on apm.payor_id = app.payor_id\nleft JOIN StgRCM.organization_member om on app.m_id = om.m_id\nWHERE bcb_modified  >= CONVERT(datetime,'@{formatDateTime(pipeline().parameters.windowStart, 'yyyy-MM-dd HH:mm' )}')\n\tAND bcb_modified   < CONVERT(datetime,'@{formatDateTime(pipeline().parameters.windowEnd, 'yyyy-MM-dd HH:mm' )}')\n",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "SqlDWSink",
								"allowPolyBase": true,
								"polyBaseSettings": {
									"rejectValue": 0,
									"rejectType": "value",
									"useTypeDefault": false
								}
							},
							"enableStaging": true,
							"stagingSettings": {
								"linkedServiceName": {
									"referenceName": "AzureBlobStorage1",
									"type": "LinkedServiceReference"
								},
								"path": "vifiles"
							},
							"parallelCopies": 32,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "id",
											"type": "String"
										},
										"sink": {
											"name": "id",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "tran_unique_transaction_number",
											"type": "String"
										},
										"sink": {
											"name": "tran_unique_transaction_number",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "transaction_key",
											"type": "String"
										},
										"sink": {
											"name": "transaction_key",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "cae_posting_date",
											"type": "DateTime"
										},
										"sink": {
											"name": "cae_posting_date",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "bae_posting_date",
											"type": "Int32"
										},
										"sink": {
											"name": "bae_posting_date",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "client_settlement_date",
											"type": "DateTime"
										},
										"sink": {
											"name": "client_settlement_date",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "loc_number",
											"type": "String"
										},
										"sink": {
											"name": "loc_number",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "loc_name",
											"type": "String"
										},
										"sink": {
											"name": "loc_name",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "member_number",
											"type": "String"
										},
										"sink": {
											"name": "member_number",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "payor_account_number",
											"type": "String"
										},
										"sink": {
											"name": "payor_account_number",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "m_name_first",
											"type": "String"
										},
										"sink": {
											"name": "m_name_first",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "m_name_last",
											"type": "String"
										},
										"sink": {
											"name": "m_name_last",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "bae_transaction_type",
											"type": "String"
										},
										"sink": {
											"name": "bae_transaction_type",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "bae_type",
											"type": "String"
										},
										"sink": {
											"name": "bae_type",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "bae_amount",
											"type": "Decimal"
										},
										"sink": {
											"name": "bae_amount",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "pame_subtype",
											"type": "String"
										},
										"sink": {
											"name": "pame_subtype",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "pame_brand",
											"type": "String"
										},
										"sink": {
											"name": "pame_brand",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "cb_number",
											"type": "String"
										},
										"sink": {
											"name": "cb_number",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "pay_status",
											"type": "String"
										},
										"sink": {
											"name": "pay_status",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "cb_transaction_date",
											"type": "DateTime"
										},
										"sink": {
											"name": "cb_transaction_date",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "pay_number",
											"type": "String"
										},
										"sink": {
											"name": "pay_number",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "transaction_modified_date",
											"type": "DateTime"
										},
										"sink": {
											"name": "transaction_modified_date",
											"type": "DateTime"
										}
									}
								]
							}
						},
						"inputs": [
							{
								"referenceName": "AzureSynapseAnalyticsDB",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "SNK_SYN_ACCOUNTING_BUNDLED_CHARGEBACK_INCR",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"windowStart": {
						"type": "string"
					},
					"windowEnd": {
						"type": "string"
					}
				},
				"folder": {
					"name": "RCM_SQLPOOL"
				},
				"annotations": [],
				"lastPublishTime": "2021-11-12T10:18:39Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/ACCOUNTING_BUNDLED_PAYMENT_SQLPOOL')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Merge to Staging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "ACCOUNTING_BUNDLED_PAYMENT",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Accounting].[Bundled_Payment_Merge]"
						},
						"linkedServiceName": {
							"referenceName": "AzureSynapseAnalytics1",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Truncate Incr table",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "truncate table ACCOUNTING.BUNDLED_PAYMENT_INCR;\nselect 0;",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "AzureSynapseAnalyticsDB",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": false
						}
					},
					{
						"name": "ACCOUNTING_BUNDLED_PAYMENT",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Truncate Incr table",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": {
									"value": "\nselect t.id\n\t,t.tran_unique_transaction_number\n    ,CONCAT(t.transaction_type,'.',t.transaction_payment_action,'.',t.payment_method) 'transaction_key'\n\t,t.loc_name 'loc_name'\n    ,t.loc_number 'loc_number'\n    ,t.member_number\n\t,t.transaction_type 'transaction_type'\n\t,t.transaction_payment_action AS 'transaction_action'\n\t,t.transaction_status\n\t,t.posting_date\n    ,t.bae_posting_date\n    ,t.cae_posting_date\n    ,t.stlm_posting_date 'client_settlement_date'\n\t,t.transaction_amount 'transaction_amount'\n    ,t.payment_method\n    ,t.payment_method_type\n\t,t.transaction_modified_date\nFROM (\nselect abup.bpay_id as id\n\t,abup.tran_unique_transaction_number\n\t,abup.bpay_effective_date 'posting_date'\n    ,acae.cae_posting_date 'cae_posting_date'\n    ,NULL AS 'bae_posting_date'\n    ,ol.loc_number 'loc_number'\n\t,ol.loc_name 'loc_name'\n    ,om.m_number 'member_number'\n    ,acae.cae_transaction_type 'transaction_type'\n    ,acae.cae_type 'transaction_payment_action'\n    ,acae.cae_amount 'transaction_amount'\n    ,abup.bpay_status 'transaction_status'\n\t,abup.bpay_number 'transaction_number'\n    ,apm.pame_type 'payment_method'\n    ,CASE apm.pame_type\n\t\tWHEN 'CHECKING' THEN 'BANK'\n        WHEN 'SAVINGS' THEN 'BANK'\n        WHEN 'VISA' THEN 'CREDIT_CARD'\n        WHEN 'MASTERCARD' THEN 'CREDIT_CARD'\n        WHEN 'AMEX' THEN 'CREDIT_CARD'\n        WHEN 'DISCOVER' THEN 'CREDIT_CARD'\n        ELSE 'OTHER'\n    END AS 'payment_method_type'\n    ,aset.stlm_posting_date\n\t,abup.bpay_modified as transaction_modified_date\nFROM StgRCM.abcbilling_client_account_entry acae\nINNER JOIN stgRCM.abcbilling_client_account aca on acae.client_id = aca.client_id\nINNER JOIN stgRCM.organization_location ol on aca.loc_id = ol.loc_id\nINNER JOIN stgRCM.abcbilling_bundled_payment abup on acae.cae_transaction_id = abup.bpay_id\nLEFT JOIN stgRCM.abcbilling_settlement aset on acae.stlm_id = aset.stlm_id\nLEFT JOIN stgRCM.abcbilling_payment_method apm on abup.tok_id = apm.tok_id\nLEFT JOIN stgRCM.abcbilling_payor_profile app on apm.payor_id = app.payor_id\nLEFT JOIN stgRCM.organization_member om on app.m_id = om.m_id\n) AS t\nWHERE t.transaction_modified_date  >= CONVERT(datetime,'@{formatDateTime(pipeline().parameters.windowStart, 'yyyy-MM-dd HH:mm' )}')\n\tAND t.transaction_modified_date   < CONVERT(datetime,'@{formatDateTime(pipeline().parameters.windowEnd, 'yyyy-MM-dd HH:mm' )}')\nORDER BY t.posting_date,t.loc_number,t.transaction_type,t.transaction_payment_action,t.payment_method_type;",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "SqlDWSink",
								"allowPolyBase": true,
								"polyBaseSettings": {
									"rejectValue": 0,
									"rejectType": "value",
									"useTypeDefault": false
								}
							},
							"enableStaging": true,
							"stagingSettings": {
								"linkedServiceName": {
									"referenceName": "AzureBlobStorage1",
									"type": "LinkedServiceReference"
								},
								"path": "vifiles"
							},
							"parallelCopies": 32,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "id",
											"type": "String"
										},
										"sink": {
											"name": "id",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "tran_unique_transaction_number",
											"type": "String"
										},
										"sink": {
											"name": "tran_unique_transaction_number",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "loc_name",
											"type": "String"
										},
										"sink": {
											"name": "loc_name",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "loc_number",
											"type": "String"
										},
										"sink": {
											"name": "loc_number",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "member_number",
											"type": "String"
										},
										"sink": {
											"name": "member_number",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "transaction_type",
											"type": "String"
										},
										"sink": {
											"name": "transaction_type",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "transaction_action",
											"type": "String"
										},
										"sink": {
											"name": "transaction_action",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "transaction_status",
											"type": "String"
										},
										"sink": {
											"name": "transaction_status",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "posting_date",
											"type": "DateTime"
										},
										"sink": {
											"name": "posting_date",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "bae_posting_date",
											"type": "Int32"
										},
										"sink": {
											"name": "bae_posting_date",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "cae_posting_date",
											"type": "DateTime"
										},
										"sink": {
											"name": "cae_posting_date",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "client_settlement_date",
											"type": "DateTime"
										},
										"sink": {
											"name": "client_settlement_date",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "transaction_amount",
											"type": "Decimal"
										},
										"sink": {
											"name": "transaction_amount",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "payment_method",
											"type": "String"
										},
										"sink": {
											"name": "payment_method",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "payment_method_type",
											"type": "String"
										},
										"sink": {
											"name": "payment_method_type",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "transaction_key",
											"type": "String"
										},
										"sink": {
											"name": "transaction_key",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "transaction_modified_date",
											"type": "DateTime"
										},
										"sink": {
											"name": "transaction_modified_date",
											"type": "DateTime"
										}
									}
								]
							}
						},
						"inputs": [
							{
								"referenceName": "AzureSynapseAnalyticsDB",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "SNK_SYN_ACCOUNTING_BUNDLED_PAYMENT_INCR",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"windowStart": {
						"type": "string"
					},
					"windowEnd": {
						"type": "string"
					}
				},
				"folder": {
					"name": "RCM_SQLPOOL"
				},
				"annotations": [],
				"lastPublishTime": "2023-02-27T13:42:46Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/ACCOUNTING_CLIENT_SCHEDULED_FEE_SQLPOOL')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Merge to Staging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "ACCOUNTING_CLIENT_SCHEDULED_FEE",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Accounting].[Client_Scheduled_Fee_Merge]"
						},
						"linkedServiceName": {
							"referenceName": "AzureSynapseAnalytics1",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Truncate Incr table",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "truncate table ACCOUNTING.CLIENT_SCHEDULED_FEE_INCR;\nselect 0;",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "AzureSynapseAnalyticsDB",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": false
						}
					},
					{
						"name": "ACCOUNTING_CLIENT_SCHEDULED_FEE",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Truncate Incr table",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": {
									"value": "SELECT asf.sf_id as id\n, aset.stlm_posting_date 'settlement_date'\n, asf.sf_assessment_date 'fee_posting_date'\n, acae.cae_posting_date 'cae_posting_date'\n, convert(date,asf.sf_created) 'fee_created'\n, aset.stlm_number 'settlement_number'\n, acp.cp_name 'client_name'\n,\tol.loc_number\n, acae.cae_type 'cae_type'\n, acae.cae_transaction_type\n, asfc.sfc_type 'fee_type'\n, aset.stlm_status 'fee_status'\n, arc.rc_code 'fee_reason_code'\n, arc.rc_description 'fee_reason_desc'\n, acae.cae_amount 'cae_amount'\n, asf.sf_amount 'fee_amount'\n, asf.sf_number 'fee_number'\n, arc.rc_general_ledger_account 'gl_account'\n, arc.rc_general_ledger_department 'gl_dept'\n, CONCAT(acae.cae_transaction_type,'.',asfc.sfc_type,'.',arc.rc_code) 'transaction_key'\n, asf.sf_modified AS 'transaction_modified_date'\nfrom stgrcm.abcbilling_client_profile acp\ninner join stgrcm.organization_location ol on acp.loc_id = ol.loc_id\ninner join stgrcm.abcbilling_client_account_entry acae on acp.client_id = acae.client_id\ninner join stgrcm.abcbilling_scheduled_fee asf on acae.cae_transaction_id = asf.sf_id\ninner join stgrcm.abcbilling_scheduled_fee_config asfc on asf.sfc_id = asfc.sfc_id\ninner join stgrcm.abcbilling_reason_code arc on asfc.rc_id = arc.rc_id\nLEFT join stgrcm.abcbilling_settlement aset on acae.stlm_id = aset.stlm_id\nWHERE asf.sf_modified >= CONVERT(datetime,'@{formatDateTime(pipeline().parameters.windowStart, 'yyyy-MM-dd HH:mm' )}')\nAND asf.sf_modified < CONVERT(datetime,'@{formatDateTime(pipeline().parameters.windowEnd, 'yyyy-MM-dd HH:mm' )}')\nORDER BY aset.stlm_posting_date,acp.cp_name,asf.sf_assessment_date,acae.cae_type;",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "SqlDWSink",
								"allowPolyBase": true,
								"polyBaseSettings": {
									"rejectValue": 0,
									"rejectType": "value",
									"useTypeDefault": false
								}
							},
							"enableStaging": true,
							"stagingSettings": {
								"linkedServiceName": {
									"referenceName": "AzureBlobStorage1",
									"type": "LinkedServiceReference"
								},
								"path": "vifiles"
							},
							"parallelCopies": 32,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "id",
											"type": "String"
										},
										"sink": {
											"name": "id",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "settlement_date",
											"type": "DateTime"
										},
										"sink": {
											"name": "settlement_date",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "fee_posting_date",
											"type": "DateTime"
										},
										"sink": {
											"name": "fee_posting_date",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "cae_posting_date",
											"type": "DateTime"
										},
										"sink": {
											"name": "cae_posting_date",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "fee_created",
											"type": "DateTime"
										},
										"sink": {
											"name": "fee_created",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "settlement_number",
											"type": "String"
										},
										"sink": {
											"name": "settlement_number",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "client_name",
											"type": "String"
										},
										"sink": {
											"name": "client_name",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "loc_number",
											"type": "String"
										},
										"sink": {
											"name": "loc_number",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "cae_type",
											"type": "String"
										},
										"sink": {
											"name": "cae_type",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "cae_transaction_type",
											"type": "String"
										},
										"sink": {
											"name": "cae_transaction_type",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "fee_type",
											"type": "String"
										},
										"sink": {
											"name": "fee_type",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "fee_status",
											"type": "String"
										},
										"sink": {
											"name": "fee_status",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "fee_reason_code",
											"type": "String"
										},
										"sink": {
											"name": "fee_reason_code",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "fee_reason_desc",
											"type": "String"
										},
										"sink": {
											"name": "fee_reason_desc",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "cae_amount",
											"type": "Decimal"
										},
										"sink": {
											"name": "cae_amount",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "fee_amount",
											"type": "Decimal"
										},
										"sink": {
											"name": "fee_amount",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "fee_number",
											"type": "String"
										},
										"sink": {
											"name": "fee_number",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "gl_account",
											"type": "String"
										},
										"sink": {
											"name": "gl_account",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "gl_dept",
											"type": "String"
										},
										"sink": {
											"name": "gl_dept",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "transaction_key",
											"type": "String"
										},
										"sink": {
											"name": "transaction_key",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "transaction_modified_date",
											"type": "DateTime"
										},
										"sink": {
											"name": "transaction_modified_date",
											"type": "DateTime"
										}
									}
								]
							}
						},
						"inputs": [
							{
								"referenceName": "AzureSynapseAnalyticsDB",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "SNK_SYN_ACCOUNTING_CLIENT_SCHEDULED_FEE_INCR",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"windowStart": {
						"type": "string"
					},
					"windowEnd": {
						"type": "string"
					}
				},
				"folder": {
					"name": "RCM_SQLPOOL"
				},
				"annotations": [],
				"lastPublishTime": "2023-02-23T18:06:09Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/ACCOUNTING_CLIENT_TRANSACTION_FEE_SQLPOOL')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Merge to Staging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "ACCOUNTING_CLIENT_TRANSACTION_FEE",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Accounting].[Client_Transaction_Fee_Merge]"
						},
						"linkedServiceName": {
							"referenceName": "AzureSynapseAnalytics1",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Truncate Incr table",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "truncate table ACCOUNTING.CLIENT_TRANSACTION_FEE_INCR;\nselect 0;",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "AzureSynapseAnalyticsDB",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": false
						}
					},
					{
						"name": "ACCOUNTING_CLIENT_TRANSACTION_FEE",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Truncate Incr table",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": {
									"value": "select  distinct\n\t\tactf.ctf_id as id\n\t\t,aset.stlm_posting_date 'settlement_date'\n\t\t, CAST(actf.ctf_assessment_date as date) 'fee_posting_date'\n        , acae.cae_posting_date\n\t\t, cast(actf.ctf_created as date) 'fee_created'\n        , aset.stlm_number 'settlement_number'\n\t\t, acp.cp_name 'client_name'\n        , ol.loc_number\n\t\t, acae.cae_type 'cae_type'\n\t\t, acae.cae_transaction_type \n\t\t, actfc.ctfc_type 'fee_type'\n        , aset.stlm_status 'fee_status'\n\t\t, acae.cae_amount 'cae_amount'\n\t\t, actf.ctf_amount 'fee_amount'\n\t\t, actf.ctf_number 'fee_number'\n        , CONCAT(acae.cae_transaction_type,'.',actfc.ctfc_type) 'transaction_key'\n\t\t,ctf_modified as transaction_modified_date\n\t\tfrom stgrcm.abcbilling_client_profile acp \n\t\tinner join stgrcm.organization_location ol on acp.loc_id = ol.loc_id\n\t\tinner join stgrcm.abcbilling_client_account_entry acae on acp.client_id = acae.client_id\n        inner join stgrcm.abcbilling_payment_method apm on acp.client_id = apm.client_id\n\t\tinner join stgrcm.abcbilling_client_transaction_fee actf on acae.cae_transaction_id = actf.ctf_id\n\t\tinner join stgrcm.abcbilling_client_transaction_fee_config actfc on actf.ctfc_id = actfc.ctfc_id\n        LEFT join stgrcm.abcbilling_settlement aset on acae.stlm_id = aset.stlm_id\nWHERE actf.ctf_modified >= CONVERT(datetime,'@{formatDateTime(pipeline().parameters.windowStart, 'yyyy-MM-dd HH:mm' )}')\nAND actf.ctf_modified < CONVERT(datetime,'@{formatDateTime(pipeline().parameters.windowEnd, 'yyyy-MM-dd HH:mm' )}')\nORDER BY aset.stlm_posting_date,acp.cp_name, CAST(actf.ctf_assessment_date as date),acae.cae_type;;",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "SqlDWSink",
								"allowPolyBase": true,
								"polyBaseSettings": {
									"rejectValue": 0,
									"rejectType": "value",
									"useTypeDefault": false
								}
							},
							"enableStaging": true,
							"stagingSettings": {
								"linkedServiceName": {
									"referenceName": "AzureBlobStorage1",
									"type": "LinkedServiceReference"
								},
								"path": "vifiles"
							},
							"parallelCopies": 32,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "id",
											"type": "String"
										},
										"sink": {
											"name": "id",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "settlement_date",
											"type": "DateTime"
										},
										"sink": {
											"name": "settlement_date",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "fee_posting_date",
											"type": "DateTime"
										},
										"sink": {
											"name": "fee_posting_date",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "cae_posting_date",
											"type": "DateTime"
										},
										"sink": {
											"name": "cae_posting_date",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "fee_created",
											"type": "DateTime"
										},
										"sink": {
											"name": "fee_created",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "settlement_number",
											"type": "String"
										},
										"sink": {
											"name": "settlement_number",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "client_name",
											"type": "String"
										},
										"sink": {
											"name": "client_name",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "loc_number",
											"type": "String"
										},
										"sink": {
											"name": "loc_number",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "cae_type",
											"type": "String"
										},
										"sink": {
											"name": "cae_type",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "cae_transaction_type",
											"type": "String"
										},
										"sink": {
											"name": "cae_transaction_type",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "fee_type",
											"type": "String"
										},
										"sink": {
											"name": "fee_type",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "fee_status",
											"type": "String"
										},
										"sink": {
											"name": "fee_status",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "cae_amount",
											"type": "Decimal"
										},
										"sink": {
											"name": "cae_amount",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "fee_amount",
											"type": "Decimal"
										},
										"sink": {
											"name": "fee_amount",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "fee_number",
											"type": "String"
										},
										"sink": {
											"name": "fee_number",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "transaction_key",
											"type": "String"
										},
										"sink": {
											"name": "transaction_key",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "transaction_modified_date",
											"type": "DateTime"
										},
										"sink": {
											"name": "transaction_modified_date",
											"type": "DateTime"
										}
									}
								]
							}
						},
						"inputs": [
							{
								"referenceName": "AzureSynapseAnalyticsDB",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "SNK_SYN_ACCOUNTING_CLIENT_TRANSACTION_FEE_INCR",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"windowStart": {
						"type": "string"
					},
					"windowEnd": {
						"type": "string"
					}
				},
				"folder": {
					"name": "RCM_SQLPOOL"
				},
				"annotations": [],
				"lastPublishTime": "2023-02-22T14:15:10Z"
			},
			"dependsOn": []
		}
	]
}