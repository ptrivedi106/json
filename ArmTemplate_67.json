{
	"$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
	"contentVersion": "1.0.0.0",
	"parameters": {
		"factoryName": {
			"type": "string",
			"metadata": "Data Factory name",
			"defaultValue": "PlanetFitnessDF"
		}
	},
	"variables": {
		"factoryId": "[concat('Microsoft.DataFactory/factories/', parameters('factoryName'))]"
	},
	"resources": [
		{
			"name": "[concat(parameters('factoryName'), '/PF_EFT_ALLOC_TAX_AF_VW')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Copy data1",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Truncate table Sink",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "OracleSource",
								"oracleReaderQuery": "SELECT *\nFROM PF.EFT_ALLOC_TAX_AF_VW",
								"partitionOption": "None",
								"queryTimeout": "02:00:00"
							},
							"sink": {
								"type": "SqlDWSink",
								"maxConcurrentConnections": 6,
								"allowPolyBase": true,
								"polyBaseSettings": {
									"rejectValue": 0,
									"rejectType": "value",
									"useTypeDefault": true
								},
								"disableMetricsCollection": false
							},
							"enableStaging": true,
							"stagingSettings": {
								"linkedServiceName": {
									"referenceName": "AzureBlobStorage1",
									"type": "LinkedServiceReference"
								},
								"path": "pfviewsoracle",
								"enableCompression": true
							},
							"parallelCopies": 8,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "CLUB_NUMBER_AND_NAME",
											"type": "String"
										},
										"sink": {
											"name": "CLUB_NUMBER_AND_NAME",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "IT_GROSS_INVOICES_ACH#T",
											"type": "Double"
										},
										"sink": {
											"name": "IT_GROSS_INVOICES_ACH#T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "IT_GROSS_INVOICES_ACH$A",
											"type": "Double"
										},
										"sink": {
											"name": "IT_GROSS_INVOICES_ACH$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "IT_GROSS_INVOICES_CCD#T",
											"type": "Double"
										},
										"sink": {
											"name": "IT_GROSS_INVOICES_CCD#T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "IT_GROSS_INVOICES_CCD$A",
											"type": "Double"
										},
										"sink": {
											"name": "IT_GROSS_INVOICES_CCD$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "IT_GROSS_INVOICES_STM#T",
											"type": "Double"
										},
										"sink": {
											"name": "IT_GROSS_INVOICES_STM#T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "IT_GROSS_INVOICES_STM$A",
											"type": "Double"
										},
										"sink": {
											"name": "IT_GROSS_INVOICES_STM$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "IT_GROSS_INVOICES_AMZ#T",
											"type": "Double"
										},
										"sink": {
											"name": "IT_GROSS_INVOICES_AMZ#T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "IT_GROSS_INVOICES_AMZ$A",
											"type": "Double"
										},
										"sink": {
											"name": "IT_GROSS_INVOICES_AMZ$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "IT_GROSS_INVOICES_APL#T",
											"type": "Double"
										},
										"sink": {
											"name": "IT_GROSS_INVOICES_APL#T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "IT_GROSS_INVOICES_APL$A",
											"type": "Double"
										},
										"sink": {
											"name": "IT_GROSS_INVOICES_APL$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "IT_GROSS_INVOICES_DGP#T",
											"type": "Double"
										},
										"sink": {
											"name": "IT_GROSS_INVOICES_DGP#T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "IT_GROSS_INVOICES_DGP$A",
											"type": "Double"
										},
										"sink": {
											"name": "IT_GROSS_INVOICES_DGP$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "IT_GROSS_INVOICES_PRB#T",
											"type": "Double"
										},
										"sink": {
											"name": "IT_GROSS_INVOICES_PRB#T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "IT_GROSS_INVOICES_PRB$A",
											"type": "Double"
										},
										"sink": {
											"name": "IT_GROSS_INVOICES_PRB$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "IT_GROSS_INVOICES_TOT#T",
											"type": "Double"
										},
										"sink": {
											"name": "IT_GROSS_INVOICES_TOT#T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "IT_GROSS_INVOICES_TOT$A",
											"type": "Double"
										},
										"sink": {
											"name": "IT_GROSS_INVOICES_TOT$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "IT_TOTAL_COLLECTED_ACH#T",
											"type": "Double"
										},
										"sink": {
											"name": "IT_TOTAL_COLLECTED_ACH#T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "IT_TOTAL_COLLECTED_ACH$A",
											"type": "Double"
										},
										"sink": {
											"name": "IT_TOTAL_COLLECTED_ACH$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "IT_TOTAL_COLLECTED_CCD#T",
											"type": "Double"
										},
										"sink": {
											"name": "IT_TOTAL_COLLECTED_CCD#T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "IT_TOTAL_COLLECTED_CCD$A",
											"type": "Double"
										},
										"sink": {
											"name": "IT_TOTAL_COLLECTED_CCD$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "IT_TOTAL_COLLECTED_STM#T",
											"type": "Double"
										},
										"sink": {
											"name": "IT_TOTAL_COLLECTED_STM#T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "IT_TOTAL_COLLECTED_STM$A",
											"type": "Double"
										},
										"sink": {
											"name": "IT_TOTAL_COLLECTED_STM$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "IT_TOTAL_COLLECTED_AMZ#T",
											"type": "Double"
										},
										"sink": {
											"name": "IT_TOTAL_COLLECTED_AMZ#T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "IT_TOTAL_COLLECTED_AMZ$A",
											"type": "Double"
										},
										"sink": {
											"name": "IT_TOTAL_COLLECTED_AMZ$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "IT_TOTAL_COLLECTED_APL#T",
											"type": "Double"
										},
										"sink": {
											"name": "IT_TOTAL_COLLECTED_APL#T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "IT_TOTAL_COLLECTED_APL$A",
											"type": "Double"
										},
										"sink": {
											"name": "IT_TOTAL_COLLECTED_APL$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "IT_TOTAL_COLLECTED_DGP#T",
											"type": "Double"
										},
										"sink": {
											"name": "IT_TOTAL_COLLECTED_DGP#T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "IT_TOTAL_COLLECTED_DGP$A",
											"type": "Double"
										},
										"sink": {
											"name": "IT_TOTAL_COLLECTED_DGP$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "IT_TOTAL_COLLECTED_PRB#T",
											"type": "Double"
										},
										"sink": {
											"name": "IT_TOTAL_COLLECTED_PRB#T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "IT_TOTAL_COLLECTED_PRB$A",
											"type": "Double"
										},
										"sink": {
											"name": "IT_TOTAL_COLLECTED_PRB$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "IT_TOTAL_COLLECTED_TOT#T",
											"type": "Double"
										},
										"sink": {
											"name": "IT_TOTAL_COLLECTED_TOT#T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "IT_TOTAL_COLLECTED_TOT$A",
											"type": "Double"
										},
										"sink": {
											"name": "IT_TOTAL_COLLECTED_TOT$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "PT_GROSS_INVOICES_ACH$T",
											"type": "Double"
										},
										"sink": {
											"name": "PT_GROSS_INVOICES_ACH$T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "PT_GROSS_INVOICES_ACH$A",
											"type": "Double"
										},
										"sink": {
											"name": "PT_GROSS_INVOICES_ACH$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "PT_GROSS_INVOICES_CCD$T",
											"type": "Double"
										},
										"sink": {
											"name": "PT_GROSS_INVOICES_CCD$T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "PT_GROSS_INVOICES_CCD$A",
											"type": "Double"
										},
										"sink": {
											"name": "PT_GROSS_INVOICES_CCD$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "PT_GROSS_INVOICES_STM$T",
											"type": "Double"
										},
										"sink": {
											"name": "PT_GROSS_INVOICES_STM$T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "PT_GROSS_INVOICES_STM$A",
											"type": "Double"
										},
										"sink": {
											"name": "PT_GROSS_INVOICES_STM$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "PT_GROSS_INVOICES_AMZ$T",
											"type": "Double"
										},
										"sink": {
											"name": "PT_GROSS_INVOICES_AMZ$T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "PT_GROSS_INVOICES_AMZ$A",
											"type": "Double"
										},
										"sink": {
											"name": "PT_GROSS_INVOICES_AMZ$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "PT_GROSS_INVOICES_APL$T",
											"type": "Double"
										},
										"sink": {
											"name": "PT_GROSS_INVOICES_APL$T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "PT_GROSS_INVOICES_APL$A",
											"type": "Double"
										},
										"sink": {
											"name": "PT_GROSS_INVOICES_APL$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "PT_GROSS_INVOICES_DGP$T",
											"type": "Double"
										},
										"sink": {
											"name": "PT_GROSS_INVOICES_DGP$T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "PT_GROSS_INVOICES_DGP$A",
											"type": "Double"
										},
										"sink": {
											"name": "PT_GROSS_INVOICES_DGP$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "PT_GROSS_INVOICES_PRB$T",
											"type": "Double"
										},
										"sink": {
											"name": "PT_GROSS_INVOICES_PRB$T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "PT_GROSS_INVOICES_PRB$A",
											"type": "Double"
										},
										"sink": {
											"name": "PT_GROSS_INVOICES_PRB$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "PT_GROSS_INVOICES_TOT$T",
											"type": "Double"
										},
										"sink": {
											"name": "PT_GROSS_INVOICES_TOT$T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "PT_GROSS_INVOICES_TOT$A",
											"type": "Double"
										},
										"sink": {
											"name": "PT_GROSS_INVOICES_TOT$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "PT_TAX_ACH$T",
											"type": "Double"
										},
										"sink": {
											"name": "PT_TAX_ACH$T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "PT_TOTAL_COLLECTED_ACH$A",
											"type": "Double"
										},
										"sink": {
											"name": "PT_TOTAL_COLLECTED_ACH$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "PT_TAX_CCD$T",
											"type": "Double"
										},
										"sink": {
											"name": "PT_TAX_CCD$T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "PT_TOTAL_COLLECTED_CCD$A",
											"type": "Double"
										},
										"sink": {
											"name": "PT_TOTAL_COLLECTED_CCD$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "PT_TAX_STM$T",
											"type": "Double"
										},
										"sink": {
											"name": "PT_TAX_STM$T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "PT_TOTAL_COLLECTED_STM$A",
											"type": "Double"
										},
										"sink": {
											"name": "PT_TOTAL_COLLECTED_STM$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "PT_TAX_AMZ$T",
											"type": "Double"
										},
										"sink": {
											"name": "PT_TAX_AMZ$T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "PT_TOTAL_COLLECTED_AMZ$A",
											"type": "Double"
										},
										"sink": {
											"name": "PT_TOTAL_COLLECTED_AMZ$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "PT_TAX_APL$T",
											"type": "Double"
										},
										"sink": {
											"name": "PT_TAX_APL$T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "PT_TOTAL_COLLECTED_APL$A",
											"type": "Double"
										},
										"sink": {
											"name": "PT_TOTAL_COLLECTED_APL$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "PT_TAX_DGP$T",
											"type": "Double"
										},
										"sink": {
											"name": "PT_TAX_DGP$T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "PT_TOTAL_COLLECTED_DGP$A",
											"type": "Double"
										},
										"sink": {
											"name": "PT_TOTAL_COLLECTED_DGP$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "PT_TAX_PRB$T",
											"type": "Double"
										},
										"sink": {
											"name": "PT_TAX_PRB$T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "PT_TOTAL_COLLECTED_PRB$A",
											"type": "Double"
										},
										"sink": {
											"name": "PT_TOTAL_COLLECTED_PRB$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "PT_TAX_TOT$T",
											"type": "Double"
										},
										"sink": {
											"name": "PT_TAX_TOT$T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "PT_TOTAL_COLLECTED_TOT$A",
											"type": "Double"
										},
										"sink": {
											"name": "PT_TOTAL_COLLECTED_TOT$A",
											"type": "Single"
										}
									}
								]
							}
						},
						"inputs": [
							{
								"referenceName": "SRC_PF_EFT_ALLOC_TAX_AF_VW",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "SNK_SYN_PF_EFT_ALLOC_TAX_AF",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Truncate table Sink",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Check Did Job Success",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "TRUNCATE TABLE [PF].[EFT_ALLOC_TAX_AF];\nselect 1;",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "SNK_SYN_PF_EFT_ALLOC_TAX_AF",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": true
						}
					},
					{
						"name": "Get Job Status",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "select 1\nfrom [dbo].[PF_VIEWS_JOBS_CHECK] \nwhere finish_time = cast(GETDATE() AT TIME ZONE 'UTC' AT TIME ZONE 'Eastern Standard Time' AS DATE) \nand FBI_JOB_NAME= 'PF.EFT_ALLOCATIONS_PR' and job_completed=1",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "SNK_DBO_PF_VIEWS_JOBS_CHECK",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "check Oracle Job",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Get Job Status",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "OracleSource",
								"oracleReaderQuery": "select JOB_NAME,START_TIME,FINISH_TIME,STATUS, 'PF.EFT_ALLOCATIONS_PR' as FBI_JOB_NAME \r\nfrom dw.job_monitoring_vw \r\nwhere job_name = 'PF.EFT_ALLOCATIONS_PR' and status = 'SUCCESS' and to_date(finish_time,'YYYY/MM/DD HH24:MI:SS') > trunc(sysdate)",
								"partitionOption": "None",
								"queryTimeout": "02:00:00"
							},
							"dataset": {
								"referenceName": "OracleTable1",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Check Did Job Success",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "check Oracle Job",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "select count(*) from pf_views_jobs_check \nwhere job_name = 'PF.EFT_ALLOCATIONS_PR' and \n    status = 'SUCCESS' and cast(finish_time as date)=cast(GETDATE() AT TIME ZONE 'UTC' AT TIME ZONE 'Eastern Standard Time' AS DATE)\n    and FBI_JOB_NAME='PF.EFT_ALLOCATIONS_PR'",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "SNK_DBO_PF_VIEWS_JOBS_CHECK",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Update Job Status",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Copy data1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "UPDATE [PF].[EFT_ALLOC_TAX_AF]\nSET AS_OF = GETDATE();\nSELECT 1\n",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "SNK_DBO_PF_VIEWS_JOBS_CHECK",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"folder": {
					"name": "EDW_PF_SQL_POOL"
				},
				"annotations": [],
				"lastPublishTime": "2023-02-23T16:21:18Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/PF_EFT_ALLOC_TAX_DS_VW')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Copy data1",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Truncate table Sink",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "OracleSource",
								"oracleReaderQuery": "SELECT *\nFROM PF.EFT_ALLOC_TAX_DS_VW",
								"partitionOption": "None",
								"queryTimeout": "02:00:00"
							},
							"sink": {
								"type": "SqlDWSink",
								"maxConcurrentConnections": 6,
								"allowPolyBase": true,
								"polyBaseSettings": {
									"rejectValue": 0,
									"rejectType": "value",
									"useTypeDefault": true
								},
								"disableMetricsCollection": false
							},
							"enableStaging": true,
							"stagingSettings": {
								"linkedServiceName": {
									"referenceName": "AzureBlobStorage1",
									"type": "LinkedServiceReference"
								},
								"path": "pfviewsoracle",
								"enableCompression": true
							},
							"parallelCopies": 8,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "CLUB_NUMBER_AND_NAME",
											"type": "String"
										},
										"sink": {
											"name": "CLUB_NUMBER_AND_NAME",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "IT_GROSS_INVOICES_ACH#T",
											"type": "Double"
										},
										"sink": {
											"name": "IT_GROSS_INVOICES_ACH#T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "IT_GROSS_INVOICES_ACH$A",
											"type": "Double"
										},
										"sink": {
											"name": "IT_GROSS_INVOICES_ACH$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "IT_GROSS_INVOICES_CCD#T",
											"type": "Double"
										},
										"sink": {
											"name": "IT_GROSS_INVOICES_CCD#T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "IT_GROSS_INVOICES_CCD$A",
											"type": "Double"
										},
										"sink": {
											"name": "IT_GROSS_INVOICES_CCD$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "IT_GROSS_INVOICES_STM#T",
											"type": "Double"
										},
										"sink": {
											"name": "IT_GROSS_INVOICES_STM#T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "IT_GROSS_INVOICES_STM$A",
											"type": "Double"
										},
										"sink": {
											"name": "IT_GROSS_INVOICES_STM$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "IT_GROSS_INVOICES_AMZ#T",
											"type": "Double"
										},
										"sink": {
											"name": "IT_GROSS_INVOICES_AMZ#T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "IT_GROSS_INVOICES_AMZ$A",
											"type": "Double"
										},
										"sink": {
											"name": "IT_GROSS_INVOICES_AMZ$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "IT_GROSS_INVOICES_APL#T",
											"type": "Double"
										},
										"sink": {
											"name": "IT_GROSS_INVOICES_APL#T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "IT_GROSS_INVOICES_APL$A",
											"type": "Double"
										},
										"sink": {
											"name": "IT_GROSS_INVOICES_APL$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "IT_GROSS_INVOICES_DGP#T",
											"type": "Double"
										},
										"sink": {
											"name": "IT_GROSS_INVOICES_DGP#T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "IT_GROSS_INVOICES_DGP$A",
											"type": "Double"
										},
										"sink": {
											"name": "IT_GROSS_INVOICES_DGP$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "IT_GROSS_INVOICES_PRB#T",
											"type": "Double"
										},
										"sink": {
											"name": "IT_GROSS_INVOICES_PRB#T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "IT_GROSS_INVOICES_PRB$A",
											"type": "Double"
										},
										"sink": {
											"name": "IT_GROSS_INVOICES_PRB$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "IT_GROSS_INVOICES_TOT#T",
											"type": "Double"
										},
										"sink": {
											"name": "IT_GROSS_INVOICES_TOT#T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "IT_GROSS_INVOICES_TOT$A",
											"type": "Double"
										},
										"sink": {
											"name": "IT_GROSS_INVOICES_TOT$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "IT_TOTAL_COLLECTED_ACH#T",
											"type": "Double"
										},
										"sink": {
											"name": "IT_TOTAL_COLLECTED_ACH#T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "IT_TOTAL_COLLECTED_ACH$A",
											"type": "Double"
										},
										"sink": {
											"name": "IT_TOTAL_COLLECTED_ACH$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "IT_TOTAL_COLLECTED_CCD#T",
											"type": "Double"
										},
										"sink": {
											"name": "IT_TOTAL_COLLECTED_CCD#T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "IT_TOTAL_COLLECTED_CCD$A",
											"type": "Double"
										},
										"sink": {
											"name": "IT_TOTAL_COLLECTED_CCD$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "IT_TOTAL_COLLECTED_STM#T",
											"type": "Double"
										},
										"sink": {
											"name": "IT_TOTAL_COLLECTED_STM#T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "IT_TOTAL_COLLECTED_STM$A",
											"type": "Double"
										},
										"sink": {
											"name": "IT_TOTAL_COLLECTED_STM$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "IT_TOTAL_COLLECTED_AMZ#T",
											"type": "Double"
										},
										"sink": {
											"name": "IT_TOTAL_COLLECTED_AMZ#T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "IT_TOTAL_COLLECTED_AMZ$A",
											"type": "Double"
										},
										"sink": {
											"name": "IT_TOTAL_COLLECTED_AMZ$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "IT_TOTAL_COLLECTED_APL#T",
											"type": "Double"
										},
										"sink": {
											"name": "IT_TOTAL_COLLECTED_APL#T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "IT_TOTAL_COLLECTED_APL$A",
											"type": "Double"
										},
										"sink": {
											"name": "IT_TOTAL_COLLECTED_APL$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "IT_TOTAL_COLLECTED_DGP#T",
											"type": "Double"
										},
										"sink": {
											"name": "IT_TOTAL_COLLECTED_DGP#T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "IT_TOTAL_COLLECTED_DGP$A",
											"type": "Double"
										},
										"sink": {
											"name": "IT_TOTAL_COLLECTED_DGP$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "IT_TOTAL_COLLECTED_PRB#T",
											"type": "Double"
										},
										"sink": {
											"name": "IT_TOTAL_COLLECTED_PRB#T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "IT_TOTAL_COLLECTED_PRB$A",
											"type": "Double"
										},
										"sink": {
											"name": "IT_TOTAL_COLLECTED_PRB$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "IT_TOTAL_COLLECTED_TOT#T",
											"type": "Double"
										},
										"sink": {
											"name": "IT_TOTAL_COLLECTED_TOT#T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "IT_TOTAL_COLLECTED_TOT$A",
											"type": "Double"
										},
										"sink": {
											"name": "IT_TOTAL_COLLECTED_TOT$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "PT_GROSS_INVOICES_ACH$T",
											"type": "Double"
										},
										"sink": {
											"name": "PT_GROSS_INVOICES_ACH$T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "PT_GROSS_INVOICES_ACH$A",
											"type": "Double"
										},
										"sink": {
											"name": "PT_GROSS_INVOICES_ACH$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "PT_GROSS_INVOICES_CCD$T",
											"type": "Double"
										},
										"sink": {
											"name": "PT_GROSS_INVOICES_CCD$T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "PT_GROSS_INVOICES_CCD$A",
											"type": "Double"
										},
										"sink": {
											"name": "PT_GROSS_INVOICES_CCD$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "PT_GROSS_INVOICES_STM$T",
											"type": "Double"
										},
										"sink": {
											"name": "PT_GROSS_INVOICES_STM$T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "PT_GROSS_INVOICES_STM$A",
											"type": "Double"
										},
										"sink": {
											"name": "PT_GROSS_INVOICES_STM$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "PT_GROSS_INVOICES_AMZ$T",
											"type": "Double"
										},
										"sink": {
											"name": "PT_GROSS_INVOICES_AMZ$T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "PT_GROSS_INVOICES_AMZ$A",
											"type": "Double"
										},
										"sink": {
											"name": "PT_GROSS_INVOICES_AMZ$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "PT_GROSS_INVOICES_APL$T",
											"type": "Double"
										},
										"sink": {
											"name": "PT_GROSS_INVOICES_APL$T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "PT_GROSS_INVOICES_APL$A",
											"type": "Double"
										},
										"sink": {
											"name": "PT_GROSS_INVOICES_APL$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "PT_GROSS_INVOICES_DGP$T",
											"type": "Double"
										},
										"sink": {
											"name": "PT_GROSS_INVOICES_DGP$T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "PT_GROSS_INVOICES_DGP$A",
											"type": "Double"
										},
										"sink": {
											"name": "PT_GROSS_INVOICES_DGP$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "PT_GROSS_INVOICES_PRB$T",
											"type": "Double"
										},
										"sink": {
											"name": "PT_GROSS_INVOICES_PRB$T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "PT_GROSS_INVOICES_PRB$A",
											"type": "Double"
										},
										"sink": {
											"name": "PT_GROSS_INVOICES_PRB$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "PT_GROSS_INVOICES_TOT$T",
											"type": "Double"
										},
										"sink": {
											"name": "PT_GROSS_INVOICES_TOT$T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "PT_GROSS_INVOICES_TOT$A",
											"type": "Double"
										},
										"sink": {
											"name": "PT_GROSS_INVOICES_TOT$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "PT_TAX_ACH$T",
											"type": "Double"
										},
										"sink": {
											"name": "PT_TAX_ACH$T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "PT_TOTAL_COLLECTED_ACH$A",
											"type": "Double"
										},
										"sink": {
											"name": "PT_TOTAL_COLLECTED_ACH$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "PT_TAX_CCD$T",
											"type": "Double"
										},
										"sink": {
											"name": "PT_TAX_CCD$T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "PT_TOTAL_COLLECTED_CCD$A",
											"type": "Double"
										},
										"sink": {
											"name": "PT_TOTAL_COLLECTED_CCD$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "PT_TAX_STM$T",
											"type": "Double"
										},
										"sink": {
											"name": "PT_TAX_STM$T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "PT_TOTAL_COLLECTED_STM$A",
											"type": "Double"
										},
										"sink": {
											"name": "PT_TOTAL_COLLECTED_STM$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "PT_TAX_AMZ$T",
											"type": "Double"
										},
										"sink": {
											"name": "PT_TAX_AMZ$T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "PT_TOTAL_COLLECTED_AMZ$A",
											"type": "Double"
										},
										"sink": {
											"name": "PT_TOTAL_COLLECTED_AMZ$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "PT_TAX_APL$T",
											"type": "Double"
										},
										"sink": {
											"name": "PT_TAX_APL$T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "PT_TOTAL_COLLECTED_APL$A",
											"type": "Double"
										},
										"sink": {
											"name": "PT_TOTAL_COLLECTED_APL$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "PT_TAX_DGP$T",
											"type": "Double"
										},
										"sink": {
											"name": "PT_TAX_DGP$T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "PT_TOTAL_COLLECTED_DGP$A",
											"type": "Double"
										},
										"sink": {
											"name": "PT_TOTAL_COLLECTED_DGP$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "PT_TAX_PRB$T",
											"type": "Double"
										},
										"sink": {
											"name": "PT_TAX_PRB$T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "PT_TOTAL_COLLECTED_PRB$A",
											"type": "Double"
										},
										"sink": {
											"name": "PT_TOTAL_COLLECTED_PRB$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "PT_TAX_TOT$T",
											"type": "Double"
										},
										"sink": {
											"name": "PT_TAX_TOT$T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "PT_TOTAL_COLLECTED_TOT$A",
											"type": "Double"
										},
										"sink": {
											"name": "PT_TOTAL_COLLECTED_TOT$A",
											"type": "Single"
										}
									}
								]
							}
						},
						"inputs": [
							{
								"referenceName": "SRC_PF_EFT_ALLOC_TAX_DS_VW",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "SNK_SYN_PF_EFT_ALLOC_TAX_DS",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Truncate table Sink",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Check Did Job Success",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "TRUNCATE TABLE [PF].[EFT_ALLOC_TAX_DS];\nselect 1;",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "SNK_SYN_PF_EFT_ALLOC_TAX_DS",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": true
						}
					},
					{
						"name": "Get Job Status",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "select 1\nfrom [dbo].[PF_VIEWS_JOBS_CHECK] \nwhere finish_time = cast(GETDATE() AT TIME ZONE 'UTC' AT TIME ZONE 'Eastern Standard Time' AS DATE) \nand FBI_JOB_NAME= 'PF.EFT_ALLOCATIONS_PR' and job_completed=1",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "SNK_DBO_PF_VIEWS_JOBS_CHECK",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "check Oracle Job",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Get Job Status",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "OracleSource",
								"oracleReaderQuery": "select JOB_NAME,START_TIME,FINISH_TIME,STATUS, 'PF.EFT_ALLOCATIONS_PR' as FBI_JOB_NAME \r\nfrom dw.job_monitoring_vw \r\nwhere job_name = 'PF.EFT_ALLOCATIONS_PR' and status = 'SUCCESS' and to_date(finish_time,'YYYY/MM/DD HH24:MI:SS') > trunc(sysdate)",
								"partitionOption": "None",
								"queryTimeout": "02:00:00"
							},
							"dataset": {
								"referenceName": "OracleTable1",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Check Did Job Success",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "check Oracle Job",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "select count(*) from pf_views_jobs_check \nwhere job_name = 'PF.EFT_ALLOCATIONS_PR' and \n    status = 'SUCCESS' and cast(finish_time as date)=cast(GETDATE() AT TIME ZONE 'UTC' AT TIME ZONE 'Eastern Standard Time' AS DATE)\n    and FBI_JOB_NAME='PF.EFT_ALLOCATIONS_PR'",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "SNK_DBO_PF_VIEWS_JOBS_CHECK",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Update Job Status",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Copy data1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "UPDATE [PF].[EFT_ALLOC_TAX_DS]\nSET AS_OF = GETDATE();\nSELECT 1\n",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "SNK_DBO_PF_VIEWS_JOBS_CHECK",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"folder": {
					"name": "EDW_PF_SQL_POOL"
				},
				"annotations": [],
				"lastPublishTime": "2023-02-23T16:21:18Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/PF_HARD_DECLINES_VW')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Copy data1",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Truncate table Sink",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "OracleSource",
								"oracleReaderQuery": "SELECT *\nFROM PF.HARD_DECLINES_VW",
								"partitionOption": "None",
								"queryTimeout": "02:00:00"
							},
							"sink": {
								"type": "SqlDWSink",
								"maxConcurrentConnections": 6,
								"allowPolyBase": true,
								"polyBaseSettings": {
									"rejectValue": 0,
									"rejectType": "value",
									"useTypeDefault": true
								},
								"disableMetricsCollection": false
							},
							"enableStaging": true,
							"stagingSettings": {
								"linkedServiceName": {
									"referenceName": "AzureBlobStorage1",
									"type": "LinkedServiceReference"
								},
								"path": "pfviewsoracle",
								"enableCompression": true
							},
							"parallelCopies": 8,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "VPD_ID",
											"type": "Decimal"
										},
										"sink": {
											"name": "VPD_ID",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "CLUB_NUMBER_I",
											"type": "Double"
										},
										"sink": {
											"name": "CLUB_NUMBER_I",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "SPL_ABC_ID",
											"type": "String"
										},
										"sink": {
											"name": "SPL_ABC_ID",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "A_AGREEMENT_NUMBER",
											"type": "String"
										},
										"sink": {
											"name": "A_AGREEMENT_NUMBER",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "APM_NAME",
											"type": "String"
										},
										"sink": {
											"name": "APM_NAME",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "A_OLDEST_NEXT_DUE_DATE",
											"type": "DateTime"
										},
										"sink": {
											"name": "A_OLDEST_NEXT_DUE_DATE",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "PAPMT_DATE_DUE",
											"type": "DateTime"
										},
										"sink": {
											"name": "PAPMT_DATE_DUE",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "REVERSAL_DATE",
											"type": "DateTime"
										},
										"sink": {
											"name": "REVERSAL_DATE",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "REVERSAL_REASON",
											"type": "String"
										},
										"sink": {
											"name": "REVERSAL_REASON",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "AMOUNT",
											"type": "Double"
										},
										"sink": {
											"name": "AMOUNT",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "M_NAME_LAST",
											"type": "String"
										},
										"sink": {
											"name": "M_NAME_LAST",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "M_NAME_FIRST",
											"type": "String"
										},
										"sink": {
											"name": "M_NAME_FIRST",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "M_PHONE_HOME",
											"type": "String"
										},
										"sink": {
											"name": "M_PHONE_HOME",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "M_PHONE_CELL",
											"type": "String"
										},
										"sink": {
											"name": "M_PHONE_CELL",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "M_EMAIL",
											"type": "String"
										},
										"sink": {
											"name": "M_EMAIL",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "A_DATE_JOINED",
											"type": "DateTime"
										},
										"sink": {
											"name": "A_DATE_JOINED",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "A_EFFECTIVITY_DATE",
											"type": "DateTime"
										},
										"sink": {
											"name": "A_EFFECTIVITY_DATE",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "ATL_ABC_ID",
											"type": "String"
										},
										"sink": {
											"name": "ATL_ABC_ID",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PROFIT_CENTER",
											"type": "String"
										},
										"sink": {
											"name": "PROFIT_CENTER",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "NEXT_DUE_DATE_INT",
											"type": "Double"
										},
										"sink": {
											"name": "NEXT_DUE_DATE_INT",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "INSERT_TIMESTAMP",
											"type": "DateTime"
										},
										"sink": {
											"name": "INSERT_TIMESTAMP",
											"type": "DateTime"
										}
									}
								]
							}
						},
						"inputs": [
							{
								"referenceName": "SRC_PF_EFT_HARD_DECLINES_VW",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "SNK_SYN_PF_HARD_DECLINES",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Truncate table Sink",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Check Did Job Success",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "TRUNCATE TABLE [PF].[HARD_DECLINES];\nselect 1;",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "SNK_SYN_PF_HARD_DECLINES",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": true
						}
					},
					{
						"name": "Get Job Status",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "select 1\nfrom [dbo].[PF_VIEWS_JOBS_CHECK] \nwhere finish_time = cast(GETDATE() AT TIME ZONE 'UTC' AT TIME ZONE 'Eastern Standard Time' AS DATE) \nand FBI_JOB_NAME= 'PF.EFT_ALLOCATIONS_PR' and job_completed=1",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "SNK_DBO_PF_VIEWS_JOBS_CHECK",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "check Oracle Job",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Get Job Status",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "OracleSource",
								"oracleReaderQuery": "select JOB_NAME,START_TIME,FINISH_TIME,STATUS, 'PF.EFT_ALLOCATIONS_PR' as FBI_JOB_NAME \r\nfrom dw.job_monitoring_vw \r\nwhere job_name = 'PF.EFT_ALLOCATIONS_PR' and status = 'SUCCESS' and to_date(finish_time,'YYYY/MM/DD HH24:MI:SS') > trunc(sysdate)",
								"partitionOption": "None",
								"queryTimeout": "02:00:00"
							},
							"dataset": {
								"referenceName": "OracleTable1",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Check Did Job Success",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "check Oracle Job",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "select count(*) from pf_views_jobs_check \nwhere job_name = 'PF.EFT_ALLOCATIONS_PR' and \n    status = 'SUCCESS' and cast(finish_time as date)=cast(GETDATE() AT TIME ZONE 'UTC' AT TIME ZONE 'Eastern Standard Time' AS DATE)\n    and FBI_JOB_NAME='PF.EFT_ALLOCATIONS_PR'",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "SNK_DBO_PF_VIEWS_JOBS_CHECK",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Update Job Status",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Copy data1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "UPDATE [PF].[HARD_DECLINES]\nSET AS_OF = GETDATE();\nSELECT 1\n",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "SNK_DBO_PF_VIEWS_JOBS_CHECK",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"folder": {
					"name": "EDW_PF_SQL_POOL"
				},
				"annotations": [],
				"lastPublishTime": "2023-02-23T16:21:18Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/PF_MEMBERSHIP_TYPE_SMRY_VW_SQLPOOL')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Truncate Incr table",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "truncate table [DW].[PF_MEMBERSHIP_TYPE_SMRY_INCR];\nselect 0;",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "AzureSynapseAnalyticsDB",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": false
						}
					},
					{
						"name": "Merge to Staging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "ForEach1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[DW].[PF_MEMBERSHIP_TYPE_SMRY_Merge]"
						},
						"linkedServiceName": {
							"referenceName": "AzureSynapseAnalytics1",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "ForEach1",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "Lookup1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('Lookup1').output.value",
								"type": "Expression"
							},
							"isSequential": false,
							"activities": [
								{
									"name": "PF_MEMBERSHIP_TYPE_SMRY",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "OracleSource",
											"oracleReaderQuery": {
												"value": "SELECT *\nFROM dw.pf_membership_type_smry_vw\nwhere TO_DATE(etl_Date_key, 'YYYYMMDD') >= TO_DATE('@{formatDateTime(pipeline().parameters.windowStart, 'yyyyMMdd' )}', 'YYYYMMDD') \nAND TO_DATE(etl_Date_key, 'YYYYMMDD') < TO_DATE('@{formatDateTime(pipeline().parameters.windowEnd, 'yyyyMMdd' )}', 'YYYYMMDD')\nAND club_number_i in @{item().cbcpy_list}",
												"type": "Expression"
											},
											"partitionOption": "None",
											"convertDecimalToInteger": false,
											"queryTimeout": "02:00:00"
										},
										"sink": {
											"type": "SqlDWSink",
											"maxConcurrentConnections": 6,
											"allowPolyBase": true,
											"polyBaseSettings": {
												"rejectValue": 0,
												"rejectType": "value",
												"useTypeDefault": false
											},
											"disableMetricsCollection": false
										},
										"enableStaging": true,
										"stagingSettings": {
											"linkedServiceName": {
												"referenceName": "AzureBlobStorage1",
												"type": "LinkedServiceReference"
											},
											"path": "vifiles",
											"enableCompression": false
										},
										"parallelCopies": 8,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "ETL_DATE_KEY",
														"type": "Decimal"
													},
													"sink": {
														"name": "ETL_DATE_KEY",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "CLUB_NUMBER_I",
														"type": "Decimal"
													},
													"sink": {
														"name": "CLUB_NUMBER_I",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "MEMBERSHIP_TYPE",
														"type": "String"
													},
													"sink": {
														"name": "MEMBERSHIP_TYPE",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "TOTAL_COUNT",
														"type": "Decimal"
													},
													"sink": {
														"name": "TOTAL_COUNT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "TOTAL_BILLING_COUNT",
														"type": "Decimal"
													},
													"sink": {
														"name": "TOTAL_BILLING_COUNT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "ACTIONS_DATE_KEY",
														"type": "String"
													},
													"sink": {
														"name": "ACTIONS_DATE_KEY",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "CLUB_JOINS_COUNT",
														"type": "Decimal"
													},
													"sink": {
														"name": "CLUB_JOINS_COUNT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "MOBILEINCLUB_COUNT",
														"type": "Decimal"
													},
													"sink": {
														"name": "MOBILEINCLUB_COUNT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "MOBILEASSISTED_COUNT",
														"type": "Decimal"
													},
													"sink": {
														"name": "MOBILEASSISTED_COUNT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "WEB_JOINS_COUNT",
														"type": "Decimal"
													},
													"sink": {
														"name": "WEB_JOINS_COUNT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "MOBILE_JOINS_COUNT",
														"type": "Decimal"
													},
													"sink": {
														"name": "MOBILE_JOINS_COUNT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "NEW_JOINS_COUNT",
														"type": "Decimal"
													},
													"sink": {
														"name": "NEW_JOINS_COUNT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "CONVERT_TO_BILLING_COUNT",
														"type": "Decimal"
													},
													"sink": {
														"name": "CONVERT_TO_BILLING_COUNT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "TOTAL_NEW_BILLING_COUNT",
														"type": "Decimal"
													},
													"sink": {
														"name": "TOTAL_NEW_BILLING_COUNT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "TOTAL_NEW_BILLING_AMOUNT",
														"type": "Decimal"
													},
													"sink": {
														"name": "TOTAL_NEW_BILLING_AMOUNT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "UPGRADE_COUNT",
														"type": "Decimal"
													},
													"sink": {
														"name": "UPGRADE_COUNT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "DOWNGRADE_COUNT",
														"type": "Decimal"
													},
													"sink": {
														"name": "DOWNGRADE_COUNT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "NO_IMPACT_COUNT",
														"type": "Decimal"
													},
													"sink": {
														"name": "NO_IMPACT_COUNT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "NET_IMPACT_AMOUNT",
														"type": "Decimal"
													},
													"sink": {
														"name": "NET_IMPACT_AMOUNT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "ACH_COUNT",
														"type": "Decimal"
													},
													"sink": {
														"name": "ACH_COUNT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "CC_COUNT",
														"type": "Decimal"
													},
													"sink": {
														"name": "CC_COUNT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "CANCEL_COUNT",
														"type": "Decimal"
													},
													"sink": {
														"name": "CANCEL_COUNT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "CANCEL_AMOUNT",
														"type": "Decimal"
													},
													"sink": {
														"name": "CANCEL_AMOUNT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "RFC_COUNT",
														"type": "Decimal"
													},
													"sink": {
														"name": "RFC_COUNT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "RFC_AMOUNT",
														"type": "Decimal"
													},
													"sink": {
														"name": "RFC_AMOUNT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "EXPIRE_COUNT",
														"type": "Decimal"
													},
													"sink": {
														"name": "EXPIRE_COUNT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "EXPIRE_AMOUNT",
														"type": "Decimal"
													},
													"sink": {
														"name": "EXPIRE_AMOUNT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "TRANSFER_IN_COUNT",
														"type": "Decimal"
													},
													"sink": {
														"name": "TRANSFER_IN_COUNT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "TRANSFER_IN_AMOUNT",
														"type": "Decimal"
													},
													"sink": {
														"name": "TRANSFER_IN_AMOUNT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "TRANSFER_OUT_COUNT",
														"type": "Decimal"
													},
													"sink": {
														"name": "TRANSFER_OUT_COUNT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "TRANSFER_OUT_AMOUNT",
														"type": "Decimal"
													},
													"sink": {
														"name": "TRANSFER_OUT_AMOUNT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "VOLUNTARY_CANCEL_COUNT",
														"type": "Decimal"
													},
													"sink": {
														"name": "VOLUNTARY_CANCEL_COUNT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "VOLUNTARY_CANCEL_AMOUNT",
														"type": "Decimal"
													},
													"sink": {
														"name": "VOLUNTARY_CANCEL_AMOUNT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "INVOLUNTARY_CANCEL_COUNT",
														"type": "Decimal"
													},
													"sink": {
														"name": "INVOLUNTARY_CANCEL_COUNT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "INVOLUNTARY_CANCEL_AMOUNT",
														"type": "Decimal"
													},
													"sink": {
														"name": "INVOLUNTARY_CANCEL_AMOUNT",
														"type": "Decimal"
													}
												}
											]
										}
									},
									"inputs": [
										{
											"referenceName": "SRC_PF_Royalty",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "SNK_SYN_PF_MEMBERSHIP_TYPE_SMRY_VW_INCR",
											"type": "DatasetReference",
											"parameters": {}
										}
									]
								}
							]
						}
					},
					{
						"name": "Lookup1",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Truncate Incr table",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderStoredProcedureName": "[[abcpi].[GetClubToLoad_300]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "AzureSynapseAnalyticsDB",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": false
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"windowStart": {
						"type": "string"
					},
					"windowEnd": {
						"type": "string"
					}
				},
				"folder": {
					"name": "EDW_PF_SQL_POOL"
				},
				"annotations": [],
				"lastPublishTime": "2023-02-23T16:21:18Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/PF_Member_UDF')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "PF_Member_UDF",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "OracleSource",
								"oracleReaderQuery": "select * from betadata.memberudfview where vpd_id IN (1119,224)",
								"partitionOption": "None",
								"queryTimeout": "02:00:00"
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "truncate table Dimfact.PF_Member_UDF;",
								"writeBehavior": "insert",
								"tableOption": "autoCreate",
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "VPD_ID",
											"type": "Decimal"
										},
										"sink": {
											"name": "VPD_ID",
											"type": "Decimal",
											"physicalType": "Decimal"
										}
									},
									{
										"source": {
											"name": "Agreement #",
											"type": "String"
										},
										"sink": {
											"name": "Agreement #",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "Ordinal Identifier",
											"type": "String"
										},
										"sink": {
											"name": "Ordinal Identifier",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "Club Nbr",
											"type": "String"
										},
										"sink": {
											"name": "Club Nbr",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "Member Number",
											"type": "String"
										},
										"sink": {
											"name": "Member Number",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "ORDINAL",
											"type": "Decimal"
										},
										"sink": {
											"name": "ORDINAL",
											"type": "Decimal",
											"physicalType": "Decimal"
										}
									},
									{
										"source": {
											"name": "SPL_ID",
											"type": "String"
										},
										"sink": {
											"name": "SPL_ID",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "A_ID",
											"type": "String"
										},
										"sink": {
											"name": "A_ID",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "M_ID",
											"type": "String"
										},
										"sink": {
											"name": "M_ID",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "UDF Name",
											"type": "String"
										},
										"sink": {
											"name": "UDF Name",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "REPORT_VIEW_LABEL",
											"type": "String"
										},
										"sink": {
											"name": "REPORT_VIEW_LABEL",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "COLUMN_LABEL",
											"type": "String"
										},
										"sink": {
											"name": "COLUMN_LABEL",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "UDF_VALUE",
											"type": "String"
										},
										"sink": {
											"name": "UDF_VALUE",
											"type": "String",
											"physicalType": "String"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "SRC_BETADATA",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "PF_Member_UDF",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Stored procedure1",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "PF_Member_UDF",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[DimFact].[PF_Member_UDFUpdate]"
						},
						"linkedServiceName": {
							"referenceName": "AzureSqlDatabase1",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"folder": {
					"name": "PF"
				},
				"annotations": [],
				"lastPublishTime": "2022-08-10T21:17:10Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/PF_PF_CBFIL_PROJ_SNAPSHOT_VW')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Copy data1",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Truncate table Sink",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "OracleSource",
								"oracleReaderQuery": "SELECT *\nFROM DW.PF_CBFIL_PROJ_SNAPSHOT_VW",
								"partitionOption": "None",
								"queryTimeout": "02:00:00"
							},
							"sink": {
								"type": "SqlDWSink",
								"maxConcurrentConnections": 6,
								"allowPolyBase": true,
								"polyBaseSettings": {
									"rejectValue": 0,
									"rejectType": "value",
									"useTypeDefault": true
								},
								"disableMetricsCollection": false
							},
							"enableStaging": true,
							"stagingSettings": {
								"linkedServiceName": {
									"referenceName": "AzureBlobStorage1",
									"type": "LinkedServiceReference"
								},
								"path": "pfviewsoracle",
								"enableCompression": true
							},
							"parallelCopies": 8,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "CBTW1",
											"type": "String"
										},
										"sink": {
											"name": "CBTW1",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "CBTW3",
											"type": "String"
										},
										"sink": {
											"name": "CBTW3",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "CBTW4",
											"type": "String"
										},
										"sink": {
											"name": "CBTW4",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "CBTW5",
											"type": "String"
										},
										"sink": {
											"name": "CBTW5",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "CBTW6",
											"type": "String"
										},
										"sink": {
											"name": "CBTW6",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "CBTW7",
											"type": "String"
										},
										"sink": {
											"name": "CBTW7",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "CBTW8",
											"type": "String"
										},
										"sink": {
											"name": "CBTW8",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "CBTW9",
											"type": "String"
										},
										"sink": {
											"name": "CBTW9",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "CLUB_NUMBER_I",
											"type": "Decimal"
										},
										"sink": {
											"name": "CLUB_NUMBER_I",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "CBTSL",
											"type": "String"
										},
										"sink": {
											"name": "CBTSL",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "CBTSC",
											"type": "Decimal"
										},
										"sink": {
											"name": "CBTSC",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "CBPCP",
											"type": "String"
										},
										"sink": {
											"name": "CBPCP",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "CBTZN",
											"type": "String"
										},
										"sink": {
											"name": "CBTZN",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "CBSCC",
											"type": "String"
										},
										"sink": {
											"name": "CBSCC",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "CBRCS",
											"type": "Decimal"
										},
										"sink": {
											"name": "CBRCS",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "CBLMU",
											"type": "Decimal"
										},
										"sink": {
											"name": "CBLMU",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "CBTF9",
											"type": "String"
										},
										"sink": {
											"name": "CBTF9",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "CBRLC",
											"type": "Decimal"
										},
										"sink": {
											"name": "CBRLC",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "CBRLM",
											"type": "Decimal"
										},
										"sink": {
											"name": "CBRLM",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "CBARF",
											"type": "String"
										},
										"sink": {
											"name": "CBARF",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "CBCSH",
											"type": "Decimal"
										},
										"sink": {
											"name": "CBCSH",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "CBRIF",
											"type": "String"
										},
										"sink": {
											"name": "CBRIF",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "CBRID",
											"type": "Decimal"
										},
										"sink": {
											"name": "CBRID",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "CBSVC",
											"type": "Decimal"
										},
										"sink": {
											"name": "CBSVC",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "CBSVD",
											"type": "Decimal"
										},
										"sink": {
											"name": "CBSVD",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "CBGDY",
											"type": "Decimal"
										},
										"sink": {
											"name": "CBGDY",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "CBLCF",
											"type": "String"
										},
										"sink": {
											"name": "CBLCF",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "CBLCA",
											"type": "Decimal"
										},
										"sink": {
											"name": "CBLCA",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "CBLCP",
											"type": "Decimal"
										},
										"sink": {
											"name": "CBLCP",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "CBLLF",
											"type": "String"
										},
										"sink": {
											"name": "CBLLF",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "CBL15",
											"type": "String"
										},
										"sink": {
											"name": "CBL15",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "CBL30",
											"type": "String"
										},
										"sink": {
											"name": "CBL30",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "CBL45",
											"type": "String"
										},
										"sink": {
											"name": "CBL45",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "CBL60",
											"type": "String"
										},
										"sink": {
											"name": "CBL60",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "CBLAL",
											"type": "String"
										},
										"sink": {
											"name": "CBLAL",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "CBLPO",
											"type": "String"
										},
										"sink": {
											"name": "CBLPO",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "CBPMF",
											"type": "String"
										},
										"sink": {
											"name": "CBPMF",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "CBPMC",
											"type": "Decimal"
										},
										"sink": {
											"name": "CBPMC",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "CBPMR",
											"type": "String"
										},
										"sink": {
											"name": "CBPMR",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "CBPMA",
											"type": "String"
										},
										"sink": {
											"name": "CBPMA",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "CBRPS",
											"type": "String"
										},
										"sink": {
											"name": "CBRPS",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "CBTF4",
											"type": "String"
										},
										"sink": {
											"name": "CBTF4",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "CBTF5",
											"type": "String"
										},
										"sink": {
											"name": "CBTF5",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "CBTF6",
											"type": "String"
										},
										"sink": {
											"name": "CBTF6",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "CBTF7",
											"type": "String"
										},
										"sink": {
											"name": "CBTF7",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "CBTSD",
											"type": "String"
										},
										"sink": {
											"name": "CBTSD",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "CBTF2",
											"type": "String"
										},
										"sink": {
											"name": "CBTF2",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ETL_DATE_KEY",
											"type": "Decimal"
										},
										"sink": {
											"name": "ETL_DATE_KEY",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "ETL_DATETIME",
											"type": "DateTime"
										},
										"sink": {
											"name": "ETL_DATETIME",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "CBCLB",
											"type": "Decimal"
										},
										"sink": {
											"name": "CBCLB",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "CBCPY",
											"type": "String"
										},
										"sink": {
											"name": "CBCPY",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "CBACT",
											"type": "String"
										},
										"sink": {
											"name": "CBACT",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "CBNME",
											"type": "String"
										},
										"sink": {
											"name": "CBNME",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "CBAD1",
											"type": "String"
										},
										"sink": {
											"name": "CBAD1",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "CBAD2",
											"type": "String"
										},
										"sink": {
											"name": "CBAD2",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "CBCTY",
											"type": "String"
										},
										"sink": {
											"name": "CBCTY",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "CBSTE",
											"type": "String"
										},
										"sink": {
											"name": "CBSTE",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "CBZIP",
											"type": "Decimal"
										},
										"sink": {
											"name": "CBZIP",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "CBZC4",
											"type": "Decimal"
										},
										"sink": {
											"name": "CBZC4",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "CBPNM",
											"type": "String"
										},
										"sink": {
											"name": "CBPNM",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "CBPA1",
											"type": "String"
										},
										"sink": {
											"name": "CBPA1",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "CBPA2",
											"type": "String"
										},
										"sink": {
											"name": "CBPA2",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "CBPCY",
											"type": "String"
										},
										"sink": {
											"name": "CBPCY",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "CBPST",
											"type": "String"
										},
										"sink": {
											"name": "CBPST",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "CBPZC",
											"type": "Decimal"
										},
										"sink": {
											"name": "CBPZC",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "CBPZ4",
											"type": "Decimal"
										},
										"sink": {
											"name": "CBPZ4",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "CBPHA",
											"type": "String"
										},
										"sink": {
											"name": "CBPHA",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "CBPHP",
											"type": "String"
										},
										"sink": {
											"name": "CBPHP",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "CBPHN",
											"type": "String"
										},
										"sink": {
											"name": "CBPHN",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "CBFXA",
											"type": "String"
										},
										"sink": {
											"name": "CBFXA",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "CBFXP",
											"type": "String"
										},
										"sink": {
											"name": "CBFXP",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "CBFXN",
											"type": "String"
										},
										"sink": {
											"name": "CBFXN",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "CBCN1",
											"type": "String"
										},
										"sink": {
											"name": "CBCN1",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "CBCN2",
											"type": "String"
										},
										"sink": {
											"name": "CBCN2",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "CBCN3",
											"type": "String"
										},
										"sink": {
											"name": "CBCN3",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "CBCN4",
											"type": "String"
										},
										"sink": {
											"name": "CBCN4",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "CBCN5",
											"type": "String"
										},
										"sink": {
											"name": "CBCN5",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "CBCN6",
											"type": "String"
										},
										"sink": {
											"name": "CBCN6",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "CBSLM",
											"type": "String"
										},
										"sink": {
											"name": "CBSLM",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "CBSBD",
											"type": "Decimal"
										},
										"sink": {
											"name": "CBSBD",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "CBPMO",
											"type": "String"
										},
										"sink": {
											"name": "CBPMO",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "CBPCH",
											"type": "String"
										},
										"sink": {
											"name": "CBPCH",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "CBEDT",
											"type": "Decimal"
										},
										"sink": {
											"name": "CBEDT",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "CBRDT",
											"type": "Decimal"
										},
										"sink": {
											"name": "CBRDT",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "CBTF3",
											"type": "String"
										},
										"sink": {
											"name": "CBTF3",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "CBWGR",
											"type": "String"
										},
										"sink": {
											"name": "CBWGR",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "CBIAR",
											"type": "String"
										},
										"sink": {
											"name": "CBIAR",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "CBCCP",
											"type": "Decimal"
										},
										"sink": {
											"name": "CBCCP",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "CBCPD",
											"type": "Decimal"
										},
										"sink": {
											"name": "CBCPD",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "CBCED",
											"type": "Decimal"
										},
										"sink": {
											"name": "CBCED",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "CBCCC",
											"type": "Decimal"
										},
										"sink": {
											"name": "CBCCC",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "CBCDF",
											"type": "Decimal"
										},
										"sink": {
											"name": "CBCDF",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "CBACF",
											"type": "String"
										},
										"sink": {
											"name": "CBACF",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "CBACA",
											"type": "Decimal"
										},
										"sink": {
											"name": "CBACA",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "CBACP",
											"type": "Decimal"
										},
										"sink": {
											"name": "CBACP",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "CBAPD",
											"type": "Decimal"
										},
										"sink": {
											"name": "CBAPD",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "CBAED",
											"type": "Decimal"
										},
										"sink": {
											"name": "CBAED",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "CBACC",
											"type": "Decimal"
										},
										"sink": {
											"name": "CBACC",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "CBADF",
											"type": "Decimal"
										},
										"sink": {
											"name": "CBADF",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "CBNLR",
											"type": "String"
										},
										"sink": {
											"name": "CBNLR",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "CBNLD",
											"type": "String"
										},
										"sink": {
											"name": "CBNLD",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "CBNLC",
											"type": "String"
										},
										"sink": {
											"name": "CBNLC",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "CBNLP",
											"type": "String"
										},
										"sink": {
											"name": "CBNLP",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "CBNPC",
											"type": "String"
										},
										"sink": {
											"name": "CBNPC",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "CBPCF",
											"type": "String"
										},
										"sink": {
											"name": "CBPCF",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "CBPCC",
											"type": "Decimal"
										},
										"sink": {
											"name": "CBPCC",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "CBPCM",
											"type": "Decimal"
										},
										"sink": {
											"name": "CBPCM",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "CBPCD",
											"type": "String"
										},
										"sink": {
											"name": "CBPCD",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "CBPCR",
											"type": "String"
										},
										"sink": {
											"name": "CBPCR",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "CBPCT",
											"type": "String"
										},
										"sink": {
											"name": "CBPCT",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "CBRLF",
											"type": "String"
										},
										"sink": {
											"name": "CBRLF",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "CBRLP",
											"type": "String"
										},
										"sink": {
											"name": "CBRLP",
											"type": "String"
										}
									}
								]
							}
						},
						"inputs": [
							{
								"referenceName": "SRC_PF_PF_CBFIL_PROJ_SNAPSHOT_VW",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "SNK_SYN_PF_CBFIL_PROJ_SNAPSHOT",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Truncate table Sink",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Check Did Job Success",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "TRUNCATE TABLE [PF].[PF_CBFIL_PROJ_SNAPSHOT];\nselect 1;",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "SNK_SYN_PF_CBFIL_PROJ_SNAPSHOT",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": true
						}
					},
					{
						"name": "Get Job Status",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "select 1\nfrom [dbo].[PF_VIEWS_JOBS_CHECK] \nwhere finish_time = cast(GETDATE() AT TIME ZONE 'UTC' AT TIME ZONE 'Eastern Standard Time' AS DATE) \nand FBI_JOB_NAME= 'EFT_RECONCILIATION_SMRY' and job_completed=1",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "SNK_DBO_PF_VIEWS_JOBS_CHECK",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "check Oracle Job",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Get Job Status",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "OracleSource",
								"oracleReaderQuery": "select JOB_NAME,START_TIME,FINISH_TIME,STATUS, 'PF.EFT_RECONCILIATION_SMRY' as FBI_JOB_NAME \r\nfrom dw.job_monitoring_vw \r\nwhere job_name = 'PF.EFT_RECONCILIATION_SMRY' and status = 'SUCCESS' and to_date(finish_time,'YYYY/MM/DD HH24:MI:SS') > trunc(sysdate)",
								"partitionOption": "None",
								"queryTimeout": "02:00:00"
							},
							"dataset": {
								"referenceName": "OracleTable1",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Check Did Job Success",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "check Oracle Job",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "select count(*) from pf_views_jobs_check \nwhere job_name = 'PF.EFT_RECONCILIATION_SMRY' and \n    status = 'SUCCESS' and cast(finish_time as date)=cast(GETDATE() AT TIME ZONE 'UTC' AT TIME ZONE 'Eastern Standard Time' AS DATE)\n    and FBI_JOB_NAME='PF.EFT_RECONCILIATION_SMRY'",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "SNK_DBO_PF_VIEWS_JOBS_CHECK",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Update Job Status",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Copy data1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "UPDATE [PF].[PF_CBFIL_PROJ_SNAPSHOT]\nSET AS_OF = GETDATE();\nSELECT 1\n",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "SNK_DBO_PF_VIEWS_JOBS_CHECK",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"folder": {
					"name": "EDW_PF_SQL_POOL"
				},
				"annotations": [],
				"lastPublishTime": "2023-02-23T16:21:18Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/PF_PROJECTION_ISERIES')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Lookup_Clubs",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Truncate Incr table",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderStoredProcedureName": "[[abcpi].[GetClubToLoad_300]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "AzureSynapseAnalyticsDB",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": false
						}
					},
					{
						"name": "ForEach",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "Lookup_Clubs",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('Lookup_Clubs').output.value",
								"type": "Expression"
							},
							"isSequential": false,
							"activities": [
								{
									"name": "Get Data",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "Db2Source",
											"query": {
												"value": "select\nCAST(cd.CDCLB as VARCHAR(6)) as CDCLB,\nCAST(cd.CDDTE as VARCHAR(6)) as CDDTE,\nCAST(cd.CDTYP as VARCHAR(1)) as CDTYP,\nCAST(cd.cdmde as VARCHAR(1)) as cdmde,\nCAST(cd.CDCCTCODE as VARCHAR(10)) as CDCCTCODE,\nCAST(cw.cwfrq as VARCHAR(1)) as cwfrq,\ncount_BIG(*) as cnt,\nsum(cdcda) as Dues,\nCURRENT DATE as ProjectionDate\n\t   from abc400fil.cdfil cd\n\t   join abc400fil.cbfil cb on cd.cdclb=cbclb \n\t   left join abc400fil.cwfil cw on cd.cdclb=cwclb and cdmbr=cwmbr --and cdseq=cwseq\nwhere cdcda <> 0\nAND cdclb in @{item().cbcpy_list}\nAND cbcpy='PF' AND cddte= @{pipeline().parameters.cddte_value} \n       and CDCCTCODE not like '%ANNUAL%' and CDTYP <> 'P' and cwast <> 'I'\n\t   group by  cdclb, cddte, CDTYP, cdmde, CDCCTCODE, cwfrq\norder by cdclb \nWITH UR",
												"type": "Expression"
											}
										},
										"sink": {
											"type": "SqlDWSink",
											"allowPolyBase": true,
											"polyBaseSettings": {
												"rejectValue": 0,
												"rejectType": "value",
												"useTypeDefault": false
											},
											"disableMetricsCollection": false
										},
										"enableStaging": true,
										"stagingSettings": {
											"linkedServiceName": {
												"referenceName": "AzureBlobStorage1",
												"type": "LinkedServiceReference"
											},
											"path": "vifiles"
										},
										"parallelCopies": 32,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "CDCLB",
														"type": "String"
													},
													"sink": {
														"name": "CDCLB",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "CDDTE",
														"type": "String"
													},
													"sink": {
														"name": "CDDTE",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "CNT",
														"type": "Int64"
													},
													"sink": {
														"name": "CNT",
														"type": "Int64"
													}
												},
												{
													"source": {
														"name": "DUES",
														"type": "Decimal"
													},
													"sink": {
														"name": "DUES",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "CDTYP",
														"type": "String"
													},
													"sink": {
														"name": "CDTYP",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "CDMDE",
														"type": "String"
													},
													"sink": {
														"name": "CDMDE",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "CDCCTCODE",
														"type": "String"
													},
													"sink": {
														"name": "CDCCTCODE",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "CWFRQ",
														"type": "String"
													},
													"sink": {
														"name": "CWFRQ",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "PROJECTIONDATE",
														"type": "DateTime"
													},
													"sink": {
														"name": "ProjectionDate",
														"type": "DateTime"
													}
												}
											]
										}
									},
									"inputs": [
										{
											"referenceName": "SRC_ABC400FIL",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "SNK_SYN_ISERIES_PF_PROJECTION",
											"type": "DatasetReference",
											"parameters": {}
										}
									]
								}
							]
						}
					},
					{
						"name": "Truncate Incr table",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "truncate table DW.PF_PROJECTION_ISERIES_INCR;\nselect 0;",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "AzureSynapseAnalyticsDB",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": false
						}
					},
					{
						"name": "Merge PF_PROJECTION",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "ForEach",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[DW].[PF_PROJECTION_ISERIES_MERGE]"
						},
						"linkedServiceName": {
							"referenceName": "AzureSynapseAnalytics1",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"cddte_value": {
						"type": "string"
					}
				},
				"folder": {
					"name": "Iseries_SQLPOOL"
				},
				"annotations": [],
				"lastPublishTime": "2023-02-08T11:25:31Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/PF_ROYALTIES_ADDED_VW_SQLPOOL')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Truncate Incr table",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "truncate table [PF].[PF_ROYALTIES_ADDED_INCR];\nselect 0;",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "AzureSynapseAnalyticsDB",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": false
						}
					},
					{
						"name": "Merge to Staging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "PF_ROYALTIES_ADDED",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[PF].[PF_ROYALTIES_ADDED_Merge]"
						},
						"linkedServiceName": {
							"referenceName": "AzureSynapseAnalytics1",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "PF_ROYALTIES_ADDED",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Truncate Incr table",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "OracleSource",
								"oracleReaderQuery": {
									"value": "SELECT *\nFROM pf.PF_ROYALTIES_ADDED_VW\n",
									"type": "Expression"
								},
								"partitionOption": "None",
								"convertDecimalToInteger": false,
								"queryTimeout": "02:00:00"
							},
							"sink": {
								"type": "SqlDWSink",
								"maxConcurrentConnections": 6,
								"allowPolyBase": true,
								"polyBaseSettings": {
									"rejectValue": 0,
									"rejectType": "value",
									"useTypeDefault": false
								},
								"disableMetricsCollection": false
							},
							"enableStaging": true,
							"stagingSettings": {
								"linkedServiceName": {
									"referenceName": "AzureBlobStorage1",
									"type": "LinkedServiceReference"
								},
								"path": "vifiles",
								"enableCompression": false
							},
							"parallelCopies": 8,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "STATE",
											"type": "String"
										},
										"sink": {
											"name": "STATE",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ADDEDTAX",
											"type": "Decimal"
										},
										"sink": {
											"name": "ADDEDTAX",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ADDITIONALCOLUMN",
											"type": "String"
										},
										"sink": {
											"name": "ADDITIONALCOLUMN",
											"type": "String"
										}
									}
								]
							}
						},
						"inputs": [
							{
								"referenceName": "SRC_PF_Royalty",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "SNK_SYN_PF_ROYALTIES_ADDED_VW_INCR",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"folder": {
					"name": "EDW_PF_SQL_POOL"
				},
				"annotations": [],
				"lastPublishTime": "2023-02-23T16:21:18Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/PF_ROYALTIES_FROZEN_prd_VW_SQLPOOL')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Truncate Incr table",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "truncate table [PF].[ROYALTIES_FROZEN_prd_INCR];\nselect 0;",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "AzureSynapseAnalyticsDB",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": false
						}
					},
					{
						"name": "Merge to Staging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "ForEach1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[PF].[ROYALTIES_FROZEN_prd_Merge]"
						},
						"linkedServiceName": {
							"referenceName": "AzureSynapseAnalytics1",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "ForEach1",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "Lookup1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('Lookup1').output.value",
								"type": "Expression"
							},
							"isSequential": false,
							"activities": [
								{
									"name": "PF_ROYALTIES_FROZEN_prd",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "OracleSource",
											"oracleReaderQuery": {
												"value": "SELECT *\nFROM pf.ROYALTIES_FROZEN_prd_VW\nwhere TO_DATE(etl_Date_key, 'YYYYMMDD') >= TO_DATE('@{formatDateTime(pipeline().parameters.windowStart, 'yyyyMMdd' )}', 'YYYYMMDD') \nAND TO_DATE(etl_Date_key, 'YYYYMMDD') < TO_DATE('@{formatDateTime(pipeline().parameters.windowEnd, 'yyyyMMdd' )}', 'YYYYMMDD')\nAND cast(club_number_i as int) in @{item().cbcpy_list}",
												"type": "Expression"
											},
											"partitionOption": "None",
											"convertDecimalToInteger": false,
											"queryTimeout": "02:00:00"
										},
										"sink": {
											"type": "SqlDWSink",
											"maxConcurrentConnections": 6,
											"allowPolyBase": true,
											"polyBaseSettings": {
												"rejectValue": 0,
												"rejectType": "value",
												"useTypeDefault": false
											},
											"disableMetricsCollection": false
										},
										"enableStaging": true,
										"stagingSettings": {
											"linkedServiceName": {
												"referenceName": "AzureBlobStorage1",
												"type": "LinkedServiceReference"
											},
											"path": "vifiles",
											"enableCompression": false
										},
										"parallelCopies": 8,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "YEARMONTH",
														"type": "String"
													},
													"sink": {
														"name": "YEARMONTH",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "ETL_DATE_KEY",
														"type": "Decimal"
													},
													"sink": {
														"name": "ETL_DATE_KEY",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "CLUB_NUMBER_I",
														"type": "String"
													},
													"sink": {
														"name": "CLUB_NUMBER_I",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "TRANSACTION_COUNT",
														"type": "Double"
													},
													"sink": {
														"name": "TRANSACTION_COUNT",
														"type": "Single"
													}
												},
												{
													"source": {
														"name": "INVOICE_PRE_TAX_AMOUNT",
														"type": "Double"
													},
													"sink": {
														"name": "INVOICE_PRE_TAX_AMOUNT",
														"type": "Single"
													}
												},
												{
													"source": {
														"name": "INVOICE_TAX_AMOUNT",
														"type": "Double"
													},
													"sink": {
														"name": "INVOICE_TAX_AMOUNT",
														"type": "Single"
													}
												},
												{
													"source": {
														"name": "NAF_ANNUAL_PRE_TAX_AMOUNT",
														"type": "Double"
													},
													"sink": {
														"name": "NAF_ANNUAL_PRE_TAX_AMOUNT",
														"type": "Single"
													}
												},
												{
													"source": {
														"name": "NAF_ANNUAL_TAX_AMOUNT",
														"type": "Double"
													},
													"sink": {
														"name": "NAF_ANNUAL_TAX_AMOUNT",
														"type": "Single"
													}
												},
												{
													"source": {
														"name": "REPORT_TYPE",
														"type": "String"
													},
													"sink": {
														"name": "REPORT_TYPE",
														"type": "String"
													}
												}
											]
										}
									},
									"inputs": [
										{
											"referenceName": "SRC_PF_Royalty",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "SNK_SYN_PF_ROYALTIES_FROZEN_prd_INCR",
											"type": "DatasetReference",
											"parameters": {}
										}
									]
								}
							]
						}
					},
					{
						"name": "Lookup1",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Truncate Incr table",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderStoredProcedureName": "[[abcpi].[GetClubToLoad_300]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "AzureSynapseAnalyticsDB",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": false
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"windowStart": {
						"type": "string"
					},
					"windowEnd": {
						"type": "string"
					}
				},
				"folder": {
					"name": "EDW_PF_SQL_POOL"
				},
				"annotations": [],
				"lastPublishTime": "2023-02-23T16:21:18Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/PF_ROYALTIES_TIER_RATES_prd_VW_SQLPOOL')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Truncate Incr table",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "truncate table [PF].Royalties_tier_rates_prd_INCR;\nselect 0;",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "AzureSynapseAnalyticsDB",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": false
						}
					},
					{
						"name": "Merge to Staging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "ForEach1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[PF].[Royalties_tier_rates_prd_Merge]"
						},
						"linkedServiceName": {
							"referenceName": "AzureSynapseAnalytics1",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "ForEach1",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "Lookup1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('Lookup1').output.value",
								"type": "Expression"
							},
							"isSequential": false,
							"activities": [
								{
									"name": "PF_Royalties_tier_rates_prd_INCR",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "OracleSource",
											"oracleReaderQuery": {
												"value": "SELECT *\nFROM pf.Royalties_tier_rates_prd_VW\nwhere TO_DATE(Date_key, 'YYYYMMDD') >= TO_DATE('@{formatDateTime(pipeline().parameters.WindowStart, 'yyyyMMdd' )}', 'YYYYMMDD') \nAND TO_DATE(Date_key, 'YYYYMMDD') < TO_DATE('@{formatDateTime(pipeline().parameters.WindowEnd, 'yyyyMMdd' )}', 'YYYYMMDD')\nAND cast(abc_club_number as int) in @{item().cbcpy_list}",
												"type": "Expression"
											},
											"partitionOption": "None",
											"convertDecimalToInteger": false,
											"queryTimeout": "02:00:00"
										},
										"sink": {
											"type": "SqlDWSink",
											"maxConcurrentConnections": 6,
											"allowPolyBase": true,
											"polyBaseSettings": {
												"rejectValue": 0,
												"rejectType": "value",
												"useTypeDefault": false
											},
											"disableMetricsCollection": false
										},
										"enableStaging": true,
										"stagingSettings": {
											"linkedServiceName": {
												"referenceName": "AzureBlobStorage1",
												"type": "LinkedServiceReference"
											},
											"path": "vifiles",
											"enableCompression": false
										},
										"parallelCopies": 8,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "DATE_KEY",
														"type": "Decimal"
													},
													"sink": {
														"name": "DATE_KEY",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "ABC_CLUB_NUMBER",
														"type": "String"
													},
													"sink": {
														"name": "ABC_CLUB_NUMBER",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "PF_CLUB_NUMBER",
														"type": "String"
													},
													"sink": {
														"name": "PF_CLUB_NUMBER",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "CLUB_NAME",
														"type": "String"
													},
													"sink": {
														"name": "CLUB_NAME",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "CLUB_STATUS",
														"type": "String"
													},
													"sink": {
														"name": "CLUB_STATUS",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "TIER",
														"type": "String"
													},
													"sink": {
														"name": "TIER",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "NAF",
														"type": "String"
													},
													"sink": {
														"name": "NAF",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "PASS_THRU_NAF",
														"type": "String"
													},
													"sink": {
														"name": "PASS_THRU_NAF",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "WEB_JOINS",
														"type": "Decimal"
													},
													"sink": {
														"name": "WEB_JOINS",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "PASS_THRU_WEB_JOINS",
														"type": "Decimal"
													},
													"sink": {
														"name": "PASS_THRU_WEB_JOINS",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "ROYALTY_TAX_WITHHELD",
														"type": "Decimal"
													},
													"sink": {
														"name": "ROYALTY_TAX_WITHHELD",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "ADDITIONAL_CHARGE",
														"type": "Decimal"
													},
													"sink": {
														"name": "ADDITIONAL_CHARGE",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "GRACE_PERIOD_FEES",
														"type": "Decimal"
													},
													"sink": {
														"name": "GRACE_PERIOD_FEES",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "CHARITABLE_DONATION",
														"type": "Decimal"
													},
													"sink": {
														"name": "CHARITABLE_DONATION",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "WITHHOLDINGS",
														"type": "Decimal"
													},
													"sink": {
														"name": "WITHHOLDINGS",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "OPTUM_REIMBURSEMENT_AMOUNT",
														"type": "Decimal"
													},
													"sink": {
														"name": "OPTUM_REIMBURSEMENT_AMOUNT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "OPTUM_REIMBURSEMENT_COUNT",
														"type": "Decimal"
													},
													"sink": {
														"name": "OPTUM_REIMBURSEMENT_COUNT",
														"type": "Decimal"
													}
												}
											]
										}
									},
									"inputs": [
										{
											"referenceName": "SRC_PF_Royalty",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "SNK_SYN_PF_Royalties_tier_rates_prd_INCR",
											"type": "DatasetReference",
											"parameters": {}
										}
									]
								}
							]
						}
					},
					{
						"name": "Lookup1",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Truncate Incr table",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderStoredProcedureName": "[[abcpi].[GetClubToLoad_300]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "AzureSynapseAnalyticsDB",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": false
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"WindowStart": {
						"type": "string"
					},
					"WindowEnd": {
						"type": "string"
					}
				},
				"folder": {
					"name": "EDW_PF_SQL_POOL"
				},
				"annotations": [],
				"lastPublishTime": "2023-02-23T16:21:18Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/PF_ROYALTIES_TIER_prd_VW_SQLPOOL')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "PF_ROYALTIES_tier_prd",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Truncate Incr table",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "OracleSource",
								"oracleReaderQuery": "SELECT *\nFROM pf.Royalties_tier_prd_vw",
								"partitionOption": "None",
								"queryTimeout": "02:00:00"
							},
							"sink": {
								"type": "SqlDWSink",
								"maxConcurrentConnections": 6,
								"allowPolyBase": true,
								"polyBaseSettings": {
									"rejectValue": 0,
									"rejectType": "value",
									"useTypeDefault": false
								},
								"tableOption": "autoCreate",
								"disableMetricsCollection": false
							},
							"enableStaging": true,
							"stagingSettings": {
								"linkedServiceName": {
									"referenceName": "AzureBlobStorage1",
									"type": "LinkedServiceReference"
								},
								"path": "vifiles",
								"enableCompression": false
							},
							"parallelCopies": 8,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "TIER",
											"type": "String"
										},
										"sink": {
											"name": "TIER",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "EFT_ONLY",
											"type": "String"
										},
										"sink": {
											"name": "EFT_ONLY",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "NONE",
											"type": "Decimal"
										},
										"sink": {
											"name": "NONE",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "X50000",
											"type": "Decimal"
										},
										"sink": {
											"name": "X50000",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "X75000",
											"type": "Decimal"
										},
										"sink": {
											"name": "X75000",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "X100000",
											"type": "Decimal"
										},
										"sink": {
											"name": "X100000",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "X125000",
											"type": "Decimal"
										},
										"sink": {
											"name": "X125000",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "X150000",
											"type": "Decimal"
										},
										"sink": {
											"name": "X150000",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "X175000",
											"type": "Decimal"
										},
										"sink": {
											"name": "X175000",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "X200000",
											"type": "Decimal"
										},
										"sink": {
											"name": "X200000",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "X250000",
											"type": "Decimal"
										},
										"sink": {
											"name": "X250000",
											"type": "Decimal"
										}
									}
								]
							}
						},
						"inputs": [
							{
								"referenceName": "SRC_PF_Royalty",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "SNK_SYN_PF_Royalties_tier_prd_INCR",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Truncate Incr table",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "truncate table [PF].[Royalties_tier_prd_INCR];\nselect 0;",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "AzureSynapseAnalyticsDB",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": false
						}
					},
					{
						"name": "Merge to Staging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "PF_ROYALTIES_tier_prd",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[PF].[Royalties_tier_prd_Merge]"
						},
						"linkedServiceName": {
							"referenceName": "AzureSynapseAnalytics1",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"folder": {
					"name": "EDW_PF_SQL_POOL"
				},
				"annotations": [],
				"lastPublishTime": "2023-02-23T16:21:18Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/PF_SOFT_DECLINES_VW')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Copy data1",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Truncate table Sink",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "OracleSource",
								"oracleReaderQuery": "SELECT *\nFROM PF.SOFT_DECLINES_VW",
								"partitionOption": "None",
								"queryTimeout": "02:00:00"
							},
							"sink": {
								"type": "SqlDWSink",
								"maxConcurrentConnections": 6,
								"allowPolyBase": true,
								"polyBaseSettings": {
									"rejectValue": 0,
									"rejectType": "value",
									"useTypeDefault": true
								},
								"disableMetricsCollection": false
							},
							"enableStaging": true,
							"stagingSettings": {
								"linkedServiceName": {
									"referenceName": "AzureBlobStorage1",
									"type": "LinkedServiceReference"
								},
								"path": "pfviewsoracle",
								"enableCompression": true
							},
							"parallelCopies": 8,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "VPD_ID",
											"type": "Decimal"
										},
										"sink": {
											"name": "VPD_ID",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "CLUB_NUMBER_I",
											"type": "Double"
										},
										"sink": {
											"name": "CLUB_NUMBER_I",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "SPL_ABC_ID",
											"type": "String"
										},
										"sink": {
											"name": "SPL_ABC_ID",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "A_AGREEMENT_NUMBER",
											"type": "String"
										},
										"sink": {
											"name": "A_AGREEMENT_NUMBER",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "APM_NAME",
											"type": "String"
										},
										"sink": {
											"name": "APM_NAME",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "A_OLDEST_NEXT_DUE_DATE",
											"type": "DateTime"
										},
										"sink": {
											"name": "A_OLDEST_NEXT_DUE_DATE",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "DATE_DUE_START",
											"type": "DateTime"
										},
										"sink": {
											"name": "DATE_DUE_START",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "DATE_DUE_END",
											"type": "DateTime"
										},
										"sink": {
											"name": "DATE_DUE_END",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "NUMBER_OF_MONTHS",
											"type": "Double"
										},
										"sink": {
											"name": "NUMBER_OF_MONTHS",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "AMOUNT",
											"type": "Double"
										},
										"sink": {
											"name": "AMOUNT",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "M_NAME_LAST",
											"type": "String"
										},
										"sink": {
											"name": "M_NAME_LAST",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "M_NAME_FIRST",
											"type": "String"
										},
										"sink": {
											"name": "M_NAME_FIRST",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "M_PHONE_HOME",
											"type": "String"
										},
										"sink": {
											"name": "M_PHONE_HOME",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "M_PHONE_CELL",
											"type": "String"
										},
										"sink": {
											"name": "M_PHONE_CELL",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "M_EMAIL",
											"type": "String"
										},
										"sink": {
											"name": "M_EMAIL",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "A_DATE_JOINED",
											"type": "DateTime"
										},
										"sink": {
											"name": "A_DATE_JOINED",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "A_EFFECTIVITY_DATE",
											"type": "DateTime"
										},
										"sink": {
											"name": "A_EFFECTIVITY_DATE",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "ATL_ABC_ID",
											"type": "String"
										},
										"sink": {
											"name": "ATL_ABC_ID",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PROFIT_CENTER",
											"type": "String"
										},
										"sink": {
											"name": "PROFIT_CENTER",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "NEXT_DUE_DATE_INT",
											"type": "Double"
										},
										"sink": {
											"name": "NEXT_DUE_DATE_INT",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "REVERSAL_REASON",
											"type": "String"
										},
										"sink": {
											"name": "REVERSAL_REASON",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "INSERT_TIMESTAMP",
											"type": "DateTime"
										},
										"sink": {
											"name": "INSERT_TIMESTAMP",
											"type": "DateTime"
										}
									}
								]
							}
						},
						"inputs": [
							{
								"referenceName": "SRC_PF_SOFT_DECLINES_VW",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "SNK_SYN_PF_SOFT_DECLINES",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Truncate table Sink",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Check Did Job Success",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "TRUNCATE TABLE [PF].[SOFT_DECLINES];\nselect 1;",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "SNK_SYN_PF_SOFT_DECLINES",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": true
						}
					},
					{
						"name": "Get Job Status",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "select 1\nfrom [dbo].[PF_VIEWS_JOBS_CHECK] \nwhere finish_time = cast(GETDATE() AT TIME ZONE 'UTC' AT TIME ZONE 'Eastern Standard Time' AS DATE) \nand FBI_JOB_NAME= 'PF.EFT_ALLOCATIONS_PR' and job_completed=1",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "SNK_DBO_PF_VIEWS_JOBS_CHECK",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "check Oracle Job",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Get Job Status",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "OracleSource",
								"oracleReaderQuery": "select JOB_NAME,START_TIME,FINISH_TIME,STATUS, 'PF.EFT_ALLOCATIONS_PR' as FBI_JOB_NAME \r\nfrom dw.job_monitoring_vw \r\nwhere job_name = 'PF.EFT_ALLOCATIONS_PR' and status = 'SUCCESS' and to_date(finish_time,'YYYY/MM/DD HH24:MI:SS') > trunc(sysdate)",
								"partitionOption": "None",
								"queryTimeout": "02:00:00"
							},
							"dataset": {
								"referenceName": "OracleTable1",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Check Did Job Success",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "check Oracle Job",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "select count(*) from pf_views_jobs_check \nwhere job_name = 'PF.EFT_ALLOCATIONS_PR' and \n    status = 'SUCCESS' and cast(finish_time as date)=cast(GETDATE() AT TIME ZONE 'UTC' AT TIME ZONE 'Eastern Standard Time' AS DATE)\n    and FBI_JOB_NAME='PF.EFT_ALLOCATIONS_PR'",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "SNK_DBO_PF_VIEWS_JOBS_CHECK",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Update Job Status",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Copy data1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "UPDATE [PF].[SOFT_DECLINES]\nSET AS_OF = GETDATE();\nSELECT 1\n",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "SNK_DBO_PF_VIEWS_JOBS_CHECK",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"folder": {
					"name": "EDW_PF_SQL_POOL"
				},
				"annotations": [],
				"lastPublishTime": "2023-02-23T16:21:18Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/POSPAYMENTITEMS_SQLPOOL')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "ForEach1",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "Lookup1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('Lookup1').output.value",
								"type": "Expression"
							},
							"isSequential": false,
							"activities": [
								{
									"name": "POSPAYMENTITEMS_SQLPOOL",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [
										{
											"name": "Source",
											"value": "."
										},
										{
											"name": "Destination",
											"value": "StgDatatrak.STG_POSPAYMENTITEMS_INCR"
										}
									],
									"typeProperties": {
										"source": {
											"type": "OracleSource",
											"oracleReaderQuery": {
												"value": "select * from BETADATA.POSPAYMENTITEMS\nwhere PPMTI_CREATED >= TO_DATE('@{formatDateTime(pipeline().parameters.windowStart, 'yyyy-MM-dd HH:mm' )}', 'YYYY-MM-DD HH24:MI') \nAND PPMTI_CREATED < TO_DATE('@{formatDateTime(pipeline().parameters.windowEnd, 'yyyy-MM-dd HH:mm' )}', 'YYYY-MM-DD HH24:MI')\nAND VPD_ID in @{item().vpd_list}",
												"type": "Expression"
											},
											"partitionOption": "None"
										},
										"sink": {
											"type": "SqlDWSink",
											"allowPolyBase": true,
											"polyBaseSettings": {
												"rejectValue": 0,
												"rejectType": "value",
												"useTypeDefault": false
											}
										},
										"enableStaging": true,
										"stagingSettings": {
											"linkedServiceName": {
												"referenceName": "AzureBlobStorage1",
												"type": "LinkedServiceReference"
											},
											"path": "vifiles"
										},
										"parallelCopies": 32,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "VPD_ID",
														"type": "Decimal"
													},
													"sink": {
														"name": "VPD_ID",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "PPMT_ID",
														"type": "String"
													},
													"sink": {
														"name": "PPMT_ID",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "POSI_ID",
														"type": "String"
													},
													"sink": {
														"name": "POSI_ID",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "PPMTI_AMOUNT",
														"type": "Decimal"
													},
													"sink": {
														"name": "PPMTI_AMOUNT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "PPMTI_AMOUNT_TAX",
														"type": "Decimal"
													},
													"sink": {
														"name": "PPMTI_AMOUNT_TAX",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "PPMTI_CREATED",
														"type": "DateTime"
													},
													"sink": {
														"name": "PPMTI_CREATED",
														"type": "DateTime"
													}
												}
											]
										}
									},
									"inputs": [
										{
											"referenceName": "SRC_BETADATA_POSPAYMENTITEMS",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "SNK_SYN_DT_POSPAYMENTITEMS_INCR",
											"type": "DatasetReference",
											"parameters": {}
										}
									]
								}
							]
						}
					},
					{
						"name": "Lookup1",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Truncate incr table",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderStoredProcedureName": "[[abcpi].[GetVPDToLoad]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "AzureSynapseAnalyticsDB",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": false
						}
					},
					{
						"name": "Truncate incr table",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "truncate table StgDatatrak.stg_pospaymentitems_incr;\nselect 0;",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "AzureSynapseAnalyticsDB",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Merge to Staging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "ForEach1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[StgDatatrak].[STG_POSPAYMENTITEMS_MERGE]"
						},
						"linkedServiceName": {
							"referenceName": "AzureSynapseAnalytics1",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"windowStart": {
						"type": "String"
					},
					"windowEnd": {
						"type": "String"
					}
				},
				"folder": {
					"name": "Oracle_SQLPOOL/Oracle_SQL_POOL_Group3"
				},
				"annotations": [],
				"lastPublishTime": "2023-02-08T11:25:31Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/POSPAYMENTS_SQLPOOL')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Pospayments",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "Lookup1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('Lookup1').output.value",
								"type": "Expression"
							},
							"isSequential": false,
							"activities": [
								{
									"name": "POSPAYMENTS_SQLPOOL",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [
										{
											"name": "Source",
											"value": "."
										},
										{
											"name": "Destination",
											"value": "StgDatatrak.STG_POSPAYMENTS_INCR"
										}
									],
									"typeProperties": {
										"source": {
											"type": "OracleSource",
											"oracleReaderQuery": {
												"value": "select  /*+INDEX(t,POSPAYMENTS_MODIFIED) */ * from BETADATA.POSPAYMENTS t\nwhere PPMT_MODIFIED >= TO_DATE('@{formatDateTime(pipeline().parameters.windowStart, 'yyyy-MM-dd HH:mm' )}', 'YYYY-MM-DD HH24:MI') \nAND PPMT_MODIFIED < TO_DATE('@{formatDateTime(pipeline().parameters.windowEnd, 'yyyy-MM-dd HH:mm' )}', 'YYYY-MM-DD HH24:MI')\nAND VPD_ID in @{item().vpd_list}",
												"type": "Expression"
											},
											"partitionOption": "None"
										},
										"sink": {
											"type": "SqlDWSink",
											"allowPolyBase": true,
											"polyBaseSettings": {
												"rejectValue": 0,
												"rejectType": "value",
												"useTypeDefault": false
											}
										},
										"enableStaging": true,
										"stagingSettings": {
											"linkedServiceName": {
												"referenceName": "AzureBlobStorage1",
												"type": "LinkedServiceReference"
											},
											"path": "vifiles"
										},
										"parallelCopies": 32,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "VPD_ID",
														"type": "Decimal"
													},
													"sink": {
														"name": "VPD_ID",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "PPMT_ID",
														"type": "String"
													},
													"sink": {
														"name": "PPMT_ID",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "PPMT_CREATED",
														"type": "DateTime"
													},
													"sink": {
														"name": "PPMT_CREATED",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"name": "PPMT_MODIFIED",
														"type": "DateTime"
													},
													"sink": {
														"name": "PPMT_MODIFIED",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"name": "PPMT_SEQUENCE",
														"type": "Decimal"
													},
													"sink": {
														"name": "PPMT_SEQUENCE",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "PPMT_AMOUNT",
														"type": "Decimal"
													},
													"sink": {
														"name": "PPMT_AMOUNT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "PPMT_ABC_COLLECTED",
														"type": "String"
													},
													"sink": {
														"name": "PPMT_ABC_COLLECTED",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "PPMT_DRAFT_DATE",
														"type": "DateTime"
													},
													"sink": {
														"name": "PPMT_DRAFT_DATE",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"name": "PPMT_REFERENCE_LABEL",
														"type": "String"
													},
													"sink": {
														"name": "PPMT_REFERENCE_LABEL",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "PPMT_REFERENCE",
														"type": "String"
													},
													"sink": {
														"name": "PPMT_REFERENCE",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "PPMT_INCOME",
														"type": "String"
													},
													"sink": {
														"name": "PPMT_INCOME",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "PPMT_NAME",
														"type": "String"
													},
													"sink": {
														"name": "PPMT_NAME",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "PPMT_DESCRIPTION",
														"type": "String"
													},
													"sink": {
														"name": "PPMT_DESCRIPTION",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "BH_ID",
														"type": "String"
													},
													"sink": {
														"name": "BH_ID",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "PPT_ID",
														"type": "String"
													},
													"sink": {
														"name": "PPT_ID",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "POS_ID",
														"type": "String"
													},
													"sink": {
														"name": "POS_ID",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "PPMT_AUTO_BILL",
														"type": "String"
													},
													"sink": {
														"name": "PPMT_AUTO_BILL",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "PFREQ_ID",
														"type": "String"
													},
													"sink": {
														"name": "PFREQ_ID",
														"type": "String"
													}
												}
											]
										}
									},
									"inputs": [
										{
											"referenceName": "SRC_BETADATA_POSPAYMENTS",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "SNK_SYN_DT_POSPAYMENTS_INCR",
											"type": "DatasetReference",
											"parameters": {}
										}
									]
								}
							]
						}
					},
					{
						"name": "Lookup1",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Truncate incr table",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderStoredProcedureName": "[[abcpi].[GetVPDToLoad]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "AzureSynapseAnalyticsDB",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": false
						}
					},
					{
						"name": "Truncate incr table",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "truncate table StgDatatrak.stg_pospayments_incr;\nselect 0;",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "AzureSynapseAnalyticsDB",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Merge to Staging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Pospayments",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[StgDatatrak].[STG_POSPAYMENTS_MERGE]"
						},
						"linkedServiceName": {
							"referenceName": "AzureSynapseAnalytics1",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"windowStart": {
						"type": "String"
					},
					"windowEnd": {
						"type": "String"
					}
				},
				"folder": {
					"name": "Oracle_SQLPOOL/Oracle_SQL_POOL_Group3"
				},
				"annotations": [],
				"lastPublishTime": "2023-02-08T11:25:31Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/PaymentFields_SQLPOOL')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "ForEach1",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "Lookup1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('Lookup1').output.value",
								"type": "Expression"
							},
							"isSequential": false,
							"activities": [
								{
									"name": "PaymentFields",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "OracleSource",
											"oracleReaderQuery": {
												"value": "select * from BETADATA.PAYMENTFIELDS t\nwhere PF_MODIFIED>= TO_DATE('@{formatDateTime(pipeline().parameters.windowStart, 'yyyy-MM-dd HH:mm' )}', 'YYYY-MM-DD HH24:MI') \nAND PF_MODIFIED< TO_DATE('@{formatDateTime(pipeline().parameters.windowEnd, 'yyyy-MM-dd HH:mm' )}', 'YYYY-MM-DD HH24:MI')\nAND VPD_ID in @{item().vpd_list}",
												"type": "Expression"
											},
											"partitionOption": "None",
											"convertDecimalToInteger": false
										},
										"sink": {
											"type": "SqlDWSink",
											"allowPolyBase": true,
											"polyBaseSettings": {
												"rejectValue": 0,
												"rejectType": "value",
												"useTypeDefault": false
											}
										},
										"enableStaging": true,
										"stagingSettings": {
											"linkedServiceName": {
												"referenceName": "AzureBlobStorage1",
												"type": "LinkedServiceReference"
											},
											"path": "vifiles"
										},
										"parallelCopies": 32,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "VPD_ID",
														"type": "Decimal"
													},
													"sink": {
														"name": "VPD_ID",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "PF_ID",
														"type": "String"
													},
													"sink": {
														"name": "PF_ID",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "PF_CREATED",
														"type": "DateTime"
													},
													"sink": {
														"name": "PF_CREATED",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"name": "PF_MODIFIED",
														"type": "DateTime"
													},
													"sink": {
														"name": "PF_MODIFIED",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"name": "PF_ACTIVE",
														"type": "String"
													},
													"sink": {
														"name": "PF_ACTIVE",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "PF_NAME",
														"type": "String"
													},
													"sink": {
														"name": "PF_NAME",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "PF_ABC_CODE",
														"type": "String"
													},
													"sink": {
														"name": "PF_ABC_CODE",
														"type": "String"
													}
												}
											]
										}
									},
									"inputs": [
										{
											"referenceName": "SRC_BETADATA",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "SNK_SYN_DT_STG_PAYMENTFIELDS_INCR",
											"type": "DatasetReference",
											"parameters": {}
										}
									]
								}
							]
						}
					},
					{
						"name": "Lookup1",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Truncate Incr table",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderStoredProcedureName": "[[abcpi].[GetVPDToLoad]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "AzureSynapseAnalyticsDB",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": false
						}
					},
					{
						"name": "Truncate Incr table",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "truncate table StgDatatrak.STG_PAYMENTFIELDS_INCR;\nselect 0;",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "AzureSynapseAnalyticsDB",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": false
						}
					},
					{
						"name": "Merge to Staging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "ForEach1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[StgDatatrak].[STG_PAYMENTFIELDS_MERGE]"
						},
						"linkedServiceName": {
							"referenceName": "AzureSynapseAnalytics1",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"windowStart": {
						"type": "String"
					},
					"windowEnd": {
						"type": "String"
					}
				},
				"folder": {
					"name": "Oracle_SQLPOOL/Oracle_SQL_POOL_Group5"
				},
				"annotations": [],
				"lastPublishTime": "2023-02-08T11:25:31Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/PosCommissions_SQLPOOL')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "PosCommission",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "Lookup1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('Lookup1').output.value",
								"type": "Expression"
							},
							"isSequential": false,
							"activities": [
								{
									"name": "POSCOMMISSIONS",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [
										{
											"name": "Source",
											"value": "BETADATA.POSCOMMISSIONS"
										},
										{
											"name": "Destination",
											"value": "ABCPI.STG_STG_POSCOMMISSIONS_INCR"
										}
									],
									"typeProperties": {
										"source": {
											"type": "OracleSource",
											"oracleReaderQuery": {
												"value": "select  /*+INDEX(t,POSC_CREATED_LOCAL)*/ * \nfrom BETADATA.POSCOMMISSIONS t\nwhere t.POSC_CREATED_LOCAL >= TO_DATE('@{formatDateTime(pipeline().parameters.windowStart, 'yyyy-MM-dd HH:mm' )}', 'YYYY-MM-DD HH24:MI') \nAND t.POSC_CREATED_LOCAL < TO_DATE('@{formatDateTime(pipeline().parameters.windowEnd, 'yyyy-MM-dd HH:mm' )}', 'YYYY-MM-DD HH24:MI')\nAND VPD_ID in @{item().vpd_list}",
												"type": "Expression"
											},
											"partitionOption": "None"
										},
										"sink": {
											"type": "SqlDWSink",
											"allowPolyBase": true,
											"polyBaseSettings": {
												"rejectValue": 0,
												"rejectType": "value",
												"useTypeDefault": false
											}
										},
										"enableStaging": true,
										"stagingSettings": {
											"linkedServiceName": {
												"referenceName": "AzureBlobStorage1",
												"type": "LinkedServiceReference"
											},
											"path": "vifiles"
										},
										"parallelCopies": 32,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "VPD_ID",
														"type": "Decimal"
													},
													"sink": {
														"name": "VPD_ID",
														"type": "Int32"
													}
												},
												{
													"source": {
														"name": "POSC_ID",
														"type": "String"
													},
													"sink": {
														"name": "POSC_ID",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "POSC_LEVEL",
														"type": "Decimal"
													},
													"sink": {
														"name": "POSC_LEVEL",
														"type": "Int16"
													}
												},
												{
													"source": {
														"name": "POSC_AMOUNT_CALC",
														"type": "Decimal"
													},
													"sink": {
														"name": "POSC_AMOUNT_CALC",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "POSC_AMOUNT",
														"type": "Decimal"
													},
													"sink": {
														"name": "POSC_AMOUNT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "POSC_PERCENTAGE",
														"type": "Decimal"
													},
													"sink": {
														"name": "POSC_PERCENTAGE",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "POSC_SPLIT_PERCENTAGE",
														"type": "Decimal"
													},
													"sink": {
														"name": "POSC_SPLIT_PERCENTAGE",
														"type": "Int16"
													}
												},
												{
													"source": {
														"name": "E_ID",
														"type": "String"
													},
													"sink": {
														"name": "E_ID",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "POSI_ID",
														"type": "String"
													},
													"sink": {
														"name": "POSI_ID",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "POSC_CREATED",
														"type": "DateTime"
													},
													"sink": {
														"name": "POSC_CREATED",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"name": "POSC_ACTIVE",
														"type": "String"
													},
													"sink": {
														"name": "POSC_ACTIVE",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "E_ID_CREATED",
														"type": "String"
													},
													"sink": {
														"name": "E_ID_CREATED",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "POSC_NOTE",
														"type": "String"
													},
													"sink": {
														"name": "POSC_NOTE",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "POSC_SEQUENCE",
														"type": "Decimal"
													},
													"sink": {
														"name": "POSC_SEQUENCE",
														"type": "Int32"
													}
												},
												{
													"source": {
														"name": "POSC_VALUE_OVERRIDE",
														"type": "String"
													},
													"sink": {
														"name": "POSC_VALUE_OVERRIDE",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "CLGRR_ID",
														"type": "String"
													},
													"sink": {
														"name": "CLGRR_ID",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "POSC_CREATED_LOCAL",
														"type": "DateTime"
													},
													"sink": {
														"name": "POSC_CREATED_LOCAL",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"name": "TZL_ID_CREATED_LOCAL",
														"type": "String"
													},
													"sink": {
														"name": "TZL_ID_CREATED_LOCAL",
														"type": "String"
													}
												}
											]
										}
									},
									"inputs": [
										{
											"referenceName": "OracleTable2",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "SNK_SYN_DT_STG_POSCOMMISSIONS_INCR",
											"type": "DatasetReference",
											"parameters": {}
										}
									]
								}
							]
						}
					},
					{
						"name": "Lookup1",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Truncate incr table",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderStoredProcedureName": "[[abcpi].[GetVPDToLoad]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "AzureSynapseAnalyticsDB",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": false
						}
					},
					{
						"name": "Truncate incr table",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "truncate table StgDatatrak.STG_POSCOMMISSIONS_INCR;\nselect 0;",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "AzureSynapseAnalyticsDB",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Merge to Staging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "PosCommission",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[StgDatatrak].[STG_POSCOMMISSIONS_MERGE]"
						},
						"linkedServiceName": {
							"referenceName": "AzureSynapseAnalytics1",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"windowStart": {
						"type": "String"
					},
					"windowEnd": {
						"type": "String"
					}
				},
				"folder": {
					"name": "Oracle_SQLPOOL/Oracle_SQL_POOL_Group4"
				},
				"annotations": [],
				"lastPublishTime": "2023-02-08T11:25:24Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/PosaccountPaymentHistory_SQLPOOL')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "ForEach1",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "Lookup1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('Lookup1').output.value",
								"type": "Expression"
							},
							"isSequential": false,
							"activities": [
								{
									"name": "POSACCOUNTPAYMENTHISTORY",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "OracleSource",
											"oracleReaderQuery": {
												"value": "select   /*+INDEX(t,POSPMTHIST_MODIFIED ASC)*/ *\nfrom BETADATA.POSACCOUNTPAYMENTHISTORY t\nwhere t.PAPMTH_MODIFIED\n >= TO_DATE('@{formatDateTime(pipeline().parameters.windowStart, 'yyyy-MM-dd HH:mm' )}', 'YYYY-MM-DD HH24:MI') \nAND t.PAPMTH_MODIFIED  < TO_DATE('@{formatDateTime(pipeline().parameters.windowEnd, 'yyyy-MM-dd HH:mm' )}', 'YYYY-MM-DD HH24:MI')\nAND t.VPD_ID in @{item().vpd_list}\n",
												"type": "Expression"
											},
											"partitionOption": "None",
											"convertDecimalToInteger": false
										},
										"sink": {
											"type": "SqlDWSink",
											"allowPolyBase": true,
											"polyBaseSettings": {
												"rejectValue": 0,
												"rejectType": "value",
												"useTypeDefault": false
											}
										},
										"enableStaging": true,
										"stagingSettings": {
											"linkedServiceName": {
												"referenceName": "AzureBlobStorage1",
												"type": "LinkedServiceReference"
											},
											"path": "vifiles"
										},
										"parallelCopies": 32,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "VPD_ID",
														"type": "Decimal"
													},
													"sink": {
														"name": "VPD_ID",
														"type": "Int32"
													}
												},
												{
													"source": {
														"name": "PAPMTH_ID",
														"type": "String"
													},
													"sink": {
														"name": "PAPMTH_ID",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "PAPMTH_CREATED",
														"type": "DateTime"
													},
													"sink": {
														"name": "PAPMTH_CREATED",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"name": "PAPMTH_MODIFIED",
														"type": "DateTime"
													},
													"sink": {
														"name": "PAPMTH_MODIFIED",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"name": "PAPMTH_AMOUNT",
														"type": "Decimal"
													},
													"sink": {
														"name": "PAPMTH_AMOUNT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "PAPMTH_DESCRIPTION",
														"type": "String"
													},
													"sink": {
														"name": "PAPMTH_DESCRIPTION",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "PAPMTH_PAYMENT_CODE",
														"type": "String"
													},
													"sink": {
														"name": "PAPMTH_PAYMENT_CODE",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "PAPMT_ID",
														"type": "String"
													},
													"sink": {
														"name": "PAPMT_ID",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "POS_ID",
														"type": "String"
													},
													"sink": {
														"name": "POS_ID",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "BH_ID",
														"type": "String"
													},
													"sink": {
														"name": "BH_ID",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "CAPM_ID",
														"type": "String"
													},
													"sink": {
														"name": "CAPM_ID",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "PAPHT_ID",
														"type": "String"
													},
													"sink": {
														"name": "PAPHT_ID",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "PAPMTH_SUBMISSION_STATUS",
														"type": "String"
													},
													"sink": {
														"name": "PAPMTH_SUBMISSION_STATUS",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "AI_ID",
														"type": "String"
													},
													"sink": {
														"name": "AI_ID",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "PAPMTH_TRANSACTION_DATE_LOCAL",
														"type": "DateTime"
													},
													"sink": {
														"name": "PAPMTH_TRANSACTION_DATE_LOCAL",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"name": "PAPMTH_PAYMENT_SEQUENCE",
														"type": "String"
													},
													"sink": {
														"name": "PAPMTH_PAYMENT_SEQUENCE",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "PAYSRC_ID",
														"type": "String"
													},
													"sink": {
														"name": "PAYSRC_ID",
														"type": "String"
													}
												}
											]
										}
									},
									"inputs": [
										{
											"referenceName": "OracleTable2",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "SNK_SYN_DT_STG_POSACCOUNTPAYMENTHISTORY_INCR",
											"type": "DatasetReference",
											"parameters": {}
										}
									]
								}
							]
						}
					},
					{
						"name": "Lookup1",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Truncate incr table",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderStoredProcedureName": "[[abcpi].[GetVPDToLoad]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "AzureSynapseAnalyticsDB",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": false
						}
					},
					{
						"name": "Truncate incr table",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "truncate table StgDatatrak.STG_POSACCOUNTPAYMENTHISTORY_INCR;\nselect 0;",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "AzureSynapseAnalyticsDB",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Merge to Staging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "ForEach1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[StgDatatrak].[STG_POSACCOUNTPAYMENTHISTORY_MERGE]"
						},
						"linkedServiceName": {
							"referenceName": "AzureSynapseAnalytics1",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"windowStart": {
						"type": "String"
					},
					"windowEnd": {
						"type": "String"
					}
				},
				"folder": {
					"name": "Oracle_SQLPOOL/Oracle_SQL_POOL_Group3"
				},
				"annotations": [],
				"lastPublishTime": "2023-02-08T11:25:30Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/PosaccountPaymentsDateDue_SQLPOOL')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "ForEach1",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "Lookup1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('Lookup1').output.value",
								"type": "Expression"
							},
							"isSequential": false,
							"activities": [
								{
									"name": "POSACCOUNTPAYMENTSDATEDUE",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "OracleSource",
											"oracleReaderQuery": {
												"value": "select   /*+INDEX(t,PAPMTDD_CREATED ASC)*/ *\nfrom BETADATA.POSACCOUNTPAYMENTSDATEDUE t\nwhere t.PAPMTDD_CREATED\n >= TO_DATE('@{formatDateTime(pipeline().parameters.windowStart, 'yyyy-MM-dd HH:mm' )}', 'YYYY-MM-DD HH24:MI') \nAND t.PAPMTDD_CREATED  < TO_DATE('@{formatDateTime(pipeline().parameters.windowEnd, 'yyyy-MM-dd HH:mm' )}', 'YYYY-MM-DD HH24:MI')\nAND t.VPD_ID in @{item().vpd_list}",
												"type": "Expression"
											},
											"partitionOption": "None",
											"convertDecimalToInteger": false
										},
										"sink": {
											"type": "SqlDWSink",
											"allowPolyBase": true,
											"polyBaseSettings": {
												"rejectValue": 0,
												"rejectType": "value",
												"useTypeDefault": false
											}
										},
										"enableStaging": true,
										"stagingSettings": {
											"linkedServiceName": {
												"referenceName": "AzureBlobStorage1",
												"type": "LinkedServiceReference"
											},
											"path": "vifiles"
										},
										"parallelCopies": 32,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "VPD_ID",
														"type": "Decimal"
													},
													"sink": {
														"name": "VPD_ID",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "PAPMTDD_ID",
														"type": "String"
													},
													"sink": {
														"name": "PAPMTDD_ID",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "PAPMTDD_CREATED",
														"type": "DateTime"
													},
													"sink": {
														"name": "PAPMTDD_CREATED",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"name": "PAPMT_ID",
														"type": "String"
													},
													"sink": {
														"name": "PAPMT_ID",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "PAPMTDD_DATE_DUE",
														"type": "DateTime"
													},
													"sink": {
														"name": "PAPMTDD_DATE_DUE",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"name": "PAPMTDD_DATE_DUE_NEW",
														"type": "DateTime"
													},
													"sink": {
														"name": "PAPMTDD_DATE_DUE_NEW",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"name": "PAPMTDD_AMOUNT_PAID",
														"type": "Decimal"
													},
													"sink": {
														"name": "PAPMTDD_AMOUNT_PAID",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "U_ID_AUDIT",
														"type": "String"
													},
													"sink": {
														"name": "U_ID_AUDIT",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "U_ID_OVERRIDE",
														"type": "String"
													},
													"sink": {
														"name": "U_ID_OVERRIDE",
														"type": "String"
													}
												}
											]
										}
									},
									"inputs": [
										{
											"referenceName": "OracleTable2",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "SNK_SYN_DT_STG_POSACCOUNTPAYMENTSDATEDUE_INCR",
											"type": "DatasetReference",
											"parameters": {}
										}
									]
								}
							]
						}
					},
					{
						"name": "Lookup1",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Truncate incr table",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderStoredProcedureName": "[[abcpi].[GetVPDToLoad]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "AzureSynapseAnalyticsDB",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": false
						}
					},
					{
						"name": "Truncate incr table",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "truncate table StgDatatrak.STG_POSACCOUNTPAYMENTSDATEDUE_INCR;\nselect 0;",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "AzureSynapseAnalyticsDB",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Merge to Staging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "ForEach1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[StgDatatrak].[Stg_PosAccountPaymentsDateDue_Merge]"
						},
						"linkedServiceName": {
							"referenceName": "AzureSynapseAnalytics1",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"windowStart": {
						"type": "String"
					},
					"windowEnd": {
						"type": "String"
					}
				},
				"folder": {
					"name": "Oracle_SQLPOOL/Oracle_SQL_POOL_Group5"
				},
				"annotations": [],
				"lastPublishTime": "2023-02-08T11:25:30Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/PosaccountPayments_SQLPOOL')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "ForEach1",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "Lookup1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('Lookup1').output.value",
								"type": "Expression"
							},
							"isSequential": false,
							"activities": [
								{
									"name": "POSACCOUNTPAYMENTS",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "OracleSource",
											"oracleReaderQuery": {
												"value": "select   /*+INDEX(t,POSACCTPMTS_MODIFIED ASC)*/ *\nfrom BETADATA.POSACCOUNTPAYMENTS t\nwhere t.PAPMT_MODIFIED\n >= TO_DATE('@{formatDateTime(pipeline().parameters.windowStart, 'yyyy-MM-dd HH:mm' )}', 'YYYY-MM-DD HH24:MI') \nAND t.PAPMT_MODIFIED  < TO_DATE('@{formatDateTime(pipeline().parameters.windowEnd, 'yyyy-MM-dd HH:mm' )}', 'YYYY-MM-DD HH24:MI')\nAND t.VPD_ID in @{item().vpd_list}",
												"type": "Expression"
											},
											"partitionOption": "None",
											"convertDecimalToInteger": false
										},
										"sink": {
											"type": "SqlDWSink",
											"allowPolyBase": true,
											"polyBaseSettings": {
												"rejectValue": 0,
												"rejectType": "value",
												"useTypeDefault": false
											}
										},
										"enableStaging": true,
										"stagingSettings": {
											"linkedServiceName": {
												"referenceName": "AzureBlobStorage1",
												"type": "LinkedServiceReference"
											},
											"path": "vifiles"
										},
										"parallelCopies": 32,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "VPD_ID",
														"type": "Decimal"
													},
													"sink": {
														"name": "VPD_ID",
														"type": "Int32"
													}
												},
												{
													"source": {
														"name": "PAPMT_ID",
														"type": "String"
													},
													"sink": {
														"name": "PAPMT_ID",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "PAPMT_CREATED",
														"type": "DateTime"
													},
													"sink": {
														"name": "PAPMT_CREATED",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"name": "PAPMT_MODIFIED",
														"type": "DateTime"
													},
													"sink": {
														"name": "PAPMT_MODIFIED",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"name": "PAPMT_DATE_DUE",
														"type": "DateTime"
													},
													"sink": {
														"name": "PAPMT_DATE_DUE",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"name": "PAPMT_AMOUNT",
														"type": "Decimal"
													},
													"sink": {
														"name": "PAPMT_AMOUNT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "PAPMT_AMOUNT_PAID",
														"type": "Decimal"
													},
													"sink": {
														"name": "PAPMT_AMOUNT_PAID",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "PAPMT_AMOUNT_PENDING_ABC",
														"type": "Decimal"
													},
													"sink": {
														"name": "PAPMT_AMOUNT_PENDING_ABC",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "PPMT_ID",
														"type": "String"
													},
													"sink": {
														"name": "PPMT_ID",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "PAPMT_HOLD",
														"type": "String"
													},
													"sink": {
														"name": "PAPMT_HOLD",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "PAPMT_RETURN_PENDING",
														"type": "Decimal"
													},
													"sink": {
														"name": "PAPMT_RETURN_PENDING",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "PAPMT_RETURN_PENDING_ABC",
														"type": "Decimal"
													},
													"sink": {
														"name": "PAPMT_RETURN_PENDING_ABC",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "M_ID",
														"type": "String"
													},
													"sink": {
														"name": "M_ID",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "PAPMT_VOID",
														"type": "String"
													},
													"sink": {
														"name": "PAPMT_VOID",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "CONTE_ID_PAID",
														"type": "String"
													},
													"sink": {
														"name": "CONTE_ID_PAID",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "PCHAN_ID",
														"type": "String"
													},
													"sink": {
														"name": "PCHAN_ID",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "PAPMT_AMOUNT_SCHEDULED",
														"type": "Decimal"
													},
													"sink": {
														"name": "PAPMT_AMOUNT_SCHEDULED",
														"type": "Decimal"
													}
												}
											]
										}
									},
									"inputs": [
										{
											"referenceName": "OracleTable2",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "SNK_SYN_DT_STG_POSACCOUNTPAYMENTS_INCR",
											"type": "DatasetReference",
											"parameters": {}
										}
									]
								}
							]
						}
					},
					{
						"name": "Lookup1",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Truncate incr table",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderStoredProcedureName": "[[abcpi].[GetVPDToLoad]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "AzureSynapseAnalyticsDB",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": false
						}
					},
					{
						"name": "Truncate incr table",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "truncate table StgDatatrak.STG_POSACCOUNTPAYMENTS_INCR;\nselect 0;",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "AzureSynapseAnalyticsDB",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Merge to Staging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "ForEach1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[StgDatatrak].[STG_POSACCOUNTPAYMENTS_MERGE]"
						},
						"linkedServiceName": {
							"referenceName": "AzureSynapseAnalytics1",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"windowStart": {
						"type": "String"
					},
					"windowEnd": {
						"type": "String"
					}
				},
				"folder": {
					"name": "Oracle_SQLPOOL/Oracle_SQL_POOL_Group3"
				},
				"annotations": [],
				"lastPublishTime": "2023-02-08T11:25:30Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/PospaymentTypes_SQLPOOL')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "PospaymentsTypes",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "Lookup1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('Lookup1').output.value",
								"type": "Expression"
							},
							"isSequential": false,
							"activities": [
								{
									"name": "POSPAYMENTTYPES",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [
										{
											"name": "Source",
											"value": "BETADATA.POSPAYMENTTYPES"
										},
										{
											"name": "Destination",
											"value": "ABCPI.STG_STG_POSPAYMENTTYPES_INCR"
										}
									],
									"typeProperties": {
										"source": {
											"type": "OracleSource",
											"oracleReaderQuery": {
												"value": "select  /*+INDEX(t,PPT_Modified) */ * from BETADATA.POSPAYMENTTYPES t\nwhere PPT_MODIFIED >= TO_DATE('@{formatDateTime(pipeline().parameters.windowStart, 'yyyy-MM-dd HH:mm' )}', 'YYYY-MM-DD HH24:MI') \nAND PPT_MODIFIED < TO_DATE('@{formatDateTime(pipeline().parameters.windowEnd, 'yyyy-MM-dd HH:mm' )}', 'YYYY-MM-DD HH24:MI')\nAND VPD_ID in @{item().vpd_list}",
												"type": "Expression"
											},
											"partitionOption": "None"
										},
										"sink": {
											"type": "SqlDWSink",
											"allowPolyBase": true,
											"polyBaseSettings": {
												"rejectValue": 0,
												"rejectType": "value",
												"useTypeDefault": false
											}
										},
										"enableStaging": true,
										"stagingSettings": {
											"linkedServiceName": {
												"referenceName": "AzureBlobStorage1",
												"type": "LinkedServiceReference"
											},
											"path": "vifiles"
										},
										"parallelCopies": 32,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "VPD_ID",
														"type": "Decimal"
													},
													"sink": {
														"name": "VPD_ID",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "PPT_ID",
														"type": "String"
													},
													"sink": {
														"name": "PPT_ID",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "PPT_CREATED",
														"type": "DateTime"
													},
													"sink": {
														"name": "PPT_CREATED",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"name": "PPT_MODIFIED",
														"type": "DateTime"
													},
													"sink": {
														"name": "PPT_MODIFIED",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"name": "PPT_ACTIVE",
														"type": "String"
													},
													"sink": {
														"name": "PPT_ACTIVE",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "PPT_NAME",
														"type": "String"
													},
													"sink": {
														"name": "PPT_NAME",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "PPT_ABC_CODE",
														"type": "String"
													},
													"sink": {
														"name": "PPT_ABC_CODE",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "PPT_REFERENCE_LABEL",
														"type": "String"
													},
													"sink": {
														"name": "PPT_REFERENCE_LABEL",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "PPT_COUNT",
														"type": "String"
													},
													"sink": {
														"name": "PPT_COUNT",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "PPT_INCOME",
														"type": "String"
													},
													"sink": {
														"name": "PPT_INCOME",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "PPT_ALLOW_MULTIPLE",
														"type": "String"
													},
													"sink": {
														"name": "PPT_ALLOW_MULTIPLE",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "PPT_ALLOW_CHANGE",
														"type": "String"
													},
													"sink": {
														"name": "PPT_ALLOW_CHANGE",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "PPT_ALLOW_NEGATIVE_DRAWER",
														"type": "String"
													},
													"sink": {
														"name": "PPT_ALLOW_NEGATIVE_DRAWER",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "PPT_SPECIAL",
														"type": "String"
													},
													"sink": {
														"name": "PPT_SPECIAL",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "PPT_MEMBER_REQUIRED",
														"type": "String"
													},
													"sink": {
														"name": "PPT_MEMBER_REQUIRED",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "PPT_SORT_ORDER",
														"type": "Decimal"
													},
													"sink": {
														"name": "PPT_SORT_ORDER",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "PPT_RECEIPT_COUNT",
														"type": "Decimal"
													},
													"sink": {
														"name": "PPT_RECEIPT_COUNT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "PPT_SIGNATURE_LINE",
														"type": "String"
													},
													"sink": {
														"name": "PPT_SIGNATURE_LINE",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "PPT_MODIFIED_DW",
														"type": "DateTime"
													},
													"sink": {
														"name": "PPT_MODIFIED_DW",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"name": "PPT_POS_HIDE",
														"type": "String"
													},
													"sink": {
														"name": "PPT_POS_HIDE",
														"type": "String"
													}
												}
											]
										}
									},
									"inputs": [
										{
											"referenceName": "OracleTable2",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "SNK_SYN_DT_STG_POSPAYMENTTYPES_INCR",
											"type": "DatasetReference",
											"parameters": {}
										}
									]
								}
							]
						}
					},
					{
						"name": "Lookup1",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Truncate incr table",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderStoredProcedureName": "[[abcpi].[GetVPDToLoad]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "AzureSynapseAnalyticsDB",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": false
						}
					},
					{
						"name": "Truncate incr table",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderStoredProcedureName": "[[abcpi].[GetVPDToLoad]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "AzureSynapseAnalyticsDB",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Merge to Staging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "PospaymentsTypes",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[StgDatatrak].[STG_POSPAYMENTTYPES_MERGE]"
						},
						"linkedServiceName": {
							"referenceName": "AzureSynapseAnalytics1",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"windowStart": {
						"type": "String"
					},
					"windowEnd": {
						"type": "String"
					}
				},
				"folder": {
					"name": "Oracle_SQLPOOL/Oracle_SQL_POOL_Group4"
				},
				"annotations": [],
				"lastPublishTime": "2023-02-08T11:25:30Z"
			},
			"dependsOn": []
		}
	]
}