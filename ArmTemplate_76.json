{
	"$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
	"contentVersion": "1.0.0.0",
	"parameters": {
		"factoryName": {
			"type": "string",
			"metadata": "Data Factory name",
			"defaultValue": "PlanetFitnessDF"
		}
	},
	"variables": {
		"factoryId": "[concat('Microsoft.DataFactory/factories/', parameters('factoryName'))]"
	},
	"resources": [
		{
			"name": "[concat(parameters('factoryName'), '/SNOWFLAKE_FactMemberUsage')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Move Data from Synapse to Snowflake",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": {
									"value": "select  [MEMBER_USAGE_SID]\n      ,[USAGE_ID]\n      ,[VISITED_CLUB_SID]\n      ,[MEMBER_SID]\n      ,[HOME_CLUB_SID]\n      ,[VISIT_DATE_SID]\n      ,[VISIT_TIME_SID]\n      ,[AMENITY_SID]\n      ,[PROSPECT_SID]\n      ,[VISITED_CLUB_NUMBER_POS]\n      ,[MEMBER_NUMBER]\n      ,[HOME_CLUB_NUMBER_POS]\n      ,[VISIT_DATE_TIME]\n      ,[AMENITY_CODE]\n      ,[MEMBER_NUMBER_UNIQUE]\n      ,[PROSPECT_NUMBER_UNIQUE]\n      ,[REFERRING_MEMBER_SID]\n      ,[CHECK_IN_ALERT_SID]\n      ,[MEMBER_TYPE_SID]\n      ,[OFFER_SID]\n      ,[OFFER_SNK]\n      ,[MEMBER_SNK]\n      ,[VISITED_CLUB_SNK]\n      ,[HOME_CLUB_SNK]\n      ,[REFERRING_MEMBER_SNK]\n      ,[TYPE_OF_CHECKIN_OR_AMENITY]\n      ,[RECORD_TYPE]\n      ,[ENTRY_STATUS_CODE]\n      ,[AMENITY_USAGE_QTY]\n      ,[VISIT_COUNT]\n      ,[SPONSORED_PROSPECT]\n      ,[SRC_SYS_ID]\n      ,[ETL_LOAD_DATE]\n      ,[ETL_UPDATE_DATE]\n      ,[ETL_USER_ID]\n      ,[ADD_TYPE_SID]\n  FROM [INZADBA].[FactMemberUsage]\nWHERE ETL_UPDATE_DATE >= CONVERT(datetime,'@{formatDateTime(pipeline().parameters.windowStart, 'yyyy-MM-dd HH:mm' )}')\nAND ETL_UPDATE_DATE < CONVERT(datetime,'@{formatDateTime(pipeline().parameters.windowEnd, 'yyyy-MM-dd HH:mm' )}')",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "AzureBlobStorageWriteSettings",
									"maxConcurrentConnections": 3
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".txt"
								}
							},
							"enableStaging": false,
							"parallelCopies": 4,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "MEMBER_USAGE_SID",
											"type": "Int64",
											"physicalType": "bigint"
										},
										"sink": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 1
										}
									},
									{
										"source": {
											"name": "USAGE_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 2
										}
									},
									{
										"source": {
											"name": "VISITED_CLUB_SID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 3
										}
									},
									{
										"source": {
											"name": "MEMBER_SID",
											"type": "Int64",
											"physicalType": "bigint"
										},
										"sink": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 4
										}
									},
									{
										"source": {
											"name": "HOME_CLUB_SID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 5
										}
									},
									{
										"source": {
											"name": "VISIT_DATE_SID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 6
										}
									},
									{
										"source": {
											"name": "VISIT_TIME_SID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 7
										}
									},
									{
										"source": {
											"name": "AMENITY_SID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 8
										}
									},
									{
										"source": {
											"name": "PROSPECT_SID",
											"type": "Int64",
											"physicalType": "bigint"
										},
										"sink": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 9
										}
									},
									{
										"source": {
											"name": "VISITED_CLUB_NUMBER_POS",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 10
										}
									},
									{
										"source": {
											"name": "MEMBER_NUMBER",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 11
										}
									},
									{
										"source": {
											"name": "HOME_CLUB_NUMBER_POS",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 12
										}
									},
									{
										"source": {
											"name": "VISIT_DATE_TIME",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 13
										}
									},
									{
										"source": {
											"name": "AMENITY_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 14
										}
									},
									{
										"source": {
											"name": "MEMBER_NUMBER_UNIQUE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 15
										}
									},
									{
										"source": {
											"name": "PROSPECT_NUMBER_UNIQUE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 16
										}
									},
									{
										"source": {
											"name": "REFERRING_MEMBER_SID",
											"type": "Int64",
											"physicalType": "bigint"
										},
										"sink": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 17
										}
									},
									{
										"source": {
											"name": "CHECK_IN_ALERT_SID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 18
										}
									},
									{
										"source": {
											"name": "MEMBER_TYPE_SID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 19
										}
									},
									{
										"source": {
											"name": "OFFER_SID",
											"type": "Int64",
											"physicalType": "bigint"
										},
										"sink": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 20
										}
									},
									{
										"source": {
											"name": "OFFER_SNK",
											"type": "Int64",
											"physicalType": "bigint"
										},
										"sink": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 21
										}
									},
									{
										"source": {
											"name": "MEMBER_SNK",
											"type": "Int64",
											"physicalType": "bigint"
										},
										"sink": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 22
										}
									},
									{
										"source": {
											"name": "VISITED_CLUB_SNK",
											"type": "Int64",
											"physicalType": "bigint"
										},
										"sink": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 23
										}
									},
									{
										"source": {
											"name": "HOME_CLUB_SNK",
											"type": "Int64",
											"physicalType": "bigint"
										},
										"sink": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 24
										}
									},
									{
										"source": {
											"name": "REFERRING_MEMBER_SNK",
											"type": "Int64",
											"physicalType": "bigint"
										},
										"sink": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 25
										}
									},
									{
										"source": {
											"name": "TYPE_OF_CHECKIN_OR_AMENITY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 26
										}
									},
									{
										"source": {
											"name": "RECORD_TYPE",
											"type": "Int16",
											"physicalType": "smallint"
										},
										"sink": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 27
										}
									},
									{
										"source": {
											"name": "ENTRY_STATUS_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 28
										}
									},
									{
										"source": {
											"name": "AMENITY_USAGE_QTY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 29
										}
									},
									{
										"source": {
											"name": "VISIT_COUNT",
											"type": "Int16",
											"physicalType": "smallint"
										},
										"sink": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 30
										}
									},
									{
										"source": {
											"name": "SPONSORED_PROSPECT",
											"type": "Int16",
											"physicalType": "smallint"
										},
										"sink": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 31
										}
									},
									{
										"source": {
											"name": "SRC_SYS_ID",
											"type": "Int16",
											"physicalType": "smallint"
										},
										"sink": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 32
										}
									},
									{
										"source": {
											"name": "ETL_LOAD_DATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 33
										}
									},
									{
										"source": {
											"name": "ETL_UPDATE_DATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 34
										}
									},
									{
										"source": {
											"name": "ETL_USER_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 35
										}
									},
									{
										"source": {
											"name": "ADD_TYPE_SID",
											"type": "Int64",
											"physicalType": "bigint"
										},
										"sink": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 36
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "AzureSynapseAnalyticsDB",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "SNK_SNOW_FLATFILE_FactMemberUsage",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"windowStart": {
						"type": "string"
					},
					"windowEnd": {
						"type": "string"
					}
				},
				"folder": {
					"name": "SNOWFLAKE_EXTRACT_POOL"
				},
				"annotations": [],
				"lastPublishTime": "2023-02-24T20:22:02Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/SNOWFLAKE_RPT_NZ_ADD_TYPE_DIM')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "INSERT SNOWFLAKE DAILY RPT_NZ_ADD_TYPE_DIM",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SnowflakeSource",
								"query": "SELECT ADD_TYPE\n      ,CHANNEL\n      ,ADD_TYPE_SID\n      ,TOTALADDTYPECOUNT\n      ,GETDATE()\nFROM EDW. RPT_NZ_ADD_TYPE_DIM",
								"exportSettings": {
									"type": "SnowflakeExportCopyCommand"
								}
							},
							"sink": {
								"type": "SqlDWSink",
								"allowCopyCommand": true,
								"copyCommandSettings": {}
							},
							"enableStaging": true,
							"stagingSettings": {
								"linkedServiceName": {
									"referenceName": "AzureBlob_PFSNOWINT",
									"type": "LinkedServiceReference"
								},
								"path": "snowimporthist",
								"enableCompression": true
							},
							"parallelCopies": 8,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "ADD_TYPE",
											"type": "String"
										},
										"sink": {
											"name": "ADD_TYPE",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "CHANNEL",
											"type": "String"
										},
										"sink": {
											"name": "CHANNEL",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ADD_TYPE_SID",
											"type": "Int64"
										},
										"sink": {
											"name": "ADD_TYPE_SID",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "TOTALADDTYPECOUNT",
											"type": "Int64"
										},
										"sink": {
											"name": "TOTALADDTYPECOUNT",
											"type": "Int64"
										}
									},
									{
										"source": {
											"name": "GETDATE()",
											"type": "DateTime"
										},
										"sink": {
											"name": "INSERTDATE",
											"type": "DateTime"
										}
									}
								]
							}
						},
						"inputs": [
							{
								"referenceName": "RPT_NZ_ADD_TYPE_DIM",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "SNK_RPT_NZ_ADD_TYPE_DIM",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"folder": {
					"name": "SNOWFLAKE_GET_DAILY_NETEEZA_COUNTS"
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/SNOWFLAKE_RPT_NZ_CATALOGUE_ITEM_DIM')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "INSERT SNOWFLAKE DAILY RPT_NZ_CATALOGUE_ITEM_DIM",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SnowflakeSource",
								"query": "SELECT CATALOGUE_ITEM_SNK\n      ,ITEM_NAME\n      ,ACTIVE_FLAG\n      ,PROFIT_CENTER_GROUP\n      ,TOTALCOUNT\n      ,GETDATE() AS INSDATE\nFROM EDW.RPT_NZ_CATALOGUE_ITEM_DIM",
								"exportSettings": {
									"type": "SnowflakeExportCopyCommand"
								}
							},
							"sink": {
								"type": "SqlDWSink",
								"maxConcurrentConnections": 8,
								"allowCopyCommand": true,
								"copyCommandSettings": {},
								"disableMetricsCollection": false
							},
							"enableStaging": true,
							"stagingSettings": {
								"linkedServiceName": {
									"referenceName": "AzureBlob_PFSNOWINT",
									"type": "LinkedServiceReference"
								},
								"path": "snowimporthist",
								"enableCompression": true
							},
							"parallelCopies": 8,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "CATALOGUE_ITEM_SNK",
											"type": "String"
										},
										"sink": {
											"name": "CATALOGUE_ITEM_SNK",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ITEM_NAME",
											"type": "String"
										},
										"sink": {
											"name": "ITEM_NAME",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ACTIVE_FLAG",
											"type": "Int64"
										},
										"sink": {
											"name": "ACTIVE_FLAG",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PROFIT_CENTER_GROUP",
											"type": "String"
										},
										"sink": {
											"name": "PROFIT_CENTER_GROUP",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "TOTALCOUNT",
											"type": "Int64"
										},
										"sink": {
											"name": "TOTALCOUNT",
											"type": "Int64"
										}
									},
									{
										"source": {
											"name": "INSDATE",
											"type": "DateTime"
										},
										"sink": {
											"name": "INSERTDATE",
											"type": "DateTime"
										}
									}
								]
							}
						},
						"inputs": [
							{
								"referenceName": "RPT_NZ_CATALOGUE_ITEM_DIM",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "SNK_RPT_NZ_CATALOGUE_ITEM_DIM",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"folder": {
					"name": "SNOWFLAKE_GET_DAILY_NETEEZA_COUNTS"
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/SNOWFLAKE_RPT_NZ_CATALOGUE_ITEM_SALES_FACT')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "INSERT SNOWFLAKE DAILY RPT_NZ_CATALOGUE_ITEM_SALES_FACT",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SnowflakeSource",
								"query": "SELECT MEMBER_SNK\r\n      ,CLUB_SNK\r\n      ,CATALOGUE_ITEM_SNK\r\n      ,TRANSACTION_DATE\r\n      ,INCOME_TOTAL\r\n      ,TOTALFACTCATALOGUEITEMSALESCOUNT\r\n      ,GETDATE() AS INSDATE\r\nFROM EDW.RPT_NZ_CATALOGUE_ITEM_SALES_FACT",
								"exportSettings": {
									"type": "SnowflakeExportCopyCommand"
								}
							},
							"sink": {
								"type": "SqlDWSink",
								"maxConcurrentConnections": 8,
								"allowCopyCommand": true,
								"copyCommandSettings": {},
								"disableMetricsCollection": false
							},
							"enableStaging": true,
							"stagingSettings": {
								"linkedServiceName": {
									"referenceName": "AzureBlob_PFSNOWINT",
									"type": "LinkedServiceReference"
								},
								"path": "snowimporthist",
								"enableCompression": true
							},
							"parallelCopies": 8,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "MEMBER_SNK",
											"type": "Int64"
										},
										"sink": {
											"name": "MEMBER_SNK",
											"type": "Int64"
										}
									},
									{
										"source": {
											"name": "CLUB_SNK",
											"type": "Int64"
										},
										"sink": {
											"name": "CLUB_SNK",
											"type": "Int64"
										}
									},
									{
										"source": {
											"name": "CATALOGUE_ITEM_SNK",
											"type": "Int64"
										},
										"sink": {
											"name": "CATALOGUE_ITEM_SNK",
											"type": "Int64"
										}
									},
									{
										"source": {
											"name": "TRANSACTION_DATE",
											"type": "DateTime"
										},
										"sink": {
											"name": "TRANSACTION_DATE",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "INCOME_TOTAL",
											"type": "Int64"
										},
										"sink": {
											"name": "INCOME_TOTAL",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "TOTALFACTCATALOGUEITEMSALESCOUNT",
											"type": "Int64"
										},
										"sink": {
											"name": "TOTALFACTCATALOGUEITEMSALESCOUNT",
											"type": "Int64"
										}
									},
									{
										"source": {
											"name": "INSDATE",
											"type": "DateTime"
										},
										"sink": {
											"name": "INSERTDATE",
											"type": "DateTime"
										}
									}
								]
							}
						},
						"inputs": [
							{
								"referenceName": "RPT_NZ_CATALOGUE_ITEM_SALES_FACT",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "SNK_RPT_NZ_CATALOGUE_ITEM_SALES_FACT",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"folder": {
					"name": "SNOWFLAKE_GET_DAILY_NETEEZA_COUNTS"
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/SNOWFLAKE_RPT_NZ_CHECKIN_ALERT_DIM')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "INSERT SNOWFLAKE DAILY RPT_NZ_CHECKIN_ALERT_DIM",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SnowflakeSource",
								"query": "SELECT *\nFROM EDW.RPT_NZ_CHECKIN_ALERT_DIM",
								"exportSettings": {
									"type": "SnowflakeExportCopyCommand"
								}
							},
							"sink": {
								"type": "SqlDWSink",
								"maxConcurrentConnections": 8,
								"allowCopyCommand": true,
								"copyCommandSettings": {},
								"disableMetricsCollection": false
							},
							"enableStaging": true,
							"stagingSettings": {
								"linkedServiceName": {
									"referenceName": "AzureBlob_PFSNOWINT",
									"type": "LinkedServiceReference"
								},
								"path": "snowimporthist",
								"enableCompression": true
							},
							"parallelCopies": 8,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "CHECK_IN_ALERT",
											"type": "String"
										},
										"sink": {
											"name": "CHECK_IN_ALERT",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "CHECK_IN_ALERT_DESCRIPTION",
											"type": "String"
										},
										"sink": {
											"name": "CHECK_IN_ALERT_DESCRIPTION",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "TOTALCOUNT",
											"type": "Int64"
										},
										"sink": {
											"name": "TOTALCOUNT",
											"type": "Int64"
										}
									}
								]
							}
						},
						"inputs": [
							{
								"referenceName": "RPT_NZ_CHECKIN_ALERT_DIM",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "SNK_RPT_NZ_CHECKIN_ALERT_DIM",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"folder": {
					"name": "SNOWFLAKE_GET_DAILY_NETEEZA_COUNTS"
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/SNOWFLAKE_RPT_NZ_CHECKIN_ENTRY_CODE_LKUP')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "INSERT SNOWFLAKE DAILY RPT_NZ_CHECKIN_ENTRY_CODE_LKUP",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SnowflakeSource",
								"query": "SELECT CHECKIN_ENTRY_STATUS_CODE\n      ,CHECKIN_ENTRY_STATUS_CODE_DESCRIPTION\n      ,TOTALCOUNT\n      ,GETDATE()\nFROM EDW. RPT_NZ_CHECKIN_ENTRY_CODE_LKUP",
								"exportSettings": {
									"type": "SnowflakeExportCopyCommand"
								}
							},
							"sink": {
								"type": "SqlDWSink",
								"allowCopyCommand": true,
								"copyCommandSettings": {}
							},
							"enableStaging": true,
							"stagingSettings": {
								"linkedServiceName": {
									"referenceName": "AzureBlob_PFSNOWINT",
									"type": "LinkedServiceReference"
								},
								"path": "snowimporthist",
								"enableCompression": true
							},
							"parallelCopies": 8,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "CHECKIN_ENTRY_STATUS_CODE",
											"type": "String"
										},
										"sink": {
											"name": "CHECKIN_ENTRY_STATUS_CODE",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "CHECKIN_ENTRY_STATUS_CODE_DESCRIPTION",
											"type": "String"
										},
										"sink": {
											"name": "CHECKIN_ENTRY_STATUS_CODE_DESCRIPTION",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "TOTALCOUNT",
											"type": "Int64"
										},
										"sink": {
											"name": "TOTALCOUNT",
											"type": "Int64"
										}
									},
									{
										"source": {
											"name": "GETDATE()",
											"type": "DateTime"
										},
										"sink": {
											"name": "INSERTDATE",
											"type": "DateTime"
										}
									}
								]
							}
						},
						"inputs": [
							{
								"referenceName": "RPT_NZ_CHECKIN_ENTRY_CODE_LKUP3",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "SNK_RPT_NZ_CHECKIN_ENTRY_CODE_LKUP",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"folder": {
					"name": "SNOWFLAKE_GET_DAILY_NETEEZA_COUNTS"
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/SNOWFLAKE_RPT_NZ_CORPORATE_MEMBERSHIP_PROMO_CODES_LKUP')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "RPT_NZ_CORPORATE_MEMBERSHIP_PROMO_CODES_LKUP",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SnowflakeSource",
								"query": "SELECT  COMPANY_NAME\n\t,PROMO_CODE\n\t,PAY_TYPE\n\t,TOTALCOUNT\n      ,GETDATE()\nFROM EDW.RPT_NZ_CORPORATE_MEMBERSHIP_PROMO_CODES_LKUP",
								"exportSettings": {
									"type": "SnowflakeExportCopyCommand"
								}
							},
							"sink": {
								"type": "SqlDWSink",
								"maxConcurrentConnections": 8,
								"allowCopyCommand": true,
								"copyCommandSettings": {},
								"disableMetricsCollection": false
							},
							"enableStaging": true,
							"stagingSettings": {
								"linkedServiceName": {
									"referenceName": "AzureBlob_PFSNOWINT",
									"type": "LinkedServiceReference"
								},
								"path": "snowimporthist",
								"enableCompression": true
							},
							"parallelCopies": 8,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "COMPANY_NAME",
											"type": "String"
										},
										"sink": {
											"name": "COMPANY_NAME",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PROMO_CODE",
											"type": "String"
										},
										"sink": {
											"name": "PROMO_CODE",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PAY_TYPE",
											"type": "String"
										},
										"sink": {
											"name": "PAY_TYPE",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "TOTALCOUNT",
											"type": "Int64"
										},
										"sink": {
											"name": "TOTALCOUNT",
											"type": "Int64"
										}
									},
									{
										"source": {
											"name": "GETDATE()",
											"type": "DateTime"
										},
										"sink": {
											"name": "INSERTDATE",
											"type": "DateTime"
										}
									}
								]
							}
						},
						"inputs": [
							{
								"referenceName": "RPT_NZ_CORPORATE_MEMBERSHIP_PROMO_CODES_LKUP",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "SNK_RPT_NZ_CORPORATE_MEMBERSHIP_PROMO_CODES_LKUP",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"folder": {
					"name": "SNOWFLAKE_GET_DAILY_NETEEZA_COUNTS"
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/SNOWFLAKE_RPT_NZ_INVOICE_TYPE_LKUP')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "INSERT SNOWFLAKE DAILY RPT_NZ_INVOICE_TYPE_LKUP",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SnowflakeSource",
								"query": "SELECT INVOICE_TYPE\n\t,INVOICE_TYPE_DESCRIPTION\n\t,TOTALINVOICECOUNT\n      ,GETDATE() AS INSDATE\nFROM EDW.RPT_NZ_INVOICE_TYPE_LKUP",
								"exportSettings": {
									"type": "SnowflakeExportCopyCommand"
								}
							},
							"sink": {
								"type": "SqlDWSink",
								"maxConcurrentConnections": 8,
								"allowCopyCommand": true,
								"copyCommandSettings": {},
								"disableMetricsCollection": false
							},
							"enableStaging": true,
							"stagingSettings": {
								"linkedServiceName": {
									"referenceName": "AzureBlob_PFSNOWINT",
									"type": "LinkedServiceReference"
								},
								"path": "snowimporthist",
								"enableCompression": true
							},
							"parallelCopies": 8,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "INVOICE_TYPE",
											"type": "String"
										},
										"sink": {
											"name": "INVOICE_TYPE",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "INVOICE_TYPE_DESCRIPTION",
											"type": "String"
										},
										"sink": {
											"name": "INVOICE_TYPE_DESCRIPTION",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "TOTALINVOICECOUNT",
											"type": "Int64"
										},
										"sink": {
											"name": "TOTALINVOICECOUNT",
											"type": "Int64"
										}
									},
									{
										"source": {
											"name": "INSDATE",
											"type": "DateTime"
										},
										"sink": {
											"name": "INSERTDATE",
											"type": "DateTime"
										}
									}
								]
							}
						},
						"inputs": [
							{
								"referenceName": "RPT_NZ_INVOICE_TYPE_LKUP",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "SNK_RPT_NZ_INVOICE_TYPE_LKUP",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"folder": {
					"name": "SNOWFLAKE_GET_DAILY_NETEEZA_COUNTS"
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/SNOWFLAKE_RPT_NZ_MEMBER_ACTIONS_FACT')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "INSERT SNOWFLAKE DAILY RPT_NZ_MEMBER_ACTIONS_FACT",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SnowflakeSource",
								"query": "SELECT MEMBER_ACTIONS_FACT_UID\n      ,MEMBER_ACTIONS_SID\n      ,MEMBER_ACTIONS_FACT_SID\n      ,SRC_MEMBER_ACTIONS_SID\n      ,MEMBER_SID\n      ,CLUB_SID\n      ,ACTION_DATE_SID\n      ,ACTION_TIME_SID\n      ,STATUS_CODE_SID\n      ,OLD_CLUB_SID\n      ,OLD_MEMBER_SID\n      ,MEMBER_TYPE_SID\n      ,CONVERT_TO_MEMBER_TYPE_SID\n      ,ADD_TYPE_SID\n      ,OFFER_SID\n      ,OFFER_SNK\n      ,MEMBER_SNK\n      ,CLUB_SNK\n      ,OLD_MEMBER_SNK\n      ,OLD_CLUB_SNK\n      ,REASON_FOR_ACTION\n      ,GROWTH_EFT\n      ,GROWTH_EFT_TAX\n      ,ACTION_COUNT\n      ,SRC_SYS_ID\n      ,MEMBER_PAYMENT_FREQUENCY_CODE\n      ,PREVIOUS_MEMBER_PAYMENT_FREQUENCY_CODE\n      ,MEMBER_NUMBER_UNIQUE\n      ,CLUB_NUMBER\n      ,SERVICE_DATE_TIME\n      ,TYPE_OF_ACTION\n      ,ETL_LOAD_DATE\n      ,ETL_UPDATE_DATE\n      ,ETL_USER_ID\n      ,MEMBER_SID_OLD\n      ,OLD_MEMBER_SID_OLD\n      ,GROWTH_EFT_USD\n      ,GROWTH_EFT_TAX_USD\n      ,IS_CONSOLE_UPGRADE\n      ,IS_ONLINE_CANCEL\n      ,DEACTIVATION_DATE\n      ,FREEZE_START_DATE\n      ,FREEZE_END_DATE\n      ,LOAD_TYPE\n      ,INGESTION_TIMESTAMP\n      ,DW_ROW_HASH\n      ,DW_DML_FLAG\n      ,DW_CREATED_DATE\n      ,DW_UPDATED_DATE\n      ,DW_START_EFFECTIVE_DATE\n      ,DW_END_EFFECTIVE_DATE\n      ,DW_IS_CURRENT\n      ,DW_IS_ACTIVE\n      ,DW_IS_SOFT_DELETE\n      ,DW_IS_TEST_DATA\n      ,DW_SRC_VERSION_ID\n      ,DW_LINEAGE_ID\n      ,DW_MODIFIED_BY_USER\n      ,DW_MODIFIED_BY_SCM_TASK_ID\n      ,DW_MODIFIED_BY_SCM_CASE\n     ,GETDATE()\nFROM EDW. RPT_NZ_MEMBER_ACTIONS_FACT",
								"exportSettings": {
									"type": "SnowflakeExportCopyCommand"
								}
							},
							"sink": {
								"type": "SqlDWSink",
								"allowCopyCommand": true,
								"copyCommandSettings": {}
							},
							"enableStaging": true,
							"stagingSettings": {
								"linkedServiceName": {
									"referenceName": "AzureBlob_PFSNOWINT",
									"type": "LinkedServiceReference"
								},
								"path": "snowimporthist",
								"enableCompression": true
							},
							"parallelCopies": 8,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "MEMBER_ACTIONS_FACT_UID",
											"type": "String"
										},
										"sink": {
											"name": "MEMBER_ACTIONS_FACT_UID",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "MEMBER_ACTIONS_SID",
											"type": "Int64"
										},
										"sink": {
											"name": "MEMBER_ACTIONS_SID",
											"type": "Int64"
										}
									},
									{
										"source": {
											"name": "MEMBER_ACTIONS_FACT_SID",
											"type": "Int64"
										},
										"sink": {
											"name": "MEMBER_ACTIONS_FACT_SID",
											"type": "Int64"
										}
									},
									{
										"source": {
											"name": "SRC_MEMBER_ACTIONS_SID",
											"type": "Int64"
										},
										"sink": {
											"name": "SRC_MEMBER_ACTIONS_SID",
											"type": "Int64"
										}
									},
									{
										"source": {
											"name": "MEMBER_SID",
											"type": "Int64"
										},
										"sink": {
											"name": "MEMBER_SID",
											"type": "Int64"
										}
									},
									{
										"source": {
											"name": "CLUB_SID",
											"type": "Int64"
										},
										"sink": {
											"name": "CLUB_SID",
											"type": "Int64"
										}
									},
									{
										"source": {
											"name": "ACTION_DATE_SID",
											"type": "Int64"
										},
										"sink": {
											"name": "ACTION_DATE_SID",
											"type": "Int64"
										}
									},
									{
										"source": {
											"name": "ACTION_TIME_SID",
											"type": "Int64"
										},
										"sink": {
											"name": "ACTION_TIME_SID",
											"type": "Int64"
										}
									},
									{
										"source": {
											"name": "STATUS_CODE_SID",
											"type": "Int64"
										},
										"sink": {
											"name": "STATUS_CODE_SID",
											"type": "Int64"
										}
									},
									{
										"source": {
											"name": "OLD_CLUB_SID",
											"type": "Int64"
										},
										"sink": {
											"name": "OLD_CLUB_SID",
											"type": "Int64"
										}
									},
									{
										"source": {
											"name": "OLD_MEMBER_SID",
											"type": "Int64"
										},
										"sink": {
											"name": "OLD_MEMBER_SID",
											"type": "Int64"
										}
									},
									{
										"source": {
											"name": "MEMBER_TYPE_SID",
											"type": "Int64"
										},
										"sink": {
											"name": "MEMBER_TYPE_SID",
											"type": "Int64"
										}
									},
									{
										"source": {
											"name": "CONVERT_TO_MEMBER_TYPE_SID",
											"type": "Int64"
										},
										"sink": {
											"name": "CONVERT_TO_MEMBER_TYPE_SID",
											"type": "Int64"
										}
									},
									{
										"source": {
											"name": "ADD_TYPE_SID",
											"type": "Int64"
										},
										"sink": {
											"name": "ADD_TYPE_SID",
											"type": "Int64"
										}
									},
									{
										"source": {
											"name": "OFFER_SID",
											"type": "Int64"
										},
										"sink": {
											"name": "OFFER_SID",
											"type": "Int64"
										}
									},
									{
										"source": {
											"name": "OFFER_SNK",
											"type": "Int64"
										},
										"sink": {
											"name": "OFFER_SNK",
											"type": "Int64"
										}
									},
									{
										"source": {
											"name": "MEMBER_SNK",
											"type": "Int64"
										},
										"sink": {
											"name": "MEMBER_SNK",
											"type": "Int64"
										}
									},
									{
										"source": {
											"name": "CLUB_SNK",
											"type": "Int64"
										},
										"sink": {
											"name": "CLUB_SNK",
											"type": "Int64"
										}
									},
									{
										"source": {
											"name": "OLD_MEMBER_SNK",
											"type": "Int64"
										},
										"sink": {
											"name": "OLD_MEMBER_SNK",
											"type": "Int64"
										}
									},
									{
										"source": {
											"name": "OLD_CLUB_SNK",
											"type": "Int64"
										},
										"sink": {
											"name": "OLD_CLUB_SNK",
											"type": "Int64"
										}
									},
									{
										"source": {
											"name": "REASON_FOR_ACTION",
											"type": "String"
										},
										"sink": {
											"name": "REASON_FOR_ACTION",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "GROWTH_EFT",
											"type": "Int64"
										},
										"sink": {
											"name": "GROWTH_EFT",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "GROWTH_EFT_TAX",
											"type": "Int64"
										},
										"sink": {
											"name": "GROWTH_EFT_TAX",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "ACTION_COUNT",
											"type": "Int64"
										},
										"sink": {
											"name": "ACTION_COUNT",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "SRC_SYS_ID",
											"type": "Int64"
										},
										"sink": {
											"name": "SRC_SYS_ID",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "MEMBER_PAYMENT_FREQUENCY_CODE",
											"type": "String"
										},
										"sink": {
											"name": "MEMBER_PAYMENT_FREQUENCY_CODE",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PREVIOUS_MEMBER_PAYMENT_FREQUENCY_CODE",
											"type": "String"
										},
										"sink": {
											"name": "PREVIOUS_MEMBER_PAYMENT_FREQUENCY_CODE",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "MEMBER_NUMBER_UNIQUE",
											"type": "String"
										},
										"sink": {
											"name": "MEMBER_NUMBER_UNIQUE",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "CLUB_NUMBER",
											"type": "String"
										},
										"sink": {
											"name": "CLUB_NUMBER",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "SERVICE_DATE_TIME",
											"type": "DateTime"
										},
										"sink": {
											"name": "SERVICE_DATE_TIME",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "TYPE_OF_ACTION",
											"type": "String"
										},
										"sink": {
											"name": "TYPE_OF_ACTION",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ETL_LOAD_DATE",
											"type": "DateTime"
										},
										"sink": {
											"name": "ETL_LOAD_DATE",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "ETL_UPDATE_DATE",
											"type": "DateTime"
										},
										"sink": {
											"name": "ETL_UPDATE_DATE",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "ETL_USER_ID",
											"type": "String"
										},
										"sink": {
											"name": "ETL_USER_ID",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "MEMBER_SID_OLD",
											"type": "Int64"
										},
										"sink": {
											"name": "MEMBER_SID_OLD",
											"type": "Int64"
										}
									},
									{
										"source": {
											"name": "OLD_MEMBER_SID_OLD",
											"type": "Int64"
										},
										"sink": {
											"name": "OLD_MEMBER_SID_OLD",
											"type": "Int64"
										}
									},
									{
										"source": {
											"name": "GROWTH_EFT_USD",
											"type": "Int64"
										},
										"sink": {
											"name": "GROWTH_EFT_USD",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "GROWTH_EFT_TAX_USD",
											"type": "Int64"
										},
										"sink": {
											"name": "GROWTH_EFT_TAX_USD",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "IS_CONSOLE_UPGRADE",
											"type": "Int64"
										},
										"sink": {
											"name": "IS_CONSOLE_UPGRADE",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "IS_ONLINE_CANCEL",
											"type": "Int64"
										},
										"sink": {
											"name": "IS_ONLINE_CANCEL",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "DEACTIVATION_DATE",
											"type": "DateTime"
										},
										"sink": {
											"name": "DEACTIVATION_DATE",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "FREEZE_START_DATE",
											"type": "DateTime"
										},
										"sink": {
											"name": "FREEZE_START_DATE",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "FREEZE_END_DATE",
											"type": "DateTime"
										},
										"sink": {
											"name": "FREEZE_END_DATE",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "LOAD_TYPE",
											"type": "String"
										},
										"sink": {
											"name": "LOAD_TYPE",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "INGESTION_TIMESTAMP",
											"type": "DateTime"
										},
										"sink": {
											"name": "INGESTION_TIMESTAMP",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "DW_ROW_HASH",
											"type": "Int64"
										},
										"sink": {
											"name": "DW_ROW_HASH",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "DW_DML_FLAG",
											"type": "String"
										},
										"sink": {
											"name": "DW_DML_FLAG",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "DW_CREATED_DATE",
											"type": "DateTime"
										},
										"sink": {
											"name": "DW_CREATED_DATE",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "DW_UPDATED_DATE",
											"type": "DateTime"
										},
										"sink": {
											"name": "DW_UPDATED_DATE",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "DW_START_EFFECTIVE_DATE",
											"type": "DateTime"
										},
										"sink": {
											"name": "DW_START_EFFECTIVE_DATE",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "DW_END_EFFECTIVE_DATE",
											"type": "DateTime"
										},
										"sink": {
											"name": "DW_END_EFFECTIVE_DATE",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "DW_IS_CURRENT",
											"type": "Boolean"
										},
										"sink": {
											"name": "DW_IS_CURRENT",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"name": "DW_IS_ACTIVE",
											"type": "Boolean"
										},
										"sink": {
											"name": "DW_IS_ACTIVE",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"name": "DW_IS_SOFT_DELETE",
											"type": "Boolean"
										},
										"sink": {
											"name": "DW_IS_SOFT_DELETE",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"name": "DW_IS_TEST_DATA",
											"type": "Boolean"
										},
										"sink": {
											"name": "DW_IS_TEST_DATA",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"name": "DW_SRC_VERSION_ID",
											"type": "String"
										},
										"sink": {
											"name": "DW_SRC_VERSION_ID",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "DW_LINEAGE_ID",
											"type": "String"
										},
										"sink": {
											"name": "DW_LINEAGE_ID",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "DW_MODIFIED_BY_USER",
											"type": "String"
										},
										"sink": {
											"name": "DW_MODIFIED_BY_USER",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "DW_MODIFIED_BY_SCM_TASK_ID",
											"type": "String"
										},
										"sink": {
											"name": "DW_MODIFIED_BY_SCM_TASK_ID",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "DW_MODIFIED_BY_SCM_CASE",
											"type": "String"
										},
										"sink": {
											"name": "DW_MODIFIED_BY_SCM_CASE",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "GETDATE()",
											"type": "DateTime"
										},
										"sink": {
											"name": "INSERTDATE",
											"type": "DateTime"
										}
									}
								]
							}
						},
						"inputs": [
							{
								"referenceName": "RPT_NZ_MEMBER_ACTIONS_FACT",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "SNK_RPT_NZ_MEMBER_ACTIONS_FACT",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"folder": {
					"name": "SNOWFLAKE_GET_DAILY_NETEEZA_COUNTS"
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/SNOWFLAKE_RPT_NZ_MEMBER_ACTIONS_FACT_TYPE')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "INSERT SNOWFLAKE DAILY RPT_NZ_MEMBER_ACTIONS_FACT_TYPE",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SnowflakeSource",
								"query": "SELECT  CLUB_NUMBER\n\t,ACTION_DATE_SID\n\t,TYPE_OF_ACTION\n\t,ACTIONTYPECOUNT\n      ,GETDATE()\nFROM EDW.RPT_NZ_MEMBER_ACTIONS_FACT_TYPE",
								"exportSettings": {
									"type": "SnowflakeExportCopyCommand"
								}
							},
							"sink": {
								"type": "SqlDWSink",
								"maxConcurrentConnections": 8,
								"allowCopyCommand": true,
								"copyCommandSettings": {},
								"disableMetricsCollection": false
							},
							"enableStaging": true,
							"stagingSettings": {
								"linkedServiceName": {
									"referenceName": "AzureBlob_PFSNOWINT",
									"type": "LinkedServiceReference"
								},
								"path": "snowimporthist",
								"enableCompression": true
							},
							"parallelCopies": 8,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "CLUB_NUMBER",
											"type": "String"
										},
										"sink": {
											"name": "CLUB_NUMBER",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ACTION_DATE_SID",
											"type": "Int64"
										},
										"sink": {
											"name": "ACTION_DATE_SID",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "TYPE_OF_ACTION",
											"type": "String"
										},
										"sink": {
											"name": "TYPE_OF_ACTION",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ACTIONTYPECOUNT",
											"type": "Int64"
										},
										"sink": {
											"name": "ACTIONTYPECOUNT",
											"type": "Int64"
										}
									},
									{
										"source": {
											"name": "GETDATE()",
											"type": "DateTime"
										},
										"sink": {
											"name": "INSERTDATE",
											"type": "DateTime"
										}
									}
								]
							}
						},
						"inputs": [
							{
								"referenceName": "RPT_NZ_MEMBER_ACTIONS_FACT_TYPE",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "SNK_RPT_NZ_MEMBER_ACTIONS_FACT_TYPE",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"folder": {
					"name": "SNOWFLAKE_GET_DAILY_NETEEZA_COUNTS"
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/SNOWFLAKE_RPT_NZ_MEMBER_DIM_ADD_TYPE')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "INSERT SNOWFLAKE DAILY RPT_NZ_MEMBER_DIM_ADD_TYPE",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SnowflakeSource",
								"query": "SELECT ADD_TYPE\n\t,MEMADDCOUNT\n      ,GETDATE()\nFROM EDW.RPT_NZ_MEMBER_DIM_ADD_TYPE",
								"exportSettings": {
									"type": "SnowflakeExportCopyCommand"
								}
							},
							"sink": {
								"type": "SqlDWSink",
								"maxConcurrentConnections": 8,
								"allowCopyCommand": true,
								"copyCommandSettings": {},
								"disableMetricsCollection": false
							},
							"enableStaging": true,
							"stagingSettings": {
								"linkedServiceName": {
									"referenceName": "AzureBlob_PFSNOWINT",
									"type": "LinkedServiceReference"
								},
								"path": "snowimporthist",
								"enableCompression": true
							},
							"parallelCopies": 8,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "ADD_TYPE",
											"type": "String"
										},
										"sink": {
											"name": "ADD_TYPE",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "MEMADDCOUNT",
											"type": "Int64"
										},
										"sink": {
											"name": "MEMADDCOUNT",
											"type": "Int64"
										}
									},
									{
										"source": {
											"name": "GETDATE()",
											"type": "DateTime"
										},
										"sink": {
											"name": "INSERTDATE",
											"type": "DateTime"
										}
									}
								]
							}
						},
						"inputs": [
							{
								"referenceName": "RPT_NZ_MEMBER_DIM_ADD_TYPE",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "SNK_RPT_NZ_MEMBER_DIM_ADD_TYPE",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"folder": {
					"name": "SNOWFLAKE_GET_DAILY_NETEEZA_COUNTS"
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/SNOWFLAKE_RPT_NZ_MEMBER_DIM_BIG_MEMBER')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "INSERT SNOWFLAKE DAILY RPT_NZ_ADD_TYPE_DIM",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SnowflakeSource",
								"query": "SELECT MEMBER_TYPE\n       ,ADD_TYPE\n      ,CLUB_NUMBER\n      ,PAYMENT_MODE\n      ,STATUS_CODE\n      ,MEMCLUBCOUNT\n      ,GETDATE()\nFROM EDW. RPT_NZ_MEMBER_DIM_BIG_MEMBER",
								"exportSettings": {
									"type": "SnowflakeExportCopyCommand"
								}
							},
							"sink": {
								"type": "SqlDWSink",
								"allowCopyCommand": true,
								"copyCommandSettings": {}
							},
							"enableStaging": true,
							"stagingSettings": {
								"linkedServiceName": {
									"referenceName": "AzureBlob_PFSNOWINT",
									"type": "LinkedServiceReference"
								},
								"path": "snowimporthist",
								"enableCompression": true
							},
							"parallelCopies": 8,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "MEMBER_TYPE",
											"type": "String"
										},
										"sink": {
											"name": "MEMBER_TYPE",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ADD_TYPE",
											"type": "String"
										},
										"sink": {
											"name": "ADD_TYPE",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "CLUB_NUMBER",
											"type": "String"
										},
										"sink": {
											"name": "CLUB_NUMBER",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PAYMENT_MODE",
											"type": "String"
										},
										"sink": {
											"name": "PAYMENT_MODE",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "STATUS_CODE",
											"type": "String"
										},
										"sink": {
											"name": "STATUS_CODE",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "MEMCLUBCOUNT",
											"type": "Int64"
										},
										"sink": {
											"name": "MEMCLUBCOUNT",
											"type": "Int64"
										}
									},
									{
										"source": {
											"name": "GETDATE()",
											"type": "DateTime"
										},
										"sink": {
											"name": "INSERTDATE",
											"type": "DateTime"
										}
									}
								]
							}
						},
						"inputs": [
							{
								"referenceName": "RPT_NZ_MEMBER_DIM_BIG_MEMBER",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "SNK_RPT_NZ_MEMBER_DIM_BIG_MEMBER",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"folder": {
					"name": "SNOWFLAKE_GET_DAILY_NETEEZA_COUNTS"
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/SNOWFLAKE_RPT_NZ_MEMBER_DIM_COUNT')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "INSERT SNOWFLAKE DAILY RPT_NZ_MEMBER_DIM_COUN",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SnowflakeSource",
								"query": "SELECT MEMBER_NUMBER_UNIQUE\n\t,ADD_TYPE\n\t,STATUS_CODE\n\t,IS_ACTIVE\n\t,TOTALCOUNT\n      ,GETDATE()\nFROM EDW.RPT_NZ_MEMBER_DIM_COUNT",
								"exportSettings": {
									"type": "SnowflakeExportCopyCommand"
								}
							},
							"sink": {
								"type": "SqlDWSink",
								"maxConcurrentConnections": 8,
								"allowCopyCommand": true,
								"copyCommandSettings": {},
								"disableMetricsCollection": false
							},
							"enableStaging": true,
							"stagingSettings": {
								"linkedServiceName": {
									"referenceName": "AzureBlob_PFSNOWINT",
									"type": "LinkedServiceReference"
								},
								"path": "snowimporthist",
								"enableCompression": true
							},
							"parallelCopies": 8,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "MEMBER_NUMBER_UNIQUE",
											"type": "String"
										},
										"sink": {
											"name": "MEMBER_NUMBER_UNIQUE",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ADD_TYPE",
											"type": "String"
										},
										"sink": {
											"name": "ADD_TYPE",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "STATUS_CODE",
											"type": "String"
										},
										"sink": {
											"name": "STATUS_CODE",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "IS_ACTIVE",
											"type": "Int64"
										},
										"sink": {
											"name": "IS_ACTIVE",
											"type": "Int16"
										}
									},
									{
										"source": {
											"name": "TOTALCOUNT",
											"type": "Int64"
										},
										"sink": {
											"name": "TOTALCOUNT",
											"type": "Int64"
										}
									},
									{
										"source": {
											"name": "GETDATE()",
											"type": "DateTime"
										},
										"sink": {
											"name": "INSERTDATE",
											"type": "DateTime"
										}
									}
								]
							}
						},
						"inputs": [
							{
								"referenceName": "RPT_NZ_MEMBER_DIM_COUNT",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "SNK_RPT_NZ_MEMBER_DIM_COUNT",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"folder": {
					"name": "SNOWFLAKE_GET_DAILY_NETEEZA_COUNTS"
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/SNOWFLAKE_RPT_NZ_MEMBER_DIM_MEMBER_TYPE')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "INSERT SNOWFLAKE DAILY RPT_NZ_MEMBER_DIM_MEMBER_TYPE",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SnowflakeSource",
								"query": "SELECT MEMBER_TYPE\n  \t  ,MEMTYPECOUNT\n      ,GETDATE()\nFROM EDW.RPT_NZ_MEMBER_DIM_MEMBER_TYPE",
								"exportSettings": {
									"type": "SnowflakeExportCopyCommand"
								}
							},
							"sink": {
								"type": "SqlDWSink",
								"maxConcurrentConnections": 8,
								"allowCopyCommand": true,
								"copyCommandSettings": {},
								"disableMetricsCollection": false
							},
							"enableStaging": true,
							"stagingSettings": {
								"linkedServiceName": {
									"referenceName": "AzureBlob_PFSNOWINT",
									"type": "LinkedServiceReference"
								},
								"path": "snowimporthist",
								"enableCompression": true
							},
							"parallelCopies": 8,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "MEMBER_TYPE",
											"type": "String"
										},
										"sink": {
											"name": "MEMBER_TYPE",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "MEMTYPECOUNT",
											"type": "Int64"
										},
										"sink": {
											"name": "MEMTYPECOUNT",
											"type": "Int64"
										}
									},
									{
										"source": {
											"name": "GETDATE()",
											"type": "DateTime"
										},
										"sink": {
											"name": "INSERTDATE",
											"type": "DateTime"
										}
									}
								]
							}
						},
						"inputs": [
							{
								"referenceName": "RPT_NZ_MEMBER_DIM_MEMBER_TYPE",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "SNK_RPT_NZ_MEMBER_DIM_MEMBER_TYPE",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"folder": {
					"name": "SNOWFLAKE_GET_DAILY_NETEEZA_COUNTS"
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/SNOWFLAKE_RPT_NZ_MEMBER_DIM_MONTHLY_DUES')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "INSERT SNOWFLAKE DAILY RPT_NZ_MEMBER_DIM_MONTHLY_DUES",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SnowflakeSource",
								"query": "SELECT  MONTHDUESUM\n      ,GETDATE()\nFROM EDW.RPT_NZ_MEMBER_DIM_MONTHLY_DUES",
								"exportSettings": {
									"type": "SnowflakeExportCopyCommand"
								}
							},
							"sink": {
								"type": "SqlDWSink",
								"maxConcurrentConnections": 8,
								"allowCopyCommand": true,
								"copyCommandSettings": {},
								"disableMetricsCollection": false
							},
							"enableStaging": true,
							"stagingSettings": {
								"linkedServiceName": {
									"referenceName": "AzureBlob_PFSNOWINT",
									"type": "LinkedServiceReference"
								},
								"path": "snowimporthist",
								"enableCompression": true
							},
							"parallelCopies": 8,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "MONTHDUESUM",
											"type": "Double"
										},
										"sink": {
											"name": "MONTHDUESUM",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "GETDATE()",
											"type": "DateTime"
										},
										"sink": {
											"name": "INSERTDATE",
											"type": "DateTime"
										}
									}
								]
							}
						},
						"inputs": [
							{
								"referenceName": "RPT_NZ_MEMBER_DIM_MONTHLY_DUES",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "SNK_RPT_NZ_MEMBER_DIM_MONTHLY_DUES",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"folder": {
					"name": "SNOWFLAKE_GET_DAILY_NETEEZA_COUNTS"
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/SNOWFLAKE_RPT_NZ_MEMBER_DIM_PAYMENT_TYPE')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "INSERT SNOWFLAKE DAILY RPT_NZ_MEMBER_DIM_PAYMENT_TYPE",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SnowflakeSource",
								"query": "SELECT PAYMENT_MODE\n\t,MEMPAYMENTCOUNT\n      ,GETDATE()\nFROM EDW.RPT_NZ_MEMBER_DIM_PAYMENT_TYPE",
								"exportSettings": {
									"type": "SnowflakeExportCopyCommand"
								}
							},
							"sink": {
								"type": "SqlDWSink",
								"maxConcurrentConnections": 8,
								"allowCopyCommand": true,
								"copyCommandSettings": {},
								"disableMetricsCollection": false
							},
							"enableStaging": true,
							"stagingSettings": {
								"linkedServiceName": {
									"referenceName": "AzureBlob_PFSNOWINT",
									"type": "LinkedServiceReference"
								},
								"path": "snowimporthist",
								"enableCompression": true
							},
							"parallelCopies": 8,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "PAYMENT_MODE",
											"type": "String"
										},
										"sink": {
											"name": "PAYMENT_MODE",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "MEMPAYMENTCOUNT",
											"type": "Int64"
										},
										"sink": {
											"name": "MEMPAYMENTCOUNT",
											"type": "Int64"
										}
									},
									{
										"source": {
											"name": "GETDATE()",
											"type": "DateTime"
										},
										"sink": {
											"name": "INSERTDATE",
											"type": "DateTime"
										}
									}
								]
							}
						},
						"inputs": [
							{
								"referenceName": "RPT_NZ_MEMBER_DIM_PAYMENT_TYPE",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "SNK_RPT_NZ_MEMBER_DIM_PAYMENT_TYPE",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"folder": {
					"name": "SNOWFLAKE_GET_DAILY_NETEEZA_COUNTS"
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/SNOWFLAKE_RPT_NZ_MEMBER_INVOICES_FACT')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "INSERT SNOWFLAKE DAILY RPT_NZ_MEMBER_INVOICES_FACT",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SnowflakeSource",
								"query": "SELECT MEMBER_NUMBER_UNIQUE\n\t,INVOICE_TYPE\n\t,INVOICE_AMOUNT\n\t,TOTALFACTMEMBERINVOICESCOUNT\n      ,GETDATE()\nFROM EDW.RPT_NZ_MEMBER_INVOICES_FACT",
								"exportSettings": {
									"type": "SnowflakeExportCopyCommand"
								}
							},
							"sink": {
								"type": "SqlDWSink",
								"maxConcurrentConnections": 8,
								"allowCopyCommand": true,
								"copyCommandSettings": {},
								"disableMetricsCollection": false
							},
							"enableStaging": true,
							"stagingSettings": {
								"linkedServiceName": {
									"referenceName": "AzureBlob_PFSNOWINT",
									"type": "LinkedServiceReference"
								},
								"path": "snowimporthist",
								"enableCompression": true
							},
							"parallelCopies": 8,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "MEMBER_NUMBER_UNIQUE",
											"type": "String"
										},
										"sink": {
											"name": "MEMBER_NUMBER_UNIQUE",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "INVOICE_TYPE",
											"type": "String"
										},
										"sink": {
											"name": "INVOICE_TYPE",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "INVOICE_AMOUNT",
											"type": "Int64"
										},
										"sink": {
											"name": "INVOICE_AMOUNT",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "TOTALFACTMEMBERINVOICESCOUNT",
											"type": "Int64"
										},
										"sink": {
											"name": "TOTALFACTMEMBERINVOICESCOUNT",
											"type": "Int64"
										}
									},
									{
										"source": {
											"name": "GETDATE()",
											"type": "DateTime"
										},
										"sink": {
											"name": "INSERTDATE",
											"type": "DateTime"
										}
									}
								]
							}
						},
						"inputs": [
							{
								"referenceName": "RPT_NZ_MEMBER_INVOICES_FACT",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "SNK_RPT_NZ_MEMBER_INVOICES_FACT",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"folder": {
					"name": "SNOWFLAKE_GET_DAILY_NETEEZA_COUNTS"
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/SNOWFLAKE_RPT_NZ_MEMBER_USAGE_FACT')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "INSERT SNOWFLAKE DAILY RPT_NZ_MEMBER_USAGE_FACT",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SnowflakeSource",
								"query": "SELECT  MEMBER_NUMBER_UNIQUE\n\t,HOME_CLUB_SNK\n\t,CAST (VISIT_DATE_TIME AS VARCHAR(26)) AS VISIT_DATE_TIME\n\t,TYPE_OF_CHECKIN_OR_AMENITY\n\t,TOTALMEMBERUSAGECOUNT\n      ,GETDATE()\nFROM EDW.RPT_NZ_MEMBER_USAGE_FACT",
								"exportSettings": {
									"type": "SnowflakeExportCopyCommand"
								}
							},
							"sink": {
								"type": "SqlDWSink",
								"maxConcurrentConnections": 8,
								"allowCopyCommand": true,
								"copyCommandSettings": {},
								"disableMetricsCollection": false
							},
							"enableStaging": true,
							"stagingSettings": {
								"linkedServiceName": {
									"referenceName": "AzureBlob_PFSNOWINT",
									"type": "LinkedServiceReference"
								},
								"path": "snowimporthist",
								"enableCompression": true
							},
							"parallelCopies": 8,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "MEMBER_NUMBER_UNIQUE",
											"type": "String"
										},
										"sink": {
											"name": "MEMBER_NUMBER_UNIQUE",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "HOME_CLUB_SNK",
											"type": "Int64"
										},
										"sink": {
											"name": "HOME_CLUB_SNK",
											"type": "Int64"
										}
									},
									{
										"source": {
											"name": "VISIT_DATE_TIME",
											"type": "DateTime"
										},
										"sink": {
											"name": "VISIT_DATE_TIME",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "TYPE_OF_CHECKIN_OR_AMENITY",
											"type": "String"
										},
										"sink": {
											"name": "TYPE_OF_CHECKIN_OR_AMENITY",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "TOTALMEMBERUSAGECOUNT",
											"type": "Int64"
										},
										"sink": {
											"name": "TOTALMEMBERUSAGECOUNT",
											"type": "Int64"
										}
									},
									{
										"source": {
											"name": "GETDATE()",
											"type": "DateTime"
										},
										"sink": {
											"name": "INSERTDATE",
											"type": "DateTime"
										}
									}
								]
							}
						},
						"inputs": [
							{
								"referenceName": "RPT_NZ_MEMBER_USAGE_FACT",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "SNK_RPT_NZ_MEMBER_USAGE_FACT",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"folder": {
					"name": "SNOWFLAKE_GET_DAILY_NETEEZA_COUNTS"
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/SNOWFLAKE_RPT_NZ_OFFER_DIM')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "INSERT SNOWFLAKE DAILY RPT_NZ_OFFER_DIM",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SnowflakeSource",
								"query": "SELECT OFFER_SNK\n\t,MEMBER_TYPE_SID\n\t,SPECIAL_OFFER_ID\n\t,TOTAOFFERLCOUNT\n      ,GETDATE()\nFROM EDW.RPT_NZ_OFFER_DIM",
								"exportSettings": {
									"type": "SnowflakeExportCopyCommand"
								}
							},
							"sink": {
								"type": "SqlDWSink",
								"maxConcurrentConnections": 8,
								"allowCopyCommand": true,
								"copyCommandSettings": {},
								"disableMetricsCollection": false
							},
							"enableStaging": true,
							"stagingSettings": {
								"linkedServiceName": {
									"referenceName": "AzureBlob_PFSNOWINT",
									"type": "LinkedServiceReference"
								},
								"path": "snowimporthist",
								"enableCompression": true
							},
							"parallelCopies": 8,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "OFFER_SNK",
											"type": "Int64"
										},
										"sink": {
											"name": "OFFER_SNK",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "MEMBER_TYPE_SID",
											"type": "Int64"
										},
										"sink": {
											"name": "MEMBER_TYPE_SID",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "SPECIAL_OFFER_ID",
											"type": "String"
										},
										"sink": {
											"name": "SPECIAL_OFFER_ID",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "TOTAOFFERLCOUNT",
											"type": "Int64"
										},
										"sink": {
											"name": "TOTAOFFERLCOUNT",
											"type": "Int64"
										}
									},
									{
										"source": {
											"name": "GETDATE()",
											"type": "DateTime"
										},
										"sink": {
											"name": "INSERTDATE",
											"type": "DateTime"
										}
									}
								]
							}
						},
						"inputs": [
							{
								"referenceName": "RPT_NZ_OFFER_DIM",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "SNK_RPT_NZ_OFFER_DIM",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"folder": {
					"name": "SNOWFLAKE_GET_DAILY_NETEEZA_COUNTS"
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/SNOWFLAKE_RPT_NZ_PAYMENT_CODE_DIM')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "INSERT SNOWFLAKE DAILY RPT_NZ_PAYMENT_CODE_DIM",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SnowflakeSource",
								"query": "SELECT  PAYMENT_CODE\n\t,PAYMENT_CODE_DESC\n\t,PAYMENT_CODE_TYPE\n\t,TOTALPAYMENTCOUNT\n      ,GETDATE()\nFROM EDW.RPT_NZ_PAYMENT_CODE_DIM",
								"exportSettings": {
									"type": "SnowflakeExportCopyCommand"
								}
							},
							"sink": {
								"type": "SqlDWSink",
								"maxConcurrentConnections": 8,
								"allowCopyCommand": true,
								"copyCommandSettings": {},
								"disableMetricsCollection": false
							},
							"enableStaging": true,
							"stagingSettings": {
								"linkedServiceName": {
									"referenceName": "AzureBlob_PFSNOWINT",
									"type": "LinkedServiceReference"
								},
								"path": "snowimporthist",
								"enableCompression": true
							},
							"parallelCopies": 8,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "PAYMENT_CODE",
											"type": "String"
										},
										"sink": {
											"name": "PAYMENT_CODE",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PAYMENT_CODE_DESC",
											"type": "String"
										},
										"sink": {
											"name": "PAYMENT_CODE_DESC",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PAYMENT_CODE_TYPE",
											"type": "String"
										},
										"sink": {
											"name": "PAYMENT_CODE_TYPE",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "TOTALPAYMENTCOUNT",
											"type": "Int64"
										},
										"sink": {
											"name": "TOTALPAYMENTCOUNT",
											"type": "Int64"
										}
									},
									{
										"source": {
											"name": "GETDATE()",
											"type": "DateTime"
										},
										"sink": {
											"name": "INSERTDATE",
											"type": "DateTime"
										}
									}
								]
							}
						},
						"inputs": [
							{
								"referenceName": "RPT_NZ_PAYMENT_CODE_DIM",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "SNK_RPT_NZ_PAYMENT_CODE_DIM",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"folder": {
					"name": "SNOWFLAKE_GET_DAILY_NETEEZA_COUNTS"
				},
				"annotations": []
			},
			"dependsOn": []
		}
	]
}