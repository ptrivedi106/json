{
	"$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
	"contentVersion": "1.0.0.0",
	"parameters": {
		"factoryName": {
			"type": "string",
			"metadata": "Data Factory name",
			"defaultValue": "PlanetFitnessDF"
		}
	},
	"variables": {
		"factoryId": "[concat('Microsoft.DataFactory/factories/', parameters('factoryName'))]"
	},
	"resources": [
		{
			"name": "[concat(parameters('factoryName'), '/MemberActionTypeLocations_SQLPOOL')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "ForEach1",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "Lookup1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('Lookup1').output.value",
								"type": "Expression"
							},
							"isSequential": false,
							"activities": [
								{
									"name": "MEMBERACTIONTYPELOCATIONS",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "OracleSource",
											"oracleReaderQuery": {
												"value": "select * from BETADATA.MEMBERACTIONTYPELOCATIONS t\nwhere matl_created>= TO_DATE('@{formatDateTime(pipeline().parameters.windowStart, 'yyyy-MM-dd HH:mm' )}', 'YYYY-MM-DD HH24:MI') \nAND matl_created< TO_DATE('@{formatDateTime(pipeline().parameters.windowEnd, 'yyyy-MM-dd HH:mm' )}', 'YYYY-MM-DD HH24:MI')\nAND VPD_ID in @{item().vpd_list}",
												"type": "Expression"
											},
											"partitionOption": "None",
											"convertDecimalToInteger": false
										},
										"sink": {
											"type": "SqlDWSink",
											"allowPolyBase": true,
											"polyBaseSettings": {
												"rejectValue": 0,
												"rejectType": "value",
												"useTypeDefault": false
											},
											"disableMetricsCollection": false
										},
										"enableStaging": true,
										"stagingSettings": {
											"linkedServiceName": {
												"referenceName": "AzureBlobStorage1",
												"type": "LinkedServiceReference"
											},
											"path": "vifiles"
										},
										"parallelCopies": 32,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "VPD_ID",
														"type": "Decimal"
													},
													"sink": {
														"name": "VPD_ID",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "M_ID",
														"type": "String"
													},
													"sink": {
														"name": "M_ID",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "MATL_ID",
														"type": "String"
													},
													"sink": {
														"name": "MATL_ID",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "MATL_CREATED",
														"type": "DateTime"
													},
													"sink": {
														"name": "MATL_CREATED",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"name": "SLOC_ID",
														"type": "String"
													},
													"sink": {
														"name": "SLOC_ID",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "AT_ID",
														"type": "String"
													},
													"sink": {
														"name": "AT_ID",
														"type": "String"
													}
												}
											]
										}
									},
									"inputs": [
										{
											"referenceName": "SRC_BETADATA",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "SNK_SYN_DT_MEMBERACTIONTYPELOCATIONS_INCR",
											"type": "DatasetReference",
											"parameters": {}
										}
									]
								}
							]
						}
					},
					{
						"name": "Lookup1",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Truncate Incr table",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderStoredProcedureName": "[[abcpi].[GetVPDToLoad]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "AzureSynapseAnalyticsDB",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": false
						}
					},
					{
						"name": "Truncate Incr table",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "truncate table StgDatatrak.STG_MEMBERACTIONTYPELOCATIONS_INCR;\nselect 0;",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "AzureSynapseAnalyticsDB",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": false
						}
					},
					{
						"name": "Merge to Staging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "ForEach1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[StgDatatrak].[STG_MEMBERACTIONTYPELOCATIONS_MERGE]"
						},
						"linkedServiceName": {
							"referenceName": "AzureSynapseAnalytics1",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"windowStart": {
						"type": "String"
					},
					"windowEnd": {
						"type": "String"
					}
				},
				"folder": {
					"name": "Oracle_SQLPOOL/Oracle_SQL_POOL_Group5"
				},
				"annotations": [],
				"lastPublishTime": "2023-02-08T11:25:31Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/MemberChildren_SQLPOOL')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "ForEach1",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "Lookup1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('Lookup1').output.value",
								"type": "Expression"
							},
							"isSequential": false,
							"activities": [
								{
									"name": "MemberChildren_SQLPOOL",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [
										{
											"name": "Source",
											"value": "."
										},
										{
											"name": "Destination",
											"value": "StgDatatrak.STG_MEMBERCHILDREN_INCR"
										}
									],
									"typeProperties": {
										"source": {
											"type": "OracleSource",
											"oracleReaderQuery": {
												"value": "select * from BETADATA.MEMBERCHILDREN\nwhere MCD_MODIFIED >= TO_DATE('@{formatDateTime(pipeline().parameters.windowStart, 'yyyy-MM-dd HH:mm' )}', 'YYYY-MM-DD HH24:MI') \nAND MCD_MODIFIED < TO_DATE('@{formatDateTime(pipeline().parameters.windowEnd, 'yyyy-MM-dd HH:mm' )}', 'YYYY-MM-DD HH24:MI')\nAND VPD_ID in @{item().vpd_list}",
												"type": "Expression"
											},
											"partitionOption": "None"
										},
										"sink": {
											"type": "SqlDWSink",
											"allowPolyBase": true,
											"polyBaseSettings": {
												"rejectValue": 0,
												"rejectType": "value",
												"useTypeDefault": false
											}
										},
										"enableStaging": true,
										"stagingSettings": {
											"linkedServiceName": {
												"referenceName": "AzureBlobStorage1",
												"type": "LinkedServiceReference"
											},
											"path": "vifiles"
										},
										"parallelCopies": 32,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "VPD_ID",
														"type": "Decimal"
													},
													"sink": {
														"name": "VPD_ID",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "MCD_ID",
														"type": "String"
													},
													"sink": {
														"name": "MCD_ID",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "MCD_CREATED",
														"type": "DateTime"
													},
													"sink": {
														"name": "MCD_CREATED",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"name": "MOD_CREATED_LOCAL",
														"type": "DateTime"
													},
													"sink": {
														"name": "MOD_CREATED_LOCAL",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"name": "MCD_MODIFIED",
														"type": "DateTime"
													},
													"sink": {
														"name": "MCD_MODIFIED",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"name": "MCD_ACTIVE",
														"type": "String"
													},
													"sink": {
														"name": "MCD_ACTIVE",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "MCD_NAME_LAST",
														"type": "String"
													},
													"sink": {
														"name": "MCD_NAME_LAST",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "MCD_NAME_FIRST",
														"type": "String"
													},
													"sink": {
														"name": "MCD_NAME_FIRST",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "MCD_NAME_MI",
														"type": "String"
													},
													"sink": {
														"name": "MCD_NAME_MI",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "MCD_NAME_FIRST_LAST",
														"type": "String"
													},
													"sink": {
														"name": "MCD_NAME_FIRST_LAST",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "MCD_NAME_LAST_FIRST",
														"type": "String"
													},
													"sink": {
														"name": "MCD_NAME_LAST_FIRST",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "MCD_GENDER",
														"type": "Decimal"
													},
													"sink": {
														"name": "MCD_GENDER",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "MCD_BIRTHDATE",
														"type": "DateTime"
													},
													"sink": {
														"name": "MCD_BIRTHDATE",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"name": "MCD_BARCODE",
														"type": "String"
													},
													"sink": {
														"name": "MCD_BARCODE",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "MCD_EMERGENCY_NAME_LAST",
														"type": "String"
													},
													"sink": {
														"name": "MCD_EMERGENCY_NAME_LAST",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "MCD_EMERGENCY_NAME_FIRST",
														"type": "String"
													},
													"sink": {
														"name": "MCD_EMERGENCY_NAME_FIRST",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "MCD_EMERGENCY_MI",
														"type": "String"
													},
													"sink": {
														"name": "MCD_EMERGENCY_MI",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "MCD_EMERGENCY_NAME_FIRST_LAST",
														"type": "String"
													},
													"sink": {
														"name": "MCD_EMERGENCY_NAME_FIRST_LAST",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "MCD_EMERGENCY_NAME_LAST_FIRST",
														"type": "String"
													},
													"sink": {
														"name": "MCD_EMERGENCY_NAME_LAST_FIRST",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "MCD_EMERGENCY_PHONE",
														"type": "String"
													},
													"sink": {
														"name": "MCD_EMERGENCY_PHONE",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "MCD_EMERGENCY_EXT",
														"type": "String"
													},
													"sink": {
														"name": "MCD_EMERGENCY_EXT",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "MCD_EMERGENCY_AVAILABILITY",
														"type": "String"
													},
													"sink": {
														"name": "MCD_EMERGENCY_AVAILABILITY",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "MCD_LAST_CHECKIN_DATE",
														"type": "DateTime"
													},
													"sink": {
														"name": "MCD_LAST_CHECKIN_DATE",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"name": "MCD_MISC_1",
														"type": "String"
													},
													"sink": {
														"name": "MCD_MISC_1",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "MCD_MISC_2",
														"type": "String"
													},
													"sink": {
														"name": "MCD_MISC_2",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "MCD_MISC_3",
														"type": "String"
													},
													"sink": {
														"name": "MCD_MISC_3",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "A_ID",
														"type": "String"
													},
													"sink": {
														"name": "A_ID",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "FP_ID",
														"type": "String"
													},
													"sink": {
														"name": "FP_ID",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "MP_ID",
														"type": "String"
													},
													"sink": {
														"name": "MP_ID",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "TZL_ID_CREATED",
														"type": "String"
													},
													"sink": {
														"name": "TZL_ID_CREATED",
														"type": "String"
													}
												}
											]
										}
									},
									"inputs": [
										{
											"referenceName": "SRC_BETADATA_MEMBERCHILDREN",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "SNK_SYN_DT_MEMBERCHILDREN_INCR",
											"type": "DatasetReference",
											"parameters": {}
										}
									]
								}
							]
						}
					},
					{
						"name": "Lookup1",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Truncate Incr table",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderStoredProcedureName": "[[abcpi].[GetVPDToLoad]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "AzureSynapseAnalyticsDB",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": false
						}
					},
					{
						"name": "Truncate Incr table",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "truncate table StgDatatrak.stg_memberCHILDREN_incr;\nselect 0;",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "AzureSynapseAnalyticsDB",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Merge to Staging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "ForEach1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[StgDatatrak].[STG_MEMBERCHILDREN_MERGE]"
						},
						"linkedServiceName": {
							"referenceName": "AzureSynapseAnalytics1",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"windowStart": {
						"type": "String"
					},
					"windowEnd": {
						"type": "String"
					}
				},
				"folder": {
					"name": "Oracle_SQLPOOL/Oracle_SQL_POOL_Group3"
				},
				"annotations": [],
				"lastPublishTime": "2023-02-08T11:25:30Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Membereventsummary_SQLPOOL')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "ForEach1",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "Lookup1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('Lookup1').output.value",
								"type": "Expression"
							},
							"isSequential": false,
							"activities": [
								{
									"name": "MEMBEREVENTSUMMARY_SQLPOOL",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [
										{
											"name": "Source",
											"value": "."
										},
										{
											"name": "Destination",
											"value": "StgDatatrak.STG_MEMBEREVENTSUMMARY_INCR"
										}
									],
									"typeProperties": {
										"source": {
											"type": "OracleSource",
											"oracleReaderQuery": {
												"value": "select * from BETADATA.MEMBEREVENTSUMMARY\nwhere MES_LAST_BOOKED_DATE >= TO_DATE('@{formatDateTime(pipeline().parameters.windowStart, 'yyyy-MM-dd HH:mm' )}', 'YYYY-MM-DD HH24:MI') \nAND MES_LAST_BOOKED_DATE < TO_DATE('@{formatDateTime(pipeline().parameters.windowEnd, 'yyyy-MM-dd HH:mm' )}', 'YYYY-MM-DD HH24:MI')\nAND VPD_ID  in @{item().vpd_list}",
												"type": "Expression"
											},
											"partitionOption": "None"
										},
										"sink": {
											"type": "SqlDWSink",
											"allowPolyBase": true,
											"polyBaseSettings": {
												"rejectValue": 0,
												"rejectType": "value",
												"useTypeDefault": false
											}
										},
										"enableStaging": true,
										"stagingSettings": {
											"linkedServiceName": {
												"referenceName": "AzureBlobStorage1",
												"type": "LinkedServiceReference"
											},
											"path": "vifiles"
										},
										"parallelCopies": 32,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "VPD_ID",
														"type": "Decimal"
													},
													"sink": {
														"name": "VPD_ID",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "SPL_ID",
														"type": "String"
													},
													"sink": {
														"name": "SPL_ID",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "M_ID",
														"type": "String"
													},
													"sink": {
														"name": "M_ID",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "ET_ID",
														"type": "String"
													},
													"sink": {
														"name": "ET_ID",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "ETL_ID",
														"type": "String"
													},
													"sink": {
														"name": "ETL_ID",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "MES_COMPLETED_COUNT",
														"type": "Decimal"
													},
													"sink": {
														"name": "MES_COMPLETED_COUNT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "MES_CANCEL_CHARGE_COUNT",
														"type": "Decimal"
													},
													"sink": {
														"name": "MES_CANCEL_CHARGE_COUNT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "MES_CANCEL_NO_CHARGE_COUNT",
														"type": "Decimal"
													},
													"sink": {
														"name": "MES_CANCEL_NO_CHARGE_COUNT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "MES_PENDING_COUNT",
														"type": "Decimal"
													},
													"sink": {
														"name": "MES_PENDING_COUNT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "MES_DEDUCTED_COUNT",
														"type": "Decimal"
													},
													"sink": {
														"name": "MES_DEDUCTED_COUNT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "MES_UNFUNDED_COUNT",
														"type": "Decimal"
													},
													"sink": {
														"name": "MES_UNFUNDED_COUNT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "MES_LAST_BOOKED_DATE",
														"type": "DateTime"
													},
													"sink": {
														"name": "MES_LAST_BOOKED_DATE",
														"type": "DateTime"
													}
												}
											]
										}
									},
									"inputs": [
										{
											"referenceName": "SRC_BETADATA_MEMBEREVENTSUMMARY",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "SNK_SYN_DT_MEMBEREVENTSUMMARY_INCR",
											"type": "DatasetReference",
											"parameters": {}
										}
									]
								}
							]
						}
					},
					{
						"name": "Lookup1",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "truncate incr table",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderStoredProcedureName": "[[abcpi].[GetVPDToLoad]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "AzureSynapseAnalyticsDB",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": false
						}
					},
					{
						"name": "truncate incr table",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "truncate table StgDatatrak.[STG_memberEVENTsummary_INCR];\nselect 0;\n",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "AzureSynapseAnalyticsDB",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Merge to Staging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "ForEach1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[StgDatatrak].[STG_MEMBEREVENTSUMMARY_MERGE]"
						},
						"linkedServiceName": {
							"referenceName": "AzureSynapseAnalytics1",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"windowStart": {
						"type": "String"
					},
					"windowEnd": {
						"type": "String"
					}
				},
				"folder": {
					"name": "Oracle_SQLPOOL/Oracle_SQL_POOL_Group3"
				},
				"annotations": [],
				"lastPublishTime": "2023-02-08T11:25:32Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Members_SQLPOOL')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "ForEach1",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "Lookup1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('Lookup1').output.value",
								"type": "Expression"
							},
							"isSequential": false,
							"activities": [
								{
									"name": "Members",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "OracleSource",
											"oracleReaderQuery": {
												"value": "select /*+INDEX(t,MEMBERS_MODIFIED) */ * from BETADATA.MEMBERS t\nwhere M_MODIFIED >= TO_DATE('@{formatDateTime(pipeline().parameters.windowStart, 'yyyy-MM-dd HH:mm' )}', 'YYYY-MM-DD HH24:MI') \nAND M_MODIFIED < TO_DATE('@{formatDateTime(pipeline().parameters.windowEnd, 'yyyy-MM-dd HH:mm' )}', 'YYYY-MM-DD HH24:MI')\nAND VPD_ID in @{item().vpd_list}\nAND (M_BIRTHDATE >= '1900-01-01' OR M_BIRTHDATE is null)",
												"type": "Expression"
											},
											"partitionOption": "None"
										},
										"sink": {
											"type": "SqlDWSink",
											"allowPolyBase": true,
											"polyBaseSettings": {
												"rejectValue": 0,
												"rejectType": "value",
												"useTypeDefault": false
											}
										},
										"enableStaging": true,
										"stagingSettings": {
											"linkedServiceName": {
												"referenceName": "AzureBlobStorage1",
												"type": "LinkedServiceReference"
											},
											"path": "vifiles"
										},
										"parallelCopies": 32,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "VPD_ID",
														"type": "Decimal"
													},
													"sink": {
														"name": "VPD_ID",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "M_ID",
														"type": "String"
													},
													"sink": {
														"name": "M_ID",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "M_CREATED",
														"type": "DateTime"
													},
													"sink": {
														"name": "M_CREATED",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"name": "M_CREATED_LOCAL",
														"type": "DateTime"
													},
													"sink": {
														"name": "M_CREATED_LOCAL",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"name": "M_MODIFIED",
														"type": "DateTime"
													},
													"sink": {
														"name": "M_MODIFIED",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"name": "M_ACTIVE",
														"type": "String"
													},
													"sink": {
														"name": "M_ACTIVE",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "M_NAME_PREFIX",
														"type": "String"
													},
													"sink": {
														"name": "M_NAME_PREFIX",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "M_NAME_LAST",
														"type": "String"
													},
													"sink": {
														"name": "M_NAME_LAST",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "M_NAME_FIRST",
														"type": "String"
													},
													"sink": {
														"name": "M_NAME_FIRST",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "M_NAME_MI",
														"type": "String"
													},
													"sink": {
														"name": "M_NAME_MI",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "M_NAME_FIRST_LAST",
														"type": "String"
													},
													"sink": {
														"name": "M_NAME_FIRST_LAST",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "M_NAME_LAST_FIRST",
														"type": "String"
													},
													"sink": {
														"name": "M_NAME_LAST_FIRST",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "M_ADDRESS",
														"type": "String"
													},
													"sink": {
														"name": "M_ADDRESS",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "M_CITY",
														"type": "String"
													},
													"sink": {
														"name": "M_CITY",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "M_ZIP",
														"type": "String"
													},
													"sink": {
														"name": "M_ZIP",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "M_EMAIL",
														"type": "String"
													},
													"sink": {
														"name": "M_EMAIL",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "M_PHONE_HOME",
														"type": "String"
													},
													"sink": {
														"name": "M_PHONE_HOME",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "M_PHONE_CELL",
														"type": "String"
													},
													"sink": {
														"name": "M_PHONE_CELL",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "M_PHONE_WORK",
														"type": "String"
													},
													"sink": {
														"name": "M_PHONE_WORK",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "M_PHONE_WORK_EXT",
														"type": "String"
													},
													"sink": {
														"name": "M_PHONE_WORK_EXT",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "M_PHONE_FAX",
														"type": "String"
													},
													"sink": {
														"name": "M_PHONE_FAX",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "M_BIRTHDATE",
														"type": "DateTime"
													},
													"sink": {
														"name": "M_BIRTHDATE",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"name": "M_GENDER",
														"type": "Decimal"
													},
													"sink": {
														"name": "M_GENDER",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "M_OCCUPATION",
														"type": "String"
													},
													"sink": {
														"name": "M_OCCUPATION",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "M_EMPLOYER",
														"type": "String"
													},
													"sink": {
														"name": "M_EMPLOYER",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "M_AVAILABILITY",
														"type": "String"
													},
													"sink": {
														"name": "M_AVAILABILITY",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "M_EMERGENCY_LAST_NAME",
														"type": "String"
													},
													"sink": {
														"name": "M_EMERGENCY_LAST_NAME",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "M_EMERGENCY_FIRST_NAME",
														"type": "String"
													},
													"sink": {
														"name": "M_EMERGENCY_FIRST_NAME",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "M_EMERGENCY_MI",
														"type": "String"
													},
													"sink": {
														"name": "M_EMERGENCY_MI",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "M_EMERGENCY_NAME_FIRST_LAST",
														"type": "String"
													},
													"sink": {
														"name": "M_EMERGENCY_NAME_FIRST_LAST",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "M_EMERGENCY_NAME_LAST_FIRST",
														"type": "String"
													},
													"sink": {
														"name": "M_EMERGENCY_NAME_LAST_FIRST",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "M_EMERGENCY_PHONE",
														"type": "String"
													},
													"sink": {
														"name": "M_EMERGENCY_PHONE",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "M_EMERGENCY_EXT",
														"type": "String"
													},
													"sink": {
														"name": "M_EMERGENCY_EXT",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "M_EMERGENCY_AVAILABILITY",
														"type": "String"
													},
													"sink": {
														"name": "M_EMERGENCY_AVAILABILITY",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "M_BARCODE",
														"type": "String"
													},
													"sink": {
														"name": "M_BARCODE",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "M_STATUS",
														"type": "String"
													},
													"sink": {
														"name": "M_STATUS",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "M_ABC_STATUS_REASON",
														"type": "String"
													},
													"sink": {
														"name": "M_ABC_STATUS_REASON",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "M_ABC_STATUS",
														"type": "String"
													},
													"sink": {
														"name": "M_ABC_STATUS",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "M_ABC_ORDINAL",
														"type": "Decimal"
													},
													"sink": {
														"name": "M_ABC_ORDINAL",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "M_SKIP_EMAIL_ALERT",
														"type": "String"
													},
													"sink": {
														"name": "M_SKIP_EMAIL_ALERT",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "M_RELATION_TO_PRIMARY",
														"type": "String"
													},
													"sink": {
														"name": "M_RELATION_TO_PRIMARY",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "M_CARDS_REISSUED",
														"type": "Decimal"
													},
													"sink": {
														"name": "M_CARDS_REISSUED",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "M_LAST_CHECKIN_DATE",
														"type": "DateTime"
													},
													"sink": {
														"name": "M_LAST_CHECKIN_DATE",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"name": "M_WEIGHT_START",
														"type": "Decimal"
													},
													"sink": {
														"name": "M_WEIGHT_START",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "M_WEIGHT_TARGET",
														"type": "Decimal"
													},
													"sink": {
														"name": "M_WEIGHT_TARGET",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "M_FAF_CONVERTED",
														"type": "Decimal"
													},
													"sink": {
														"name": "M_FAF_CONVERTED",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "M_MISC_1",
														"type": "String"
													},
													"sink": {
														"name": "M_MISC_1",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "M_MISC_2",
														"type": "String"
													},
													"sink": {
														"name": "M_MISC_2",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "M_MISC_3",
														"type": "String"
													},
													"sink": {
														"name": "M_MISC_3",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "M_PRE_PAY_AMOUNT",
														"type": "Decimal"
													},
													"sink": {
														"name": "M_PRE_PAY_AMOUNT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "M_CHARGES_ALLOWED",
														"type": "String"
													},
													"sink": {
														"name": "M_CHARGES_ALLOWED",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "M_CREDIT_LIMIT",
														"type": "Decimal"
													},
													"sink": {
														"name": "M_CREDIT_LIMIT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "M_FINGERPRINT",
														"type": "Byte[]"
													},
													"sink": {
														"name": "M_FINGERPRINT",
														"type": "Byte[]"
													}
												},
												{
													"source": {
														"name": "M_CLUB_ACCOUNT_BILL_VIA_ABC",
														"type": "String"
													},
													"sink": {
														"name": "M_CLUB_ACCOUNT_BILL_VIA_ABC",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "A_ID",
														"type": "String"
													},
													"sink": {
														"name": "A_ID",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "ATL_ID",
														"type": "String"
													},
													"sink": {
														"name": "ATL_ID",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "CAPM_ID",
														"type": "String"
													},
													"sink": {
														"name": "CAPM_ID",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "G_ID",
														"type": "String"
													},
													"sink": {
														"name": "G_ID",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "TZL_ID_CREATED_LOCAL",
														"type": "String"
													},
													"sink": {
														"name": "TZL_ID_CREATED_LOCAL",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "STL_ID",
														"type": "String"
													},
													"sink": {
														"name": "STL_ID",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "MP_ID",
														"type": "String"
													},
													"sink": {
														"name": "MP_ID",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "M_CHECKIN_COUNT",
														"type": "Decimal"
													},
													"sink": {
														"name": "M_CHECKIN_COUNT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "M_DELETED",
														"type": "DateTime"
													},
													"sink": {
														"name": "M_DELETED",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"name": "E_ID_DELETED",
														"type": "String"
													},
													"sink": {
														"name": "E_ID_DELETED",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "M_RECEIVE_EMAIL",
														"type": "String"
													},
													"sink": {
														"name": "M_RECEIVE_EMAIL",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "M_CONFIRM_EMAIL",
														"type": "DateTime"
													},
													"sink": {
														"name": "M_CONFIRM_EMAIL",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"name": "M_MEMBER_ACTIVITIES_COUNT",
														"type": "Decimal"
													},
													"sink": {
														"name": "M_MEMBER_ACTIVITIES_COUNT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "M_CONFIRM_EMAIL_SENT",
														"type": "DateTime"
													},
													"sink": {
														"name": "M_CONFIRM_EMAIL_SENT",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"name": "M_PHONE_HOME_TEXT",
														"type": "String"
													},
													"sink": {
														"name": "M_PHONE_HOME_TEXT",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "M_PHONE_CELL_TEXT",
														"type": "String"
													},
													"sink": {
														"name": "M_PHONE_CELL_TEXT",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "M_PHONE_WORK_TEXT",
														"type": "String"
													},
													"sink": {
														"name": "M_PHONE_WORK_TEXT",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "M_CONFIRM_TEXT",
														"type": "DateTime"
													},
													"sink": {
														"name": "M_CONFIRM_TEXT",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"name": "M_CREATED_AS_PROSPECT",
														"type": "String"
													},
													"sink": {
														"name": "M_CREATED_AS_PROSPECT",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "M_EMAIL_HOLD",
														"type": "String"
													},
													"sink": {
														"name": "M_EMAIL_HOLD",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "M_SMS_HOLD",
														"type": "String"
													},
													"sink": {
														"name": "M_SMS_HOLD",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "UDFTAB_ID",
														"type": "Decimal"
													},
													"sink": {
														"name": "UDFTAB_ID",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "UDFV_ID",
														"type": "String"
													},
													"sink": {
														"name": "UDFV_ID",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "M_ACCESS_CODE",
														"type": "String"
													},
													"sink": {
														"name": "M_ACCESS_CODE",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "M_ACCESS_CODE_FAILURES",
														"type": "Decimal"
													},
													"sink": {
														"name": "M_ACCESS_CODE_FAILURES",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "M_CLUB_ACCOUNT_IN_USE",
														"type": "String"
													},
													"sink": {
														"name": "M_CLUB_ACCOUNT_IN_USE",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "AI_ID_CLUB_ACCOUNT",
														"type": "String"
													},
													"sink": {
														"name": "AI_ID_CLUB_ACCOUNT",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "AI_ID_CARD_ON_FILE",
														"type": "String"
													},
													"sink": {
														"name": "AI_ID_CARD_ON_FILE",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "M_MODIFIED_DW",
														"type": "DateTime"
													},
													"sink": {
														"name": "M_MODIFIED_DW",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"name": "M_ADDRESS_2",
														"type": "String"
													},
													"sink": {
														"name": "M_ADDRESS_2",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "M_REMOTE_CHECKIN_COUNT",
														"type": "Decimal"
													},
													"sink": {
														"name": "M_REMOTE_CHECKIN_COUNT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "M_CONVERSION_AGREEMENT_NUMBER",
														"type": "String"
													},
													"sink": {
														"name": "M_CONVERSION_AGREEMENT_NUMBER",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "M_SILVER_SNEAKERS_ID",
														"type": "String"
													},
													"sink": {
														"name": "M_SILVER_SNEAKERS_ID",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "CTL_ID",
														"type": "String"
													},
													"sink": {
														"name": "CTL_ID",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "CTL_DEFAULT",
														"type": "String"
													},
													"sink": {
														"name": "CTL_DEFAULT",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "M_CLUB_CREDIT_LIMIT",
														"type": "Decimal"
													},
													"sink": {
														"name": "M_CLUB_CREDIT_LIMIT",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "M_CLUB_CREDIT_LIMIT_OVERRIDE",
														"type": "String"
													},
													"sink": {
														"name": "M_CLUB_CREDIT_LIMIT_OVERRIDE",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "M_MODIFIED_API",
														"type": "DateTime"
													},
													"sink": {
														"name": "M_MODIFIED_API",
														"type": "DateTime"
													}
												}
											]
										}
									},
									"inputs": [
										{
											"referenceName": "SRC_BETADATA_MEMBERS",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "SNK_SYN_DT_STG_MEMBERS_INCR",
											"type": "DatasetReference",
											"parameters": {}
										}
									]
								}
							]
						}
					},
					{
						"name": "Lookup1",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Truncate incr table",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderStoredProcedureName": "[[abcpi].[GetVPDToLoad]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "AzureSynapseAnalyticsDB",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": false
						}
					},
					{
						"name": "Truncate incr table",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "truncate table StgDatatrak.stg_members_incr;\nselect 0;",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "AzureSynapseAnalyticsDB",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Merge to Staging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "ForEach1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[StgDatatrak].[Stg_Members_Merge]"
						},
						"linkedServiceName": {
							"referenceName": "AzureSynapseAnalytics1",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"windowStart": {
						"type": "String"
					},
					"windowEnd": {
						"type": "String"
					}
				},
				"folder": {
					"name": "Oracle_SQLPOOL/Oracle_SQL_POOL_Group1"
				},
				"annotations": [],
				"lastPublishTime": "2023-02-08T11:25:33Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/MembershipCampaigns_SQLPOOL')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "ForEach1",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "Lookup1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('Lookup1').output.value",
								"type": "Expression"
							},
							"isSequential": false,
							"activities": [
								{
									"name": "MembershipCampaign_SQLPOOL",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [
										{
											"name": "Source",
											"value": "BETADATA.MEMBERSHIPCAMPAIGNS"
										},
										{
											"name": "Destination",
											"value": "StgDatatrak.STG_MEMBERSHIPCAMPAIGNS_INCR"
										}
									],
									"typeProperties": {
										"source": {
											"type": "OracleSource",
											"oracleReaderQuery": {
												"value": "select * from BETADATA.MEMBERSHIPCAMPAIGNS\nwhere MC_MODIFIED >= TO_DATE('@{formatDateTime(pipeline().parameters.windowStart, 'yyyy-MM-dd HH:mm' )}', 'YYYY-MM-DD HH24:MI') \nAND MC_MODIFIED < TO_DATE('@{formatDateTime(pipeline().parameters.windowEnd, 'yyyy-MM-dd HH:mm' )}', 'YYYY-MM-DD HH24:MI')\nAND VPD_ID in @{item().vpd_list}",
												"type": "Expression"
											},
											"partitionOption": "None"
										},
										"sink": {
											"type": "SqlDWSink",
											"allowPolyBase": true,
											"polyBaseSettings": {
												"rejectValue": 0,
												"rejectType": "value",
												"useTypeDefault": false
											}
										},
										"enableStaging": true,
										"stagingSettings": {
											"linkedServiceName": {
												"referenceName": "AzureBlobStorage1",
												"type": "LinkedServiceReference"
											},
											"path": "vifiles"
										},
										"parallelCopies": 32,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "VPD_ID",
														"type": "Decimal"
													},
													"sink": {
														"name": "VPD_ID",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "MC_ID",
														"type": "String"
													},
													"sink": {
														"name": "MC_ID",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "MC_CREATED",
														"type": "DateTime"
													},
													"sink": {
														"name": "MC_CREATED",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"name": "MC_MODIFIED",
														"type": "DateTime"
													},
													"sink": {
														"name": "MC_MODIFIED",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"name": "MC_ACTIVE",
														"type": "String"
													},
													"sink": {
														"name": "MC_ACTIVE",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "MC_NAME",
														"type": "String"
													},
													"sink": {
														"name": "MC_NAME",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "MC_DESCRIPTION",
														"type": "String"
													},
													"sink": {
														"name": "MC_DESCRIPTION",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "MC_ABC_CODE",
														"type": "String"
													},
													"sink": {
														"name": "MC_ABC_CODE",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "MC_COMMENTS",
														"type": "String"
													},
													"sink": {
														"name": "MC_COMMENTS",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "MCG_ID",
														"type": "String"
													},
													"sink": {
														"name": "MCG_ID",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "MC_AGREEMENT",
														"type": "String"
													},
													"sink": {
														"name": "MC_AGREEMENT",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "MC_RECURRING_SERVICE",
														"type": "String"
													},
													"sink": {
														"name": "MC_RECURRING_SERVICE",
														"type": "String"
													}
												}
											]
										}
									},
									"inputs": [
										{
											"referenceName": "SRC_BETADATA_MEMBERSHIPCAMPAIGNS",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "SNK_SYN_DT_MEMBERSHIPCAMPAIGNS_INCR",
											"type": "DatasetReference",
											"parameters": {}
										}
									]
								}
							]
						}
					},
					{
						"name": "Lookup1",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Truncate Incr Table",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderStoredProcedureName": "[[abcpi].[GetVPDToLoad]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "AzureSynapseAnalyticsDB",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": false
						}
					},
					{
						"name": "Truncate Incr Table",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "truncate table StgDatatrak.stg_membershipcampaigns_incr;\nselect 0;",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "AzureSynapseAnalyticsDB",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Merge to Staging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "ForEach1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[StgDatatrak].[STG_MEMBERSHIPCAMPAIGNS_MERGE]"
						},
						"linkedServiceName": {
							"referenceName": "AzureSynapseAnalytics1",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"windowStart": {
						"type": "String"
					},
					"windowEnd": {
						"type": "String"
					}
				},
				"folder": {
					"name": "Oracle_SQLPOOL/Oracle_SQL_POOL_Group3"
				},
				"annotations": [],
				"lastPublishTime": "2023-02-08T11:25:30Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/PAYMENTSCHEDULEFREQUENCIES_SQLPOOL')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "PaymentScheduleFrequencies_SQLPOOL",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "OracleSource",
								"oracleReaderQuery": "select * from betadata.paymentschedulefrequencies;",
								"partitionOption": "None",
								"queryTimeout": "02:00:00"
							},
							"sink": {
								"type": "SqlDWSink",
								"preCopyScript": "truncate table StgDatatrak.stg_paymentschedulefrequencies_incr;",
								"allowPolyBase": true,
								"polyBaseSettings": {
									"rejectValue": 0,
									"rejectType": "value",
									"useTypeDefault": false
								},
								"disableMetricsCollection": false
							},
							"enableStaging": true,
							"stagingSettings": {
								"linkedServiceName": {
									"referenceName": "AzureBlobStorage1",
									"type": "LinkedServiceReference"
								},
								"path": "vifiles"
							},
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "PSF_ID",
											"type": "String"
										},
										"sink": {
											"name": "PSF_ID",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PSF_NAME",
											"type": "String"
										},
										"sink": {
											"name": "PSF_NAME",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PSF_ABC_CODE",
											"type": "String"
										},
										"sink": {
											"name": "PSF_ABC_CODE",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PSF_SORT_ORDER",
											"type": "Decimal"
										},
										"sink": {
											"name": "PSF_SORT_ORDER",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "PSF_DAYS",
											"type": "Decimal"
										},
										"sink": {
											"name": "PSF_DAYS",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "PSF_OPEN_MULTIPLIER",
											"type": "Decimal"
										},
										"sink": {
											"name": "PSF_OPEN_MULTIPLIER",
											"type": "Decimal"
										}
									}
								]
							}
						},
						"inputs": [
							{
								"referenceName": "SRC_BETADATA_PAYMENTSCHEDULEFREQUENCIES",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "SNK_SYN_DT_PAYMENTSCHEDULEFREQUENCIES_INCR",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Merge to Staging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "PaymentScheduleFrequencies_SQLPOOL",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[StgDatatrak].[STG_PAYMENTSCHEDULEFREQUENCIES_MERGE]"
						},
						"linkedServiceName": {
							"referenceName": "AzureSynapseAnalytics1",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"folder": {
					"name": "Oracle_SQLPOOL/Oracle_SQL_POOL_GroupNoDate"
				},
				"annotations": [],
				"lastPublishTime": "2023-02-08T11:25:31Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/PF_ACTIVE_MEMBERS_SMRY_VW')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Copy data Iseries",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "DELETE table Sink",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "OracleSource",
								"oracleReaderQuery": "SELECT ETL_DATE_KEY\n      ,CLUB_NUMBER_I\n      ,ACTIVE_MEMBERS\n      ,COALESCE(TOTAL_COUNT,0) as TOTAL_COUNT\n      ,COALESCE(TOTAL_AMOUNT,0.00) as TOTAL_AMOUNT\n\t  ,'EDW' as Source\nFROM DW.PF_ACTIVE_MEMBERS_SMRY_VW",
								"partitionOption": "None",
								"queryTimeout": "02:00:00"
							},
							"sink": {
								"type": "SqlDWSink",
								"maxConcurrentConnections": 6,
								"allowPolyBase": true,
								"polyBaseSettings": {
									"rejectValue": 0,
									"rejectType": "value",
									"useTypeDefault": true
								},
								"disableMetricsCollection": false
							},
							"enableStaging": true,
							"stagingSettings": {
								"linkedServiceName": {
									"referenceName": "AzureBlobStorage1",
									"type": "LinkedServiceReference"
								},
								"path": "pfviewsoracle",
								"enableCompression": true
							},
							"parallelCopies": 8,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "ETL_DATE_KEY",
											"type": "Decimal"
										},
										"sink": {
											"name": "ETL_DATE_KEY",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "CLUB_NUMBER_I",
											"type": "Decimal"
										},
										"sink": {
											"name": "CLUB_NUMBER_I",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ACTIVE_MEMBERS",
											"type": "String"
										},
										"sink": {
											"name": "ACTIVE_MEMBERS",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "TOTAL_COUNT",
											"type": "Double"
										},
										"sink": {
											"name": "TOTAL_COUNT",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "TOTAL_AMOUNT",
											"type": "Double"
										},
										"sink": {
											"name": "TOTAL_AMOUNT",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "SOURCE",
											"type": "String"
										},
										"sink": {
											"name": "Source",
											"type": "String"
										}
									}
								]
							}
						},
						"inputs": [
							{
								"referenceName": "SRC_PF_PF_ACTIVE_MEMBERS_SMRY_VW",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "SNK_SYN_PF_ACTIVE_MEMBERS_SMRY",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "DELETE table Sink",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Check Did Job Success",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "DELETE FROM  [DW].[PF_ACTIVE_MEMBERS_SMRY]\nWHERE SOURCE='EDW';\nselect 1;",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "SNK_SYN_PF_ACTIVE_MEMBERS_SMRY",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": true
						}
					},
					{
						"name": "Get Job Status",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "select 1\nfrom [dbo].[PF_VIEWS_JOBS_CHECK] \nwhere finish_time = cast(GETDATE() AT TIME ZONE 'UTC' AT TIME ZONE 'Eastern Standard Time' AS DATE) \nand FBI_JOB_NAME= 'PF.EFT_ALLOCATIONS_PR' and job_completed=1",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "SNK_DBO_PF_VIEWS_JOBS_CHECK",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "check Oracle Job",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Get Job Status",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "OracleSource",
								"oracleReaderQuery": "select JOB_NAME,START_TIME,FINISH_TIME,STATUS, 'PF.EFT_ALLOCATIONS_PR' as FBI_JOB_NAME \r\nfrom dw.job_monitoring_vw \r\nwhere job_name = 'PF.EFT_ALLOCATIONS_PR' and status = 'SUCCESS' and to_date(finish_time,'YYYY/MM/DD HH24:MI:SS') > trunc(sysdate)",
								"partitionOption": "None",
								"queryTimeout": "02:00:00"
							},
							"dataset": {
								"referenceName": "OracleTable1",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Check Did Job Success",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "check Oracle Job",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "select count(*) from pf_views_jobs_check \nwhere job_name = 'PF.EFT_ALLOCATIONS_PR' and \n    status = 'SUCCESS' and cast(finish_time as date)=cast(GETDATE() AT TIME ZONE 'UTC' AT TIME ZONE 'Eastern Standard Time' AS DATE)\n    and FBI_JOB_NAME='PF.EFT_ALLOCATIONS_PR'",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "SNK_DBO_PF_VIEWS_JOBS_CHECK",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Update Job Status",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Copy data Iseries",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "UPDATE [DW].[PF_ACTIVE_MEMBERS_SMRY]\nSET AS_OF = GETDATE()\nWHERE SOURCE='EDW';\nSELECT 1\n",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "SNK_DBO_PF_VIEWS_JOBS_CHECK",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"folder": {
					"name": "EDW_PF_SQL_POOL"
				},
				"annotations": [],
				"lastPublishTime": "2023-02-23T16:21:18Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/PF_Agreement_UDF')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "PF_Agreement_UDF",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "OracleSource",
								"oracleReaderQuery": "select * from betadata.agreementudfview where vpd_id IN (1119,224)",
								"partitionOption": "None",
								"queryTimeout": "02:00:00"
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "truncate table Dimfact.PF_Agreement_UDF;",
								"writeBehavior": "insert",
								"tableOption": "autoCreate",
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "VPD_ID",
											"type": "Decimal"
										},
										"sink": {
											"name": "VPD_ID",
											"type": "Decimal",
											"physicalType": "Decimal"
										}
									},
									{
										"source": {
											"name": "Agreement #",
											"type": "String"
										},
										"sink": {
											"name": "Agreement #",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "Ordinal Identifier",
											"type": "String"
										},
										"sink": {
											"name": "Ordinal Identifier",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "Club Nbr",
											"type": "String"
										},
										"sink": {
											"name": "Club Nbr",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "Member Number",
											"type": "String"
										},
										"sink": {
											"name": "Member Number",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "ORDINAL",
											"type": "Decimal"
										},
										"sink": {
											"name": "ORDINAL",
											"type": "Decimal",
											"physicalType": "Decimal"
										}
									},
									{
										"source": {
											"name": "SPL_ID",
											"type": "String"
										},
										"sink": {
											"name": "SPL_ID",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "A_ID",
											"type": "String"
										},
										"sink": {
											"name": "A_ID",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "M_ID",
											"type": "String"
										},
										"sink": {
											"name": "M_ID",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "UDF Name",
											"type": "String"
										},
										"sink": {
											"name": "UDF Name",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "REPORT_VIEW_LABEL",
											"type": "String"
										},
										"sink": {
											"name": "REPORT_VIEW_LABEL",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "COLUMN_LABEL",
											"type": "String"
										},
										"sink": {
											"name": "COLUMN_LABEL",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "UDF_VALUE",
											"type": "String"
										},
										"sink": {
											"name": "UDF_VALUE",
											"type": "String",
											"physicalType": "String"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "SRC_BETADATA",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "PF_Agreement_UDF",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Stored procedure1",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "PF_Agreement_UDF",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[DimFact].[PF_Agreement_UDFUpdate]"
						},
						"linkedServiceName": {
							"referenceName": "AzureSqlDatabase1",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"folder": {
					"name": "PF"
				},
				"annotations": [],
				"lastPublishTime": "2022-08-10T21:17:10Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/PF_Aternate_Billing')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Truncate table Inr",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "truncate table [AbcFin].stg_AlternateBillingNew_incr;\nselect 0;",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "PF_Alternate_Billing",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": false
						}
					},
					{
						"name": "GetRangeDate_AlternateBilling",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Truncate table Inr",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderStoredProcedureName": "[[dbo].[GetRangeDate]",
								"storedProcedureParameters": {
									"StgSchema": {
										"type": "String",
										"value": "AbcFin"
									},
									"StgTable": {
										"type": "String",
										"value": "stg_AlternateBillingNew"
									}
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "PF_Alternate_Billing",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "ForEach1",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "getClubnumber",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('getClubnumber').output.value",
								"type": "Expression"
							},
							"activities": [
								{
									"name": "BTD to Planetfitness",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "OracleSource",
											"oracleReaderQuery": {
												"value": "@concat('select m.*\nfrom betadata.memberdata m  \nwhere  TO_DATE(m.\"Last Modified\", ''MM/DD/YYYY'') > TO_DATE(''',variables('StartDT'),\n ''' ,''MM/DD/YYYY'') and m.\"Club Nbr\" in ',\n item().club_list)\n\n",
												"type": "Expression"
											},
											"partitionOption": "None",
											"queryTimeout": "02:00:00"
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "insert",
											"sqlWriterUseTableLock": false
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "Alt CC On File",
														"type": "String"
													},
													"sink": {
														"name": "Alt CC On File",
														"type": "String",
														"physicalType": "varchar"
													}
												},
												{
													"source": {
														"name": "Member Guid",
														"type": "String"
													},
													"sink": {
														"name": "Member Guid",
														"type": "String",
														"physicalType": "varchar"
													}
												},
												{
													"source": {
														"name": "Club Nbr",
														"type": "String"
													},
													"sink": {
														"name": "Club_Key",
														"type": "String",
														"physicalType": "nvarchar"
													}
												}
											],
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "SRC_BETADATA",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "PF_Alternate_Billing",
											"type": "DatasetReference",
											"parameters": {}
										}
									]
								}
							]
						}
					},
					{
						"name": "getClubnumber",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "setmonth",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderStoredProcedureName": "[[AbcFin].[GetClubToLoad]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "PF_Alternate_Billing",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": false
						}
					},
					{
						"name": "setmonth",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "GetRangeDate_AlternateBilling",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"variableName": "StartDT",
							"value": {
								"value": "@concat(\nsubstring(string(activity('GetRangeDate_AlternateBilling').output.firstRow.StartDt),5,2),\n'/',\nsubstring(string(activity('GetRangeDate_AlternateBilling').output.firstRow.StartDt),8,2),\n'/',\nsubstring(string(activity('GetRangeDate_AlternateBilling').output.firstRow.StartDt),0,4)\n)",
								"type": "Expression"
							}
						}
					},
					{
						"name": "merge staging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "ForEach1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[AbcFin].[Stg_AlternateBillingNew_Merge]"
						},
						"linkedServiceName": {
							"referenceName": "AzureSqlDatabase1",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Fact proc",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "merge staging",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[AbcFin].[DimAlternateBillingUpdateNew]"
						},
						"linkedServiceName": {
							"referenceName": "AzureSqlDatabase1",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"variables": {
					"StartDT": {
						"type": "String"
					}
				},
				"folder": {
					"name": "PF"
				},
				"annotations": [],
				"lastPublishTime": "2022-08-10T21:17:09Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/PF_CORP_FEES_DETAIL_VW_SQLPOOL')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Truncate Incr table",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "truncate table [DW].[PF_CORP_FEES_DETAIL_INCR];\nselect 0;",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "AzureSynapseAnalyticsDB",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": false
						}
					},
					{
						"name": "Merge to Staging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "ForEach1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[DW].[PF_CORP_FEES_DETAIL_Merge]"
						},
						"linkedServiceName": {
							"referenceName": "AzureSynapseAnalytics1",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "ForEach1",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "Lookup1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('Lookup1').output.value",
								"type": "Expression"
							},
							"isSequential": false,
							"activities": [
								{
									"name": "PF_CORP_FEES_DETAIL_INCR",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "OracleSource",
											"oracleReaderQuery": {
												"value": "SELECT *\nFROM dw.PF_CORP_FEES_DETAIL_VW\nwhere TO_DATE(INVOICE_DATE, 'YYYYMMDD') >= TO_DATE('@{formatDateTime(pipeline().parameters.windowStart, 'yyyyMMdd' )}', 'YYYYMMDD') \nAND TO_DATE(INVOICE_DATE, 'YYYYMMDD') < TO_DATE('@{formatDateTime(pipeline().parameters.windowEnd, 'yyyyMMdd' )}', 'YYYYMMDD')\nAND club_number_i in @{item().cbcpy_list}\n",
												"type": "Expression"
											},
											"partitionOption": "None",
											"convertDecimalToInteger": false,
											"queryTimeout": "02:00:00"
										},
										"sink": {
											"type": "SqlDWSink",
											"maxConcurrentConnections": 6,
											"allowPolyBase": true,
											"polyBaseSettings": {
												"rejectValue": 0,
												"rejectType": "value",
												"useTypeDefault": false
											},
											"disableMetricsCollection": false
										},
										"enableStaging": true,
										"stagingSettings": {
											"linkedServiceName": {
												"referenceName": "AzureBlobStorage1",
												"type": "LinkedServiceReference"
											},
											"path": "vifiles",
											"enableCompression": false
										},
										"parallelCopies": 8,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "CLUB_NUMBER_I",
														"type": "Decimal"
													},
													"sink": {
														"name": "CLUB_NUMBER_I",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "AMOUNT",
														"type": "Double"
													},
													"sink": {
														"name": "AMOUNT",
														"type": "Single"
													}
												},
												{
													"source": {
														"name": "INVOICE_DATE",
														"type": "Decimal"
													},
													"sink": {
														"name": "INVOICE_DATE",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"name": "PROFIT_CENTER",
														"type": "String"
													},
													"sink": {
														"name": "PROFIT_CENTER",
														"type": "String"
													}
												}
											]
										}
									},
									"inputs": [
										{
											"referenceName": "SRC_PF_Royalty",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "SNK_SYN_PF_CORP_FEES_DETAIL_VW_INCR",
											"type": "DatasetReference",
											"parameters": {}
										}
									]
								}
							]
						}
					},
					{
						"name": "Lookup1",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Truncate Incr table",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderStoredProcedureName": "[[abcpi].[GetClubToLoad_300]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "AzureSynapseAnalyticsDB",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": false
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"windowStart": {
						"type": "string"
					},
					"windowEnd": {
						"type": "string"
					}
				},
				"folder": {
					"name": "EDW_PF_SQL_POOL"
				},
				"annotations": [],
				"lastPublishTime": "2023-02-23T16:21:18Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/PF_EFT_ALLOC_AF_VW')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Copy data1",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Truncate table Sink",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "OracleSource",
								"oracleReaderQuery": "SELECT *\nFROM PF.EFT_ALLOC_AF_VW",
								"partitionOption": "None",
								"queryTimeout": "02:00:00"
							},
							"sink": {
								"type": "SqlDWSink",
								"maxConcurrentConnections": 6,
								"allowPolyBase": true,
								"polyBaseSettings": {
									"rejectValue": 0,
									"rejectType": "value",
									"useTypeDefault": true
								},
								"disableMetricsCollection": false
							},
							"enableStaging": true,
							"stagingSettings": {
								"linkedServiceName": {
									"referenceName": "AzureBlobStorage1",
									"type": "LinkedServiceReference"
								},
								"path": "pfviewsoracle",
								"enableCompression": true
							},
							"parallelCopies": 8,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "CLUB_NUMBER_AND_NAME",
											"type": "String"
										},
										"sink": {
											"name": "CLUB_NUMBER_AND_NAME",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "GROSS_INVOICES_ACH#T",
											"type": "Double"
										},
										"sink": {
											"name": "GROSS_INVOICES_ACH#T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "GROSS_INVOICES_ACH$A",
											"type": "Double"
										},
										"sink": {
											"name": "GROSS_INVOICES_ACH$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "GROSS_INVOICES_CCD#T",
											"type": "Double"
										},
										"sink": {
											"name": "GROSS_INVOICES_CCD#T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "GROSS_INVOICES_CCD$A",
											"type": "Double"
										},
										"sink": {
											"name": "GROSS_INVOICES_CCD$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "GROSS_INVOICES_STM#T",
											"type": "Double"
										},
										"sink": {
											"name": "GROSS_INVOICES_STM#T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "GROSS_INVOICES_STM$A",
											"type": "Double"
										},
										"sink": {
											"name": "GROSS_INVOICES_STM$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "GROSS_INVOICES_AMZ#T",
											"type": "Double"
										},
										"sink": {
											"name": "GROSS_INVOICES_AMZ#T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "GROSS_INVOICES_AMZ$A",
											"type": "Double"
										},
										"sink": {
											"name": "GROSS_INVOICES_AMZ$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "GROSS_INVOICES_APL#T",
											"type": "Double"
										},
										"sink": {
											"name": "GROSS_INVOICES_APL#T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "GROSS_INVOICES_APL$A",
											"type": "Double"
										},
										"sink": {
											"name": "GROSS_INVOICES_APL$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "GROSS_INVOICES_DGP#T",
											"type": "Double"
										},
										"sink": {
											"name": "GROSS_INVOICES_DGP#T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "GROSS_INVOICES_DGP$A",
											"type": "Double"
										},
										"sink": {
											"name": "GROSS_INVOICES_DGP$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "GROSS_INVOICES_PRB#T",
											"type": "Double"
										},
										"sink": {
											"name": "GROSS_INVOICES_PRB#T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "GROSS_INVOICES_PRB$A",
											"type": "Double"
										},
										"sink": {
											"name": "GROSS_INVOICES_PRB$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "GROSS_INVOICES_TOT#T",
											"type": "Double"
										},
										"sink": {
											"name": "GROSS_INVOICES_TOT#T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "GROSS_INVOICES_TOT$A",
											"type": "Double"
										},
										"sink": {
											"name": "GROSS_INVOICES_TOT$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "COLLECTD_ON_DRAFT_ACH#T",
											"type": "Double"
										},
										"sink": {
											"name": "COLLECTD_ON_DRAFT_ACH#T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "COLLECTD_ON_DRAFT_ACH$A",
											"type": "Double"
										},
										"sink": {
											"name": "COLLECTD_ON_DRAFT_ACH$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "COLLECTD_ON_DRAFT_CCD#T",
											"type": "Double"
										},
										"sink": {
											"name": "COLLECTD_ON_DRAFT_CCD#T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "COLLECTD_ON_DRAFT_CCD$A",
											"type": "Double"
										},
										"sink": {
											"name": "COLLECTD_ON_DRAFT_CCD$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "COLLECTD_ON_DRAFT_STM#T",
											"type": "Double"
										},
										"sink": {
											"name": "COLLECTD_ON_DRAFT_STM#T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "COLLECTD_ON_DRAFT_STM$A",
											"type": "Double"
										},
										"sink": {
											"name": "COLLECTD_ON_DRAFT_STM$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "COLLECTD_ON_DRAFT_AMZ#T",
											"type": "Double"
										},
										"sink": {
											"name": "COLLECTD_ON_DRAFT_AMZ#T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "COLLECTD_ON_DRAFT_AMZ$A",
											"type": "Double"
										},
										"sink": {
											"name": "COLLECTD_ON_DRAFT_AMZ$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "COLLECTD_ON_DRAFT_APL#T",
											"type": "Double"
										},
										"sink": {
											"name": "COLLECTD_ON_DRAFT_APL#T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "COLLECTD_ON_DRAFT_APL$A",
											"type": "Double"
										},
										"sink": {
											"name": "COLLECTD_ON_DRAFT_APL$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "COLLECTD_ON_DRAFT_DGP#T",
											"type": "Double"
										},
										"sink": {
											"name": "COLLECTD_ON_DRAFT_DGP#T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "COLLECTD_ON_DRAFT_DGP$A",
											"type": "Double"
										},
										"sink": {
											"name": "COLLECTD_ON_DRAFT_DGP$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "COLLECTD_ON_DRAFT_PRB#T",
											"type": "Double"
										},
										"sink": {
											"name": "COLLECTD_ON_DRAFT_PRB#T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "COLLECTD_ON_DRAFT_PRB$A",
											"type": "Double"
										},
										"sink": {
											"name": "COLLECTD_ON_DRAFT_PRB$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "COLLECTD_ON_DRAFT_TOT#T",
											"type": "Double"
										},
										"sink": {
											"name": "COLLECTD_ON_DRAFT_TOT#T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "COLLECTD_ON_DRAFT_TOT$A",
											"type": "Double"
										},
										"sink": {
											"name": "COLLECTD_ON_DRAFT_TOT$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "DELINQUENT_RECOVRY_ACH#T",
											"type": "Double"
										},
										"sink": {
											"name": "DELINQUENT_RECOVRY_ACH#T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "DELINQUENT_RECOVRY_ACH$A",
											"type": "Double"
										},
										"sink": {
											"name": "DELINQUENT_RECOVRY_ACH$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "DELINQUENT_RECOVRY_CCD#T",
											"type": "Double"
										},
										"sink": {
											"name": "DELINQUENT_RECOVRY_CCD#T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "DELINQUENT_RECOVRY_CCD$A",
											"type": "Double"
										},
										"sink": {
											"name": "DELINQUENT_RECOVRY_CCD$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "DELINQUENT_RECOVRY_STM#T",
											"type": "Double"
										},
										"sink": {
											"name": "DELINQUENT_RECOVRY_STM#T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "DELINQUENT_RECOVRY_STM$A",
											"type": "Double"
										},
										"sink": {
											"name": "DELINQUENT_RECOVRY_STM$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "DELINQUENT_RECOVRY_AMZ#T",
											"type": "Double"
										},
										"sink": {
											"name": "DELINQUENT_RECOVRY_AMZ#T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "DELINQUENT_RECOVRY_AMZ$A",
											"type": "Double"
										},
										"sink": {
											"name": "DELINQUENT_RECOVRY_AMZ$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "DELINQUENT_RECOVRY_APL#T",
											"type": "Double"
										},
										"sink": {
											"name": "DELINQUENT_RECOVRY_APL#T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "DELINQUENT_RECOVRY_APL$A",
											"type": "Double"
										},
										"sink": {
											"name": "DELINQUENT_RECOVRY_APL$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "DELINQUENT_RECOVRY_DGP#T",
											"type": "Double"
										},
										"sink": {
											"name": "DELINQUENT_RECOVRY_DGP#T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "DELINQUENT_RECOVRY_DGP$A",
											"type": "Double"
										},
										"sink": {
											"name": "DELINQUENT_RECOVRY_DGP$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "DELINQUENT_RECOVRY_PRB#T",
											"type": "Double"
										},
										"sink": {
											"name": "DELINQUENT_RECOVRY_PRB#T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "DELINQUENT_RECOVRY_PRB$A",
											"type": "Double"
										},
										"sink": {
											"name": "DELINQUENT_RECOVRY_PRB$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "DELINQUENT_RECOVRY_TOT#T",
											"type": "Double"
										},
										"sink": {
											"name": "DELINQUENT_RECOVRY_TOT#T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "DELINQUENT_RECO_CLUBACCT_TOT$A",
											"type": "Double"
										},
										"sink": {
											"name": "DELINQUENT_RECO_CLUBACCT_TOT$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "DELINQUENT_RECOVRY_TOT$A",
											"type": "Double"
										},
										"sink": {
											"name": "DELINQUENT_RECOVRY_TOT$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "COLLECTED_PRIOR_TO_DRAFT_ACH#T",
											"type": "Double"
										},
										"sink": {
											"name": "COLLECTED_PRIOR_TO_DRAFT_ACH#T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "COLLECTED_PRIOR_TO_DRAFT_ACH$A",
											"type": "Double"
										},
										"sink": {
											"name": "COLLECTED_PRIOR_TO_DRAFT_ACH$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "COLLECTED_PRIOR_TO_DRAFT_CCD#T",
											"type": "Double"
										},
										"sink": {
											"name": "COLLECTED_PRIOR_TO_DRAFT_CCD#T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "COLLECTED_PRIOR_TO_DRAFT_CCD$A",
											"type": "Double"
										},
										"sink": {
											"name": "COLLECTED_PRIOR_TO_DRAFT_CCD$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "COLLECTED_PRIOR_TO_DRAFT_STM#T",
											"type": "Double"
										},
										"sink": {
											"name": "COLLECTED_PRIOR_TO_DRAFT_STM#T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "COLLECTED_PRIOR_TO_DRAFT_STM$A",
											"type": "Double"
										},
										"sink": {
											"name": "COLLECTED_PRIOR_TO_DRAFT_STM$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "COLLECTED_PRIOR_TO_DRAFT_AMZ#T",
											"type": "Double"
										},
										"sink": {
											"name": "COLLECTED_PRIOR_TO_DRAFT_AMZ#T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "COLLECTED_PRIOR_TO_DRAFT_AMZ$A",
											"type": "Double"
										},
										"sink": {
											"name": "COLLECTED_PRIOR_TO_DRAFT_AMZ$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "COLLECTED_PRIOR_TO_DRAFT_APL#T",
											"type": "Double"
										},
										"sink": {
											"name": "COLLECTED_PRIOR_TO_DRAFT_APL#T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "COLLECTED_PRIOR_TO_DRAFT_APL$A",
											"type": "Double"
										},
										"sink": {
											"name": "COLLECTED_PRIOR_TO_DRAFT_APL$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "COLLECTED_PRIOR_TO_DRAFT_DGP#T",
											"type": "Double"
										},
										"sink": {
											"name": "COLLECTED_PRIOR_TO_DRAFT_DGP#T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "COLLECTED_PRIOR_TO_DRAFT_DGP$A",
											"type": "Double"
										},
										"sink": {
											"name": "COLLECTED_PRIOR_TO_DRAFT_DGP$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "COLLECTED_PRIOR_TO_DRAFT_PRB#T",
											"type": "Double"
										},
										"sink": {
											"name": "COLLECTED_PRIOR_TO_DRAFT_PRB#T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "COLLECTED_PRIOR_TO_DRAFT_PRB$A",
											"type": "Double"
										},
										"sink": {
											"name": "COLLECTED_PRIOR_TO_DRAFT_PRB$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "COLLECTED_PRIOR_TO_DRAFT_TOT#T",
											"type": "Double"
										},
										"sink": {
											"name": "COLLECTED_PRIOR_TO_DRAFT_TOT#T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "COLLECTED_PRIOR_TO_DRAFT_TOT$A",
											"type": "Double"
										},
										"sink": {
											"name": "COLLECTED_PRIOR_TO_DRAFT_TOT$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "PRIOR_PERIOD_REVERSALS_ACH#T",
											"type": "Double"
										},
										"sink": {
											"name": "PRIOR_PERIOD_REVERSALS_ACH#T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "PRIOR_PERIOD_REVERSALS_ACH$A",
											"type": "Double"
										},
										"sink": {
											"name": "PRIOR_PERIOD_REVERSALS_ACH$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "PRIOR_PERIOD_REVERSALS_CCD#T",
											"type": "Double"
										},
										"sink": {
											"name": "PRIOR_PERIOD_REVERSALS_CCD#T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "PRIOR_PERIOD_REVERSALS_CCD$A",
											"type": "Double"
										},
										"sink": {
											"name": "PRIOR_PERIOD_REVERSALS_CCD$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "PRIOR_PERIOD_REVERSALS_STM#T",
											"type": "Double"
										},
										"sink": {
											"name": "PRIOR_PERIOD_REVERSALS_STM#T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "PRIOR_PERIOD_REVERSALS_STM$A",
											"type": "Double"
										},
										"sink": {
											"name": "PRIOR_PERIOD_REVERSALS_STM$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "PRIOR_PERIOD_REVERSALS_AMZ#T",
											"type": "Double"
										},
										"sink": {
											"name": "PRIOR_PERIOD_REVERSALS_AMZ#T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "PRIOR_PERIOD_REVERSALS_AMZ$A",
											"type": "Double"
										},
										"sink": {
											"name": "PRIOR_PERIOD_REVERSALS_AMZ$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "PRIOR_PERIOD_REVERSALS_APL#T",
											"type": "Double"
										},
										"sink": {
											"name": "PRIOR_PERIOD_REVERSALS_APL#T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "PRIOR_PERIOD_REVERSALS_APL$A",
											"type": "Double"
										},
										"sink": {
											"name": "PRIOR_PERIOD_REVERSALS_APL$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "PRIOR_PERIOD_REVERSALS_DGP#T",
											"type": "Double"
										},
										"sink": {
											"name": "PRIOR_PERIOD_REVERSALS_DGP#T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "PRIOR_PERIOD_REVERSALS_DGP$A",
											"type": "Double"
										},
										"sink": {
											"name": "PRIOR_PERIOD_REVERSALS_DGP$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "PRIOR_PERIOD_REVERSALS_PRB#T",
											"type": "Double"
										},
										"sink": {
											"name": "PRIOR_PERIOD_REVERSALS_PRB#T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "PRIOR_PERIOD_REVERSALS_PRB$A",
											"type": "Double"
										},
										"sink": {
											"name": "PRIOR_PERIOD_REVERSALS_PRB$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "PRIOR_PERIOD_REVERSALS_TOT#T",
											"type": "Double"
										},
										"sink": {
											"name": "PRIOR_PERIOD_REVERSALS_TOT#T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "PRIOR_PERIOD_REVERSALS_TOT$A",
											"type": "Double"
										},
										"sink": {
											"name": "PRIOR_PERIOD_REVERSALS_TOT$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "TOTAL_COLLECTED_ACH#T",
											"type": "Double"
										},
										"sink": {
											"name": "TOTAL_COLLECTED_ACH#T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "TOTAL_COLLECTED_ACH$A",
											"type": "Double"
										},
										"sink": {
											"name": "TOTAL_COLLECTED_ACH$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "TOTAL_COLLECTED_CCD#T",
											"type": "Double"
										},
										"sink": {
											"name": "TOTAL_COLLECTED_CCD#T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "TOTAL_COLLECTED_CCD$A",
											"type": "Double"
										},
										"sink": {
											"name": "TOTAL_COLLECTED_CCD$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "TOTAL_COLLECTED_STM#T",
											"type": "Double"
										},
										"sink": {
											"name": "TOTAL_COLLECTED_STM#T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "TOTAL_COLLECTED_STM$A",
											"type": "Double"
										},
										"sink": {
											"name": "TOTAL_COLLECTED_STM$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "TOTAL_COLLECTED_AMZ#T",
											"type": "Double"
										},
										"sink": {
											"name": "TOTAL_COLLECTED_AMZ#T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "TOTAL_COLLECTED_AMZ$A",
											"type": "Double"
										},
										"sink": {
											"name": "TOTAL_COLLECTED_AMZ$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "TOTAL_COLLECTED_APL#T",
											"type": "Double"
										},
										"sink": {
											"name": "TOTAL_COLLECTED_APL#T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "TOTAL_COLLECTED_APL$A",
											"type": "Double"
										},
										"sink": {
											"name": "TOTAL_COLLECTED_APL$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "TOTAL_COLLECTED_DGP#T",
											"type": "Double"
										},
										"sink": {
											"name": "TOTAL_COLLECTED_DGP#T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "TOTAL_COLLECTED_DGP$A",
											"type": "Double"
										},
										"sink": {
											"name": "TOTAL_COLLECTED_DGP$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "TOTAL_COLLECTED_PRB#T",
											"type": "Double"
										},
										"sink": {
											"name": "TOTAL_COLLECTED_PRB#T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "TOTAL_COLLECTED_PRB$A",
											"type": "Double"
										},
										"sink": {
											"name": "TOTAL_COLLECTED_PRB$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "TOTAL_COLLECTED_TOT#T",
											"type": "Double"
										},
										"sink": {
											"name": "TOTAL_COLLECTED_TOT#T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "TOTAL_COLLECTED_TOT$A",
											"type": "Double"
										},
										"sink": {
											"name": "TOTAL_COLLECTED_TOT$A",
											"type": "Single"
										}
									}
								]
							}
						},
						"inputs": [
							{
								"referenceName": "SRC_PF_EFT_ALLOC_AF_VW",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "SNK_SYN_PF_EFT_ALLOC_AF",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Truncate table Sink",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Check Did Job Success",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "TRUNCATE TABLE [PF].[EFT_ALLOC_AF];\nSELECT 1;",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "SNK_SYN_PF_EFT_ALLOC_AF",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": true
						}
					},
					{
						"name": "Get Job Status",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "select 1\nfrom [dbo].[PF_VIEWS_JOBS_CHECK] \nwhere finish_time = cast(GETDATE() AT TIME ZONE 'UTC' AT TIME ZONE 'Eastern Standard Time' AS DATE) \nand FBI_JOB_NAME= 'PF.EFT_ALLOCATIONS_PR' and job_completed=1",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "SNK_DBO_PF_VIEWS_JOBS_CHECK",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "check Oracle Job",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Get Job Status",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "OracleSource",
								"oracleReaderQuery": "select JOB_NAME,START_TIME,FINISH_TIME,STATUS, 'PF.EFT_ALLOCATIONS_PR' as FBI_JOB_NAME \r\nfrom dw.job_monitoring_vw \r\nwhere job_name = 'PF.EFT_ALLOCATIONS_PR' and status = 'SUCCESS' and to_date(finish_time,'YYYY/MM/DD HH24:MI:SS') > trunc(sysdate)",
								"partitionOption": "None",
								"queryTimeout": "02:00:00"
							},
							"dataset": {
								"referenceName": "OracleTable1",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Check Did Job Success",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "check Oracle Job",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "select count(*) from pf_views_jobs_check \nwhere job_name = 'PF.EFT_ALLOCATIONS_PR' and \n    status = 'SUCCESS' and cast(finish_time as date)=cast(GETDATE() AT TIME ZONE 'UTC' AT TIME ZONE 'Eastern Standard Time' AS DATE)\n    and FBI_JOB_NAME='PF.EFT_ALLOCATIONS_PR'",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "SNK_DBO_PF_VIEWS_JOBS_CHECK",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Update Job Status",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Copy data1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "UPDATE [PF].[EFT_ALLOC_AF]\nSET AS_OF = GETDATE();\nSELECT 1\n",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "SNK_DBO_PF_VIEWS_JOBS_CHECK",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"folder": {
					"name": "EDW_PF_SQL_POOL"
				},
				"annotations": [],
				"lastPublishTime": "2023-02-23T16:21:18Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/PF_EFT_ALLOC_COLLCTNSUCCESS_AF_VW')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Copy data1",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Truncate table Sink",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "OracleSource",
								"oracleReaderQuery": "SELECT *\nFROM PF.EFT_ALLOC_COLLCTNSUCCESS_AF_VW",
								"partitionOption": "None",
								"queryTimeout": "02:00:00"
							},
							"sink": {
								"type": "SqlDWSink",
								"maxConcurrentConnections": 6,
								"allowPolyBase": true,
								"polyBaseSettings": {
									"rejectValue": 0,
									"rejectType": "value",
									"useTypeDefault": true
								},
								"disableMetricsCollection": false
							},
							"enableStaging": true,
							"stagingSettings": {
								"linkedServiceName": {
									"referenceName": "AzureBlobStorage1",
									"type": "LinkedServiceReference"
								},
								"path": "pfviewsoracle",
								"enableCompression": true
							},
							"parallelCopies": 8,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "CLUB",
											"type": "String"
										},
										"sink": {
											"name": "CLUB",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "DESCRIPTION",
											"type": "String"
										},
										"sink": {
											"name": "DESCRIPTION",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ACH",
											"type": "String"
										},
										"sink": {
											"name": "ACH",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "CCD",
											"type": "String"
										},
										"sink": {
											"name": "CCD",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PRB",
											"type": "String"
										},
										"sink": {
											"name": "PRB",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "STM",
											"type": "String"
										},
										"sink": {
											"name": "STM",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "AMZ",
											"type": "String"
										},
										"sink": {
											"name": "AMZ",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "APL",
											"type": "String"
										},
										"sink": {
											"name": "APL",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "DGP",
											"type": "String"
										},
										"sink": {
											"name": "DGP",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "TOT",
											"type": "String"
										},
										"sink": {
											"name": "TOT",
											"type": "String"
										}
									}
								]
							}
						},
						"inputs": [
							{
								"referenceName": "SRC_PF_EFT_ALLOC_COLLCTNSUCCESS_AF_VW",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "SNK_SYN_EFT_ALLOC_COLLCTNSUCCESS_AF",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Truncate table Sink",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Check Did Job Success",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "TRUNCATE TABLE [PF].[EFT_ALLOC_COLLCTNSUCCESS_AF];\nSELECT 1;",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "SNK_SYN_EFT_ALLOC_COLLCTNSUCCESS_AF",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": true
						}
					},
					{
						"name": "Get Job Status",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "select 1\nfrom [dbo].[PF_VIEWS_JOBS_CHECK] \nwhere finish_time = cast(GETDATE() AT TIME ZONE 'UTC' AT TIME ZONE 'Eastern Standard Time' AS DATE) \nand FBI_JOB_NAME= 'PF.EFT_ALLOCATIONS_PR' and job_completed=1",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "SNK_DBO_PF_VIEWS_JOBS_CHECK",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "check Oracle Job",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Get Job Status",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "OracleSource",
								"oracleReaderQuery": "select JOB_NAME,START_TIME,FINISH_TIME,STATUS, 'PF.EFT_ALLOCATIONS_PR' as FBI_JOB_NAME \nfrom dw.job_monitoring_vw \nwhere job_name = 'PF.EFT_ALLOCATIONS_PR' and status = 'SUCCESS' and to_date(finish_time,'YYYY/MM/DD HH24:MI:SS') > trunc(sysdate)",
								"partitionOption": "None",
								"queryTimeout": "02:00:00"
							},
							"dataset": {
								"referenceName": "OracleTable1",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Check Did Job Success",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "check Oracle Job",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "select count(*) from pf_views_jobs_check \nwhere job_name = 'PF.EFT_ALLOCATIONS_PR' and \n    status = 'SUCCESS' and cast(finish_time as date)=cast(GETDATE() AT TIME ZONE 'UTC' AT TIME ZONE 'Eastern Standard Time' AS DATE)\n    and FBI_JOB_NAME='PF.EFT_ALLOCATIONS_PR'",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "SNK_DBO_PF_VIEWS_JOBS_CHECK",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Update Job Status",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Copy data1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "UPDATE [PF].[EFT_ALLOC_COLLCTNSUCCESS_AF]\nSET AS_OF = GETDATE();\nSELECT 1\n",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "SNK_DBO_PF_VIEWS_JOBS_CHECK",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"folder": {
					"name": "EDW_PF_SQL_POOL"
				},
				"annotations": [],
				"lastPublishTime": "2023-02-23T16:21:18Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/PF_EFT_ALLOC_COLLCTNSUCCESS_DS_VW')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Copy data1",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Truncate table Sink",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "OracleSource",
								"oracleReaderQuery": "SELECT *\nFROM PF.EFT_ALLOC_COLLCTNSUCCESS_DS_VW",
								"partitionOption": "None",
								"queryTimeout": "02:00:00"
							},
							"sink": {
								"type": "SqlDWSink",
								"maxConcurrentConnections": 6,
								"allowPolyBase": true,
								"polyBaseSettings": {
									"rejectValue": 0,
									"rejectType": "value",
									"useTypeDefault": true
								},
								"disableMetricsCollection": false
							},
							"enableStaging": true,
							"stagingSettings": {
								"linkedServiceName": {
									"referenceName": "AzureBlobStorage1",
									"type": "LinkedServiceReference"
								},
								"path": "pfviewsoracle",
								"enableCompression": true
							},
							"parallelCopies": 8,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "CLUB",
											"type": "String"
										},
										"sink": {
											"name": "CLUB",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "DESCRIPTION",
											"type": "String"
										},
										"sink": {
											"name": "DESCRIPTION",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ACH",
											"type": "String"
										},
										"sink": {
											"name": "ACH",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "CCD",
											"type": "String"
										},
										"sink": {
											"name": "CCD",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PRB",
											"type": "String"
										},
										"sink": {
											"name": "PRB",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "STM",
											"type": "String"
										},
										"sink": {
											"name": "STM",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "AMZ",
											"type": "String"
										},
										"sink": {
											"name": "AMZ",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "APL",
											"type": "String"
										},
										"sink": {
											"name": "APL",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "DGP",
											"type": "String"
										},
										"sink": {
											"name": "DGP",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "TOT",
											"type": "String"
										},
										"sink": {
											"name": "TOT",
											"type": "String"
										}
									}
								]
							}
						},
						"inputs": [
							{
								"referenceName": "SRC_PF_EFT_ALLOC_COLLCTNSUCCESS_DS_VW",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "SNK_SYN_EFT_ALLOC_COLLCTNSUCCESS_DS",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Truncate table Sink",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Check Did Job Success",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "TRUNCATE TABLE [PF].[EFT_ALLOC_COLLCTNSUCCESS_DS];\nSELECT 1;",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "SNK_SYN_EFT_ALLOC_COLLCTNSUCCESS_DS",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": true
						}
					},
					{
						"name": "Get Job Status",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "select 1\nfrom [dbo].[PF_VIEWS_JOBS_CHECK] \nwhere finish_time = cast(GETDATE() AT TIME ZONE 'UTC' AT TIME ZONE 'Eastern Standard Time' AS DATE) \nand FBI_JOB_NAME= 'PF.EFT_ALLOCATIONS_PR' and job_completed=1",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "SNK_DBO_PF_VIEWS_JOBS_CHECK",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "check Oracle Job",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Get Job Status",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "OracleSource",
								"oracleReaderQuery": "select JOB_NAME,START_TIME,FINISH_TIME,STATUS, 'PF.EFT_ALLOCATIONS_PR' as FBI_JOB_NAME \nfrom dw.job_monitoring_vw \nwhere job_name = 'PF.EFT_ALLOCATIONS_PR' and status = 'SUCCESS' and to_date(finish_time,'YYYY/MM/DD HH24:MI:SS') > trunc(sysdate)",
								"partitionOption": "None",
								"queryTimeout": "02:00:00"
							},
							"dataset": {
								"referenceName": "OracleTable1",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Check Did Job Success",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "check Oracle Job",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "select count(*) from pf_views_jobs_check \nwhere job_name = 'PF.EFT_ALLOCATIONS_PR' and \n    status = 'SUCCESS' and cast(finish_time as date)=cast(GETDATE() AT TIME ZONE 'UTC' AT TIME ZONE 'Eastern Standard Time' AS DATE)\n    and FBI_JOB_NAME='PF.EFT_ALLOCATIONS_PR'",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "SNK_DBO_PF_VIEWS_JOBS_CHECK",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Update Job Status",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Copy data1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "UPDATE [PF].[EFT_ALLOC_COLLCTNSUCCESS_DS]\nSET AS_OF = GETDATE();\nSELECT 1\n",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "SNK_DBO_PF_VIEWS_JOBS_CHECK",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"folder": {
					"name": "EDW_PF_SQL_POOL"
				},
				"annotations": [],
				"lastPublishTime": "2023-02-23T16:21:18Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/PF_EFT_ALLOC_DELINQ_RECOV_AF_VW')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Copy data1",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Truncate table Sink",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "OracleSource",
								"oracleReaderQuery": "SELECT *\nFROM PF.EFT_ALLOC_DELINQ_RECOV_AF_VW",
								"partitionOption": "None",
								"queryTimeout": "02:00:00"
							},
							"sink": {
								"type": "SqlDWSink",
								"maxConcurrentConnections": 6,
								"allowPolyBase": true,
								"polyBaseSettings": {
									"rejectValue": 0,
									"rejectType": "value",
									"useTypeDefault": true
								},
								"disableMetricsCollection": false
							},
							"enableStaging": true,
							"stagingSettings": {
								"linkedServiceName": {
									"referenceName": "AzureBlobStorage1",
									"type": "LinkedServiceReference"
								},
								"path": "pfviewsoracle",
								"enableCompression": true
							},
							"parallelCopies": 8,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "CLUB",
											"type": "String"
										},
										"sink": {
											"name": "CLUB",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "DESCRIPTION",
											"type": "String"
										},
										"sink": {
											"name": "DESCRIPTION",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ACH",
											"type": "String"
										},
										"sink": {
											"name": "ACH",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "CCD",
											"type": "String"
										},
										"sink": {
											"name": "CCD",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PRB",
											"type": "String"
										},
										"sink": {
											"name": "PRB",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "STM",
											"type": "String"
										},
										"sink": {
											"name": "STM",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "AMZ",
											"type": "String"
										},
										"sink": {
											"name": "AMZ",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "APL",
											"type": "String"
										},
										"sink": {
											"name": "APL",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "DGP",
											"type": "String"
										},
										"sink": {
											"name": "DGP",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "TOT",
											"type": "String"
										},
										"sink": {
											"name": "TOT",
											"type": "String"
										}
									}
								]
							}
						},
						"inputs": [
							{
								"referenceName": "SRC_PF_EFT_ALLOC_DELINQ_RECOV_AF_VW",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "SNK_SYN_EFT_ALLOC_DELINQ_RECOV_AF",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Truncate table Sink",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Check Did Job Success",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "TRUNCATE TABLE [PF].[EFT_ALLOC_DELINQ_RECOV_AF];\nSELECT 1;",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "SNK_SYN_EFT_ALLOC_DELINQ_RECOV_AF",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": true
						}
					},
					{
						"name": "Get Job Status",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "select 1\nfrom [dbo].[PF_VIEWS_JOBS_CHECK] \nwhere finish_time = cast(GETDATE() AT TIME ZONE 'UTC' AT TIME ZONE 'Eastern Standard Time' AS DATE) \nand FBI_JOB_NAME= 'PF.EFT_ALLOCATIONS_PR' and job_completed=1",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "SNK_DBO_PF_VIEWS_JOBS_CHECK",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "check Oracle Job",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Get Job Status",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "OracleSource",
								"oracleReaderQuery": "select JOB_NAME,START_TIME,FINISH_TIME,STATUS, 'PF.EFT_ALLOCATIONS_PR' as FBI_JOB_NAME \nfrom dw.job_monitoring_vw \nwhere job_name = 'PF.EFT_ALLOCATIONS_PR' and status = 'SUCCESS' and to_date(finish_time,'YYYY/MM/DD HH24:MI:SS') > trunc(sysdate)",
								"partitionOption": "None",
								"queryTimeout": "02:00:00"
							},
							"dataset": {
								"referenceName": "OracleTable1",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Check Did Job Success",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "check Oracle Job",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "select count(*) from pf_views_jobs_check \nwhere job_name = 'PF.EFT_ALLOCATIONS_PR' and \n    status = 'SUCCESS' and cast(finish_time as date)=cast(GETDATE() AT TIME ZONE 'UTC' AT TIME ZONE 'Eastern Standard Time' AS DATE)\n    and FBI_JOB_NAME='PF.EFT_ALLOCATIONS_PR'",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "SNK_DBO_PF_VIEWS_JOBS_CHECK",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Update Job Status",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Copy data1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "UPDATE [PF].[EFT_ALLOC_DELINQ_RECOV_AF]\nSET AS_OF = GETDATE();\nSELECT 1\n",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "SNK_DBO_PF_VIEWS_JOBS_CHECK",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"folder": {
					"name": "EDW_PF_SQL_POOL"
				},
				"annotations": [],
				"lastPublishTime": "2023-02-23T16:21:18Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/PF_EFT_ALLOC_DELINQ_RECOV_DS_VW')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Copy data1",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Truncate table Sink",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "OracleSource",
								"oracleReaderQuery": "SELECT *\nFROM PF.EFT_ALLOC_DELINQ_RECOV_DS_VW",
								"partitionOption": "None",
								"queryTimeout": "02:00:00"
							},
							"sink": {
								"type": "SqlDWSink",
								"maxConcurrentConnections": 6,
								"allowPolyBase": true,
								"polyBaseSettings": {
									"rejectValue": 0,
									"rejectType": "value",
									"useTypeDefault": true
								},
								"disableMetricsCollection": false
							},
							"enableStaging": true,
							"stagingSettings": {
								"linkedServiceName": {
									"referenceName": "AzureBlobStorage1",
									"type": "LinkedServiceReference"
								},
								"path": "pfviewsoracle",
								"enableCompression": true
							},
							"parallelCopies": 8,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "CLUB",
											"type": "String"
										},
										"sink": {
											"name": "CLUB",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "DESCRIPTION",
											"type": "String"
										},
										"sink": {
											"name": "DESCRIPTION",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ACH",
											"type": "String"
										},
										"sink": {
											"name": "ACH",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "CCD",
											"type": "String"
										},
										"sink": {
											"name": "CCD",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PRB",
											"type": "String"
										},
										"sink": {
											"name": "PRB",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "STM",
											"type": "String"
										},
										"sink": {
											"name": "STM",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "AMZ",
											"type": "String"
										},
										"sink": {
											"name": "AMZ",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "APL",
											"type": "String"
										},
										"sink": {
											"name": "APL",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "DGP",
											"type": "String"
										},
										"sink": {
											"name": "DGP",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "TOT",
											"type": "String"
										},
										"sink": {
											"name": "TOT",
											"type": "String"
										}
									}
								]
							}
						},
						"inputs": [
							{
								"referenceName": "SRC_PF_EFT_ALLOC_DELINQ_RECOV_DS_VW",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "SNK_SYN_EFT_ALLOC_DELINQ_RECOV_DS",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Truncate table Sink",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Check Did Job Success",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "TRUNCATE TABLE [PF].[EFT_ALLOC_DELINQ_RECOV_DS];\nSELECT 1;",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "SNK_SYN_EFT_ALLOC_DELINQ_RECOV_DS",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": true
						}
					},
					{
						"name": "Get Job Status",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "select 1\nfrom [dbo].[PF_VIEWS_JOBS_CHECK] \nwhere finish_time = cast(GETDATE() AT TIME ZONE 'UTC' AT TIME ZONE 'Eastern Standard Time' AS DATE) \nand FBI_JOB_NAME= 'PF.EFT_ALLOCATIONS_PR' and job_completed=1",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "SNK_DBO_PF_VIEWS_JOBS_CHECK",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "check Oracle Job",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Get Job Status",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "OracleSource",
								"oracleReaderQuery": "select JOB_NAME,START_TIME,FINISH_TIME,STATUS, 'PF.EFT_ALLOCATIONS_PR' as FBI_JOB_NAME \nfrom dw.job_monitoring_vw \nwhere job_name = 'PF.EFT_ALLOCATIONS_PR' and status = 'SUCCESS' and to_date(finish_time,'YYYY/MM/DD HH24:MI:SS') > trunc(sysdate)",
								"partitionOption": "None",
								"queryTimeout": "02:00:00"
							},
							"dataset": {
								"referenceName": "OracleTable1",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Check Did Job Success",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "check Oracle Job",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "select count(*) from pf_views_jobs_check \nwhere job_name = 'PF.EFT_ALLOCATIONS_PR' and \n    status = 'SUCCESS' and cast(finish_time as date)=cast(GETDATE() AT TIME ZONE 'UTC' AT TIME ZONE 'Eastern Standard Time' AS DATE)\n    and FBI_JOB_NAME='PF.EFT_ALLOCATIONS_PR'",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "SNK_DBO_PF_VIEWS_JOBS_CHECK",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Update Job Status",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Copy data1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "UPDATE [PF].[EFT_ALLOC_DELINQ_RECOV_DS]\nSET AS_OF = GETDATE();\nSELECT 1\n",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "SNK_DBO_PF_VIEWS_JOBS_CHECK",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"folder": {
					"name": "EDW_PF_SQL_POOL"
				},
				"annotations": [],
				"lastPublishTime": "2023-02-23T16:21:18Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/PF_EFT_ALLOC_DS_VW')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Copy data1",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Truncate table Sink",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "OracleSource",
								"oracleReaderQuery": "SELECT *\nFROM PF.EFT_ALLOC_DS_VW",
								"partitionOption": "None",
								"queryTimeout": "02:00:00"
							},
							"sink": {
								"type": "SqlDWSink",
								"maxConcurrentConnections": 6,
								"allowPolyBase": true,
								"polyBaseSettings": {
									"rejectValue": 0,
									"rejectType": "value",
									"useTypeDefault": true
								},
								"disableMetricsCollection": false
							},
							"enableStaging": true,
							"stagingSettings": {
								"linkedServiceName": {
									"referenceName": "AzureBlobStorage1",
									"type": "LinkedServiceReference"
								},
								"path": "pfviewsoracle",
								"enableCompression": true
							},
							"parallelCopies": 8,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "CLUB_NUMBER_AND_NAME",
											"type": "String"
										},
										"sink": {
											"name": "CLUB_NUMBER_AND_NAME",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "GROSS_INVOICES_ACH#T",
											"type": "Double"
										},
										"sink": {
											"name": "GROSS_INVOICES_ACH#T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "GROSS_INVOICES_ACH$A",
											"type": "Double"
										},
										"sink": {
											"name": "GROSS_INVOICES_ACH$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "GROSS_INVOICES_CCD#T",
											"type": "Double"
										},
										"sink": {
											"name": "GROSS_INVOICES_CCD#T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "GROSS_INVOICES_CCD$A",
											"type": "Double"
										},
										"sink": {
											"name": "GROSS_INVOICES_CCD$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "GROSS_INVOICES_STM#T",
											"type": "Double"
										},
										"sink": {
											"name": "GROSS_INVOICES_STM#T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "GROSS_INVOICES_STM$A",
											"type": "Double"
										},
										"sink": {
											"name": "GROSS_INVOICES_STM$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "GROSS_INVOICES_AMZ#T",
											"type": "Double"
										},
										"sink": {
											"name": "GROSS_INVOICES_AMZ#T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "GROSS_INVOICES_AMZ$A",
											"type": "Double"
										},
										"sink": {
											"name": "GROSS_INVOICES_AMZ$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "GROSS_INVOICES_APL#T",
											"type": "Double"
										},
										"sink": {
											"name": "GROSS_INVOICES_APL#T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "GROSS_INVOICES_APL$A",
											"type": "Double"
										},
										"sink": {
											"name": "GROSS_INVOICES_APL$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "GROSS_INVOICES_DGP#T",
											"type": "Double"
										},
										"sink": {
											"name": "GROSS_INVOICES_DGP#T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "GROSS_INVOICES_DGP$A",
											"type": "Double"
										},
										"sink": {
											"name": "GROSS_INVOICES_DGP$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "GROSS_INVOICES_PRB#T",
											"type": "Double"
										},
										"sink": {
											"name": "GROSS_INVOICES_PRB#T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "GROSS_INVOICES_PRB$A",
											"type": "Double"
										},
										"sink": {
											"name": "GROSS_INVOICES_PRB$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "GROSS_INVOICES_TOT#T",
											"type": "Double"
										},
										"sink": {
											"name": "GROSS_INVOICES_TOT#T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "GROSS_INVOICES_TOT$A",
											"type": "Double"
										},
										"sink": {
											"name": "GROSS_INVOICES_TOT$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "COLLECTD_ON_DRAFT_ACH#T",
											"type": "Double"
										},
										"sink": {
											"name": "COLLECTD_ON_DRAFT_ACH#T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "COLLECTD_ON_DRAFT_ACH$A",
											"type": "Double"
										},
										"sink": {
											"name": "COLLECTD_ON_DRAFT_ACH$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "COLLECTD_ON_DRAFT_CCD#T",
											"type": "Double"
										},
										"sink": {
											"name": "COLLECTD_ON_DRAFT_CCD#T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "COLLECTD_ON_DRAFT_CCD$A",
											"type": "Double"
										},
										"sink": {
											"name": "COLLECTD_ON_DRAFT_CCD$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "COLLECTD_ON_DRAFT_STM#T",
											"type": "Double"
										},
										"sink": {
											"name": "COLLECTD_ON_DRAFT_STM#T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "COLLECTD_ON_DRAFT_STM$A",
											"type": "Double"
										},
										"sink": {
											"name": "COLLECTD_ON_DRAFT_STM$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "COLLECTD_ON_DRAFT_AMZ#T",
											"type": "Double"
										},
										"sink": {
											"name": "COLLECTD_ON_DRAFT_AMZ#T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "COLLECTD_ON_DRAFT_AMZ$A",
											"type": "Double"
										},
										"sink": {
											"name": "COLLECTD_ON_DRAFT_AMZ$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "COLLECTD_ON_DRAFT_APL#T",
											"type": "Double"
										},
										"sink": {
											"name": "COLLECTD_ON_DRAFT_APL#T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "COLLECTD_ON_DRAFT_APL$A",
											"type": "Double"
										},
										"sink": {
											"name": "COLLECTD_ON_DRAFT_APL$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "COLLECTD_ON_DRAFT_DGP#T",
											"type": "Double"
										},
										"sink": {
											"name": "COLLECTD_ON_DRAFT_DGP#T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "COLLECTD_ON_DRAFT_DGP$A",
											"type": "Double"
										},
										"sink": {
											"name": "COLLECTD_ON_DRAFT_DGP$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "COLLECTD_ON_DRAFT_PRB#T",
											"type": "Double"
										},
										"sink": {
											"name": "COLLECTD_ON_DRAFT_PRB#T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "COLLECTD_ON_DRAFT_PRB$A",
											"type": "Double"
										},
										"sink": {
											"name": "COLLECTD_ON_DRAFT_PRB$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "COLLECTD_ON_DRAFT_TOT#T",
											"type": "Double"
										},
										"sink": {
											"name": "COLLECTD_ON_DRAFT_TOT#T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "COLLECTD_ON_DRAFT_TOT$A",
											"type": "Double"
										},
										"sink": {
											"name": "COLLECTD_ON_DRAFT_TOT$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "DELINQUENT_RECOVRY_ACH#T",
											"type": "Double"
										},
										"sink": {
											"name": "DELINQUENT_RECOVRY_ACH#T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "DELINQUENT_RECOVRY_ACH$A",
											"type": "Double"
										},
										"sink": {
											"name": "DELINQUENT_RECOVRY_ACH$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "DELINQUENT_RECOVRY_CCD#T",
											"type": "Double"
										},
										"sink": {
											"name": "DELINQUENT_RECOVRY_CCD#T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "DELINQUENT_RECOVRY_CCD$A",
											"type": "Double"
										},
										"sink": {
											"name": "DELINQUENT_RECOVRY_CCD$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "DELINQUENT_RECOVRY_STM#T",
											"type": "Double"
										},
										"sink": {
											"name": "DELINQUENT_RECOVRY_STM#T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "DELINQUENT_RECOVRY_STM$A",
											"type": "Double"
										},
										"sink": {
											"name": "DELINQUENT_RECOVRY_STM$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "DELINQUENT_RECOVRY_AMZ#T",
											"type": "Double"
										},
										"sink": {
											"name": "DELINQUENT_RECOVRY_AMZ#T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "DELINQUENT_RECOVRY_AMZ$A",
											"type": "Double"
										},
										"sink": {
											"name": "DELINQUENT_RECOVRY_AMZ$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "DELINQUENT_RECOVRY_APL#T",
											"type": "Double"
										},
										"sink": {
											"name": "DELINQUENT_RECOVRY_APL#T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "DELINQUENT_RECOVRY_APL$A",
											"type": "Double"
										},
										"sink": {
											"name": "DELINQUENT_RECOVRY_APL$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "DELINQUENT_RECOVRY_DGP#T",
											"type": "Double"
										},
										"sink": {
											"name": "DELINQUENT_RECOVRY_DGP#T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "DELINQUENT_RECOVRY_DGP$A",
											"type": "Double"
										},
										"sink": {
											"name": "DELINQUENT_RECOVRY_DGP$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "DELINQUENT_RECOVRY_PRB#T",
											"type": "Double"
										},
										"sink": {
											"name": "DELINQUENT_RECOVRY_PRB#T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "DELINQUENT_RECOVRY_PRB$A",
											"type": "Double"
										},
										"sink": {
											"name": "DELINQUENT_RECOVRY_PRB$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "DELINQUENT_RECOVRY_TOT#T",
											"type": "Double"
										},
										"sink": {
											"name": "DELINQUENT_RECOVRY_TOT#T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "DELINQUENT_RECO_CLUBACCT_TOT$A",
											"type": "Double"
										},
										"sink": {
											"name": "DELINQUENT_RECO_CLUBACCT_TOT$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "DELINQUENT_RECOVRY_TOT$A",
											"type": "Double"
										},
										"sink": {
											"name": "DELINQUENT_RECOVRY_TOT$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "COLLECTED_PRIOR_TO_DRAFT_ACH#T",
											"type": "Double"
										},
										"sink": {
											"name": "COLLECTED_PRIOR_TO_DRAFT_ACH#T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "COLLECTED_PRIOR_TO_DRAFT_ACH$A",
											"type": "Double"
										},
										"sink": {
											"name": "COLLECTED_PRIOR_TO_DRAFT_ACH$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "COLLECTED_PRIOR_TO_DRAFT_CCD#T",
											"type": "Double"
										},
										"sink": {
											"name": "COLLECTED_PRIOR_TO_DRAFT_CCD#T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "COLLECTED_PRIOR_TO_DRAFT_CCD$A",
											"type": "Double"
										},
										"sink": {
											"name": "COLLECTED_PRIOR_TO_DRAFT_CCD$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "COLLECTED_PRIOR_TO_DRAFT_STM#T",
											"type": "Double"
										},
										"sink": {
											"name": "COLLECTED_PRIOR_TO_DRAFT_STM#T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "COLLECTED_PRIOR_TO_DRAFT_STM$A",
											"type": "Double"
										},
										"sink": {
											"name": "COLLECTED_PRIOR_TO_DRAFT_STM$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "COLLECTED_PRIOR_TO_DRAFT_AMZ#T",
											"type": "Double"
										},
										"sink": {
											"name": "COLLECTED_PRIOR_TO_DRAFT_AMZ#T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "COLLECTED_PRIOR_TO_DRAFT_AMZ$A",
											"type": "Double"
										},
										"sink": {
											"name": "COLLECTED_PRIOR_TO_DRAFT_AMZ$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "COLLECTED_PRIOR_TO_DRAFT_APL#T",
											"type": "Double"
										},
										"sink": {
											"name": "COLLECTED_PRIOR_TO_DRAFT_APL#T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "COLLECTED_PRIOR_TO_DRAFT_APL$A",
											"type": "Double"
										},
										"sink": {
											"name": "COLLECTED_PRIOR_TO_DRAFT_APL$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "COLLECTED_PRIOR_TO_DRAFT_DGP#T",
											"type": "Double"
										},
										"sink": {
											"name": "COLLECTED_PRIOR_TO_DRAFT_DGP#T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "COLLECTED_PRIOR_TO_DRAFT_DGP$A",
											"type": "Double"
										},
										"sink": {
											"name": "COLLECTED_PRIOR_TO_DRAFT_DGP$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "COLLECTED_PRIOR_TO_DRAFT_PRB#T",
											"type": "Double"
										},
										"sink": {
											"name": "COLLECTED_PRIOR_TO_DRAFT_PRB#T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "COLLECTED_PRIOR_TO_DRAFT_PRB$A",
											"type": "Double"
										},
										"sink": {
											"name": "COLLECTED_PRIOR_TO_DRAFT_PRB$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "COLLECTED_PRIOR_TO_DRAFT_TOT#T",
											"type": "Double"
										},
										"sink": {
											"name": "COLLECTED_PRIOR_TO_DRAFT_TOT#T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "COLLECTED_PRIOR_TO_DRAFT_TOT$A",
											"type": "Double"
										},
										"sink": {
											"name": "COLLECTED_PRIOR_TO_DRAFT_TOT$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "PRIOR_PERIOD_REVERSALS_ACH#T",
											"type": "Double"
										},
										"sink": {
											"name": "PRIOR_PERIOD_REVERSALS_ACH#T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "PRIOR_PERIOD_REVERSALS_ACH$A",
											"type": "Double"
										},
										"sink": {
											"name": "PRIOR_PERIOD_REVERSALS_ACH$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "PRIOR_PERIOD_REVERSALS_CCD#T",
											"type": "Double"
										},
										"sink": {
											"name": "PRIOR_PERIOD_REVERSALS_CCD#T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "PRIOR_PERIOD_REVERSALS_CCD$A",
											"type": "Double"
										},
										"sink": {
											"name": "PRIOR_PERIOD_REVERSALS_CCD$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "PRIOR_PERIOD_REVERSALS_STM#T",
											"type": "Double"
										},
										"sink": {
											"name": "PRIOR_PERIOD_REVERSALS_STM#T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "PRIOR_PERIOD_REVERSALS_STM$A",
											"type": "Double"
										},
										"sink": {
											"name": "PRIOR_PERIOD_REVERSALS_STM$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "PRIOR_PERIOD_REVERSALS_AMZ#T",
											"type": "Double"
										},
										"sink": {
											"name": "PRIOR_PERIOD_REVERSALS_AMZ#T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "PRIOR_PERIOD_REVERSALS_AMZ$A",
											"type": "Double"
										},
										"sink": {
											"name": "PRIOR_PERIOD_REVERSALS_AMZ$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "PRIOR_PERIOD_REVERSALS_APL#T",
											"type": "Double"
										},
										"sink": {
											"name": "PRIOR_PERIOD_REVERSALS_APL#T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "PRIOR_PERIOD_REVERSALS_APL$A",
											"type": "Double"
										},
										"sink": {
											"name": "PRIOR_PERIOD_REVERSALS_APL$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "PRIOR_PERIOD_REVERSALS_DGP#T",
											"type": "Double"
										},
										"sink": {
											"name": "PRIOR_PERIOD_REVERSALS_DGP#T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "PRIOR_PERIOD_REVERSALS_DGP$A",
											"type": "Double"
										},
										"sink": {
											"name": "PRIOR_PERIOD_REVERSALS_DGP$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "PRIOR_PERIOD_REVERSALS_PRB#T",
											"type": "Double"
										},
										"sink": {
											"name": "PRIOR_PERIOD_REVERSALS_PRB#T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "PRIOR_PERIOD_REVERSALS_PRB$A",
											"type": "Double"
										},
										"sink": {
											"name": "PRIOR_PERIOD_REVERSALS_PRB$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "PRIOR_PERIOD_REVERSALS_TOT#T",
											"type": "Double"
										},
										"sink": {
											"name": "PRIOR_PERIOD_REVERSALS_TOT#T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "PRIOR_PERIOD_REVERSALS_TOT$A",
											"type": "Double"
										},
										"sink": {
											"name": "PRIOR_PERIOD_REVERSALS_TOT$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "TOTAL_COLLECTED_ACH#T",
											"type": "Double"
										},
										"sink": {
											"name": "TOTAL_COLLECTED_ACH#T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "TOTAL_COLLECTED_ACH$A",
											"type": "Double"
										},
										"sink": {
											"name": "TOTAL_COLLECTED_ACH$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "TOTAL_COLLECTED_CCD#T",
											"type": "Double"
										},
										"sink": {
											"name": "TOTAL_COLLECTED_CCD#T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "TOTAL_COLLECTED_CCD$A",
											"type": "Double"
										},
										"sink": {
											"name": "TOTAL_COLLECTED_CCD$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "TOTAL_COLLECTED_STM#T",
											"type": "Double"
										},
										"sink": {
											"name": "TOTAL_COLLECTED_STM#T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "TOTAL_COLLECTED_STM$A",
											"type": "Double"
										},
										"sink": {
											"name": "TOTAL_COLLECTED_STM$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "TOTAL_COLLECTED_AMZ#T",
											"type": "Double"
										},
										"sink": {
											"name": "TOTAL_COLLECTED_AMZ#T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "TOTAL_COLLECTED_AMZ$A",
											"type": "Double"
										},
										"sink": {
											"name": "TOTAL_COLLECTED_AMZ$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "TOTAL_COLLECTED_APL#T",
											"type": "Double"
										},
										"sink": {
											"name": "TOTAL_COLLECTED_APL#T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "TOTAL_COLLECTED_APL$A",
											"type": "Double"
										},
										"sink": {
											"name": "TOTAL_COLLECTED_APL$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "TOTAL_COLLECTED_DGP#T",
											"type": "Double"
										},
										"sink": {
											"name": "TOTAL_COLLECTED_DGP#T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "TOTAL_COLLECTED_DGP$A",
											"type": "Double"
										},
										"sink": {
											"name": "TOTAL_COLLECTED_DGP$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "TOTAL_COLLECTED_PRB#T",
											"type": "Double"
										},
										"sink": {
											"name": "TOTAL_COLLECTED_PRB#T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "TOTAL_COLLECTED_PRB$A",
											"type": "Double"
										},
										"sink": {
											"name": "TOTAL_COLLECTED_PRB$A",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "TOTAL_COLLECTED_TOT#T",
											"type": "Double"
										},
										"sink": {
											"name": "TOTAL_COLLECTED_TOT#T",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "TOTAL_COLLECTED_TOT$A",
											"type": "Double"
										},
										"sink": {
											"name": "TOTAL_COLLECTED_TOT$A",
											"type": "Single"
										}
									}
								]
							}
						},
						"inputs": [
							{
								"referenceName": "SRC_PF_EFT_ALLOC_DS_VW",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "SNK_SYN_PF_EFT_ALLOC_DS",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Truncate table Sink",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Check Did Job Success",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "TRUNCATE TABLE [PF].[EFT_ALLOC_DS];\nSELECT 1;",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "SNK_SYN_PF_EFT_ALLOC_DS",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": true
						}
					},
					{
						"name": "Get Job Status",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "select 1\nfrom [dbo].[PF_VIEWS_JOBS_CHECK] \nwhere finish_time = cast(GETDATE() AT TIME ZONE 'UTC' AT TIME ZONE 'Eastern Standard Time' AS DATE) \nand FBI_JOB_NAME= 'PF.EFT_ALLOCATIONS_PR' and job_completed=1",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "SNK_DBO_PF_VIEWS_JOBS_CHECK",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "check Oracle Job",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Get Job Status",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "OracleSource",
								"oracleReaderQuery": "select JOB_NAME,START_TIME,FINISH_TIME,STATUS, 'PF.EFT_ALLOCATIONS_PR' as FBI_JOB_NAME \r\nfrom dw.job_monitoring_vw \r\nwhere job_name = 'PF.EFT_ALLOCATIONS_PR' and status = 'SUCCESS' and to_date(finish_time,'YYYY/MM/DD HH24:MI:SS') > trunc(sysdate)",
								"partitionOption": "None",
								"queryTimeout": "02:00:00"
							},
							"dataset": {
								"referenceName": "OracleTable1",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Check Did Job Success",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "check Oracle Job",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "select count(*) from pf_views_jobs_check \nwhere job_name = 'PF.EFT_ALLOCATIONS_PR' and \n    status = 'SUCCESS' and cast(finish_time as date)=cast(GETDATE() AT TIME ZONE 'UTC' AT TIME ZONE 'Eastern Standard Time' AS DATE)\n    and FBI_JOB_NAME='PF.EFT_ALLOCATIONS_PR'",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "SNK_DBO_PF_VIEWS_JOBS_CHECK",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Update Job Status",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Copy data1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "UPDATE [PF].[EFT_ALLOC_DS]\nSET AS_OF = GETDATE();\nSELECT 1\n",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "SNK_DBO_PF_VIEWS_JOBS_CHECK",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"folder": {
					"name": "EDW_PF_SQL_POOL"
				},
				"annotations": [],
				"lastPublishTime": "2023-02-23T16:21:18Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/PF_EFT_ALLOC_INVOICES_AF_VW')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Copy data1",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Truncate table Sink",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "OracleSource",
								"oracleReaderQuery": "SELECT *\nFROM PF.EFT_ALLOC_INVOICES_AF_VW",
								"partitionOption": "None",
								"queryTimeout": "02:00:00"
							},
							"sink": {
								"type": "SqlDWSink",
								"maxConcurrentConnections": 6,
								"allowPolyBase": true,
								"polyBaseSettings": {
									"rejectValue": 0,
									"rejectType": "value",
									"useTypeDefault": true
								},
								"disableMetricsCollection": false
							},
							"enableStaging": true,
							"stagingSettings": {
								"linkedServiceName": {
									"referenceName": "AzureBlobStorage1",
									"type": "LinkedServiceReference"
								},
								"path": "pfviewsoracle",
								"enableCompression": true
							},
							"parallelCopies": 8,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "CLUB",
											"type": "String"
										},
										"sink": {
											"name": "CLUB",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "DUES_INVOICES",
											"type": "String"
										},
										"sink": {
											"name": "DUES_INVOICES",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "GROSS_INVOICES_ACH#T",
											"type": "String"
										},
										"sink": {
											"name": "GROSS_INVOICES_ACH#T",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "GROSS_INVOICES_ACH$A",
											"type": "String"
										},
										"sink": {
											"name": "GROSS_INVOICES_ACH$A",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "GROSS_INVOICES_CCD#T",
											"type": "String"
										},
										"sink": {
											"name": "GROSS_INVOICES_CCD#T",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "GROSS_INVOICES_CCD$A",
											"type": "String"
										},
										"sink": {
											"name": "GROSS_INVOICES_CCD$A",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "GROSS_INVOICES_PRB#T",
											"type": "String"
										},
										"sink": {
											"name": "GROSS_INVOICES_PRB#T",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "GROSS_INVOICES_PRB$A",
											"type": "String"
										},
										"sink": {
											"name": "GROSS_INVOICES_PRB$A",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "GROSS_INVOICES_STM#T",
											"type": "String"
										},
										"sink": {
											"name": "GROSS_INVOICES_STM#T",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "GROSS_INVOICES_STM$A",
											"type": "String"
										},
										"sink": {
											"name": "GROSS_INVOICES_STM$A",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "GROSS_INVOICES_AMZ#T",
											"type": "String"
										},
										"sink": {
											"name": "GROSS_INVOICES_AMZ#T",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "GROSS_INVOICES_AMZ$A",
											"type": "String"
										},
										"sink": {
											"name": "GROSS_INVOICES_AMZ$A",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "GROSS_INVOICES_APL#T",
											"type": "String"
										},
										"sink": {
											"name": "GROSS_INVOICES_APL#T",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "GROSS_INVOICES_APL$A",
											"type": "String"
										},
										"sink": {
											"name": "GROSS_INVOICES_APL$A",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "GROSS_INVOICES_DGP#T",
											"type": "String"
										},
										"sink": {
											"name": "GROSS_INVOICES_DGP#T",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "GROSS_INVOICES_DGP$A",
											"type": "String"
										},
										"sink": {
											"name": "GROSS_INVOICES_DGP$A",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "GROSS_INVOICES_TOT#T",
											"type": "String"
										},
										"sink": {
											"name": "GROSS_INVOICES_TOT#T",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "GROSS_INVOICES_TOT$A",
											"type": "String"
										},
										"sink": {
											"name": "GROSS_INVOICES_TOT$A",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "M_BCM",
											"type": "Double"
										},
										"sink": {
											"name": "M_BCM",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "M_10NR",
											"type": "Double"
										},
										"sink": {
											"name": "M_10NR",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "M_15NR",
											"type": "Double"
										},
										"sink": {
											"name": "M_15NR",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "M_OTHER",
											"type": "Double"
										},
										"sink": {
											"name": "M_OTHER",
											"type": "Single"
										}
									}
								]
							}
						},
						"inputs": [
							{
								"referenceName": "SRC_PF_EFT_ALLOC_INVOICES_AF_VW",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "SNK_SYN_EFT_ALLOC_INVOICES_AF",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Truncate table Sink",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Check Did Job Success",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "TRUNCATE TABLE [PF].[EFT_ALLOC_INVOICES_AF];\nSELECT 1;",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "SNK_SYN_EFT_ALLOC_INVOICES_AF",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": true
						}
					},
					{
						"name": "Get Job Status",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "select 1\nfrom [dbo].[PF_VIEWS_JOBS_CHECK] \nwhere finish_time = cast(GETDATE() AT TIME ZONE 'UTC' AT TIME ZONE 'Eastern Standard Time' AS DATE) \nand FBI_JOB_NAME= 'PF.EFT_ALLOCATIONS_PR' and job_completed=1",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "SNK_DBO_PF_VIEWS_JOBS_CHECK",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "check Oracle Job",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Get Job Status",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "OracleSource",
								"oracleReaderQuery": "select JOB_NAME,START_TIME,FINISH_TIME,STATUS, 'PF.EFT_ALLOCATIONS_PR' as FBI_JOB_NAME \nfrom dw.job_monitoring_vw \nwhere job_name = 'PF.EFT_ALLOCATIONS_PR' and status = 'SUCCESS' and to_date(finish_time,'YYYY/MM/DD HH24:MI:SS') > trunc(sysdate)",
								"partitionOption": "None",
								"queryTimeout": "02:00:00"
							},
							"dataset": {
								"referenceName": "OracleTable1",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Check Did Job Success",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "check Oracle Job",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "select count(*) from pf_views_jobs_check \nwhere job_name = 'PF.EFT_ALLOCATIONS_PR' and \n    status = 'SUCCESS' and cast(finish_time as date)=cast(GETDATE() AT TIME ZONE 'UTC' AT TIME ZONE 'Eastern Standard Time' AS DATE)\n    and FBI_JOB_NAME='PF.EFT_ALLOCATIONS_PR'",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "SNK_DBO_PF_VIEWS_JOBS_CHECK",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Update Job Status",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Copy data1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "UPDATE [PF].[EFT_ALLOC_INVOICES_AF]\nSET AS_OF = GETDATE();\nSELECT 1\n",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "SNK_DBO_PF_VIEWS_JOBS_CHECK",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"folder": {
					"name": "EDW_PF_SQL_POOL"
				},
				"annotations": [],
				"lastPublishTime": "2023-02-23T16:21:18Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/PF_EFT_ALLOC_INVOICES_DS_VW')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Copy data1",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Truncate table Sink",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "OracleSource",
								"oracleReaderQuery": "SELECT *\nFROM PF.EFT_ALLOC_INVOICES_DS_VW",
								"partitionOption": "None",
								"queryTimeout": "02:00:00"
							},
							"sink": {
								"type": "SqlDWSink",
								"maxConcurrentConnections": 6,
								"allowPolyBase": true,
								"polyBaseSettings": {
									"rejectValue": 0,
									"rejectType": "value",
									"useTypeDefault": true
								},
								"disableMetricsCollection": false
							},
							"enableStaging": true,
							"stagingSettings": {
								"linkedServiceName": {
									"referenceName": "AzureBlobStorage1",
									"type": "LinkedServiceReference"
								},
								"path": "pfviewsoracle",
								"enableCompression": true
							},
							"parallelCopies": 8,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "GROSS_INVOICES_DGP#T",
											"type": "String"
										},
										"sink": {
											"name": "GROSS_INVOICES_DGP#T",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "GROSS_INVOICES_DGP$A",
											"type": "String"
										},
										"sink": {
											"name": "GROSS_INVOICES_DGP$A",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "GROSS_INVOICES_TOT#T",
											"type": "String"
										},
										"sink": {
											"name": "GROSS_INVOICES_TOT#T",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "GROSS_INVOICES_TOT$A",
											"type": "String"
										},
										"sink": {
											"name": "GROSS_INVOICES_TOT$A",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "M_BCM",
											"type": "Double"
										},
										"sink": {
											"name": "M_BCM",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "M_10NR",
											"type": "Double"
										},
										"sink": {
											"name": "M_10NR",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "M_15NR",
											"type": "Double"
										},
										"sink": {
											"name": "M_15NR",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "M_OTHER",
											"type": "Double"
										},
										"sink": {
											"name": "M_OTHER",
											"type": "Single"
										}
									},
									{
										"source": {
											"name": "CLUB",
											"type": "String"
										},
										"sink": {
											"name": "CLUB",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "DUES_INVOICES",
											"type": "String"
										},
										"sink": {
											"name": "DUES_INVOICES",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "GROSS_INVOICES_ACH#T",
											"type": "String"
										},
										"sink": {
											"name": "GROSS_INVOICES_ACH#T",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "GROSS_INVOICES_ACH$A",
											"type": "String"
										},
										"sink": {
											"name": "GROSS_INVOICES_ACH$A",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "GROSS_INVOICES_CCD#T",
											"type": "String"
										},
										"sink": {
											"name": "GROSS_INVOICES_CCD#T",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "GROSS_INVOICES_CCD$A",
											"type": "String"
										},
										"sink": {
											"name": "GROSS_INVOICES_CCD$A",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "GROSS_INVOICES_PRB#T",
											"type": "String"
										},
										"sink": {
											"name": "GROSS_INVOICES_PRB#T",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "GROSS_INVOICES_PRB$A",
											"type": "String"
										},
										"sink": {
											"name": "GROSS_INVOICES_PRB$A",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "GROSS_INVOICES_STM#T",
											"type": "String"
										},
										"sink": {
											"name": "GROSS_INVOICES_STM#T",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "GROSS_INVOICES_STM$A",
											"type": "String"
										},
										"sink": {
											"name": "GROSS_INVOICES_STM$A",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "GROSS_INVOICES_AMZ#T",
											"type": "String"
										},
										"sink": {
											"name": "GROSS_INVOICES_AMZ#T",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "GROSS_INVOICES_AMZ$A",
											"type": "String"
										},
										"sink": {
											"name": "GROSS_INVOICES_AMZ$A",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "GROSS_INVOICES_APL#T",
											"type": "String"
										},
										"sink": {
											"name": "GROSS_INVOICES_APL#T",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "GROSS_INVOICES_APL$A",
											"type": "String"
										},
										"sink": {
											"name": "GROSS_INVOICES_APL$A",
											"type": "String"
										}
									}
								]
							}
						},
						"inputs": [
							{
								"referenceName": "SRC_PF_EFT_ALLOC_INVOICES_DS_VW",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "SNK_SYN_EFT_ALLOC_INVOICES_DS",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Truncate table Sink",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Check Did Job Success",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "TRUNCATE TABLE [PF].[EFT_ALLOC_INVOICES_DS];\nSELECT 1;",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "SNK_SYN_EFT_ALLOC_INVOICES_DS",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": true
						}
					},
					{
						"name": "Get Job Status",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "select 1\nfrom [dbo].[PF_VIEWS_JOBS_CHECK] \nwhere finish_time = cast(GETDATE() AT TIME ZONE 'UTC' AT TIME ZONE 'Eastern Standard Time' AS DATE) \nand FBI_JOB_NAME= 'PF.EFT_ALLOCATIONS_PR' and job_completed=1",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "SNK_DBO_PF_VIEWS_JOBS_CHECK",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "check Oracle Job",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Get Job Status",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "OracleSource",
								"oracleReaderQuery": "select JOB_NAME,START_TIME,FINISH_TIME,STATUS, 'PF.EFT_ALLOCATIONS_PR' as FBI_JOB_NAME \nfrom dw.job_monitoring_vw \nwhere job_name = 'PF.EFT_ALLOCATIONS_PR' and status = 'SUCCESS' and to_date(finish_time,'YYYY/MM/DD HH24:MI:SS') > trunc(sysdate)",
								"partitionOption": "None",
								"queryTimeout": "02:00:00"
							},
							"dataset": {
								"referenceName": "OracleTable1",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Check Did Job Success",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "check Oracle Job",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "select count(*) from pf_views_jobs_check \nwhere job_name = 'PF.EFT_ALLOCATIONS_PR' and \n    status = 'SUCCESS' and cast(finish_time as date)=cast(GETDATE() AT TIME ZONE 'UTC' AT TIME ZONE 'Eastern Standard Time' AS DATE)\n    and FBI_JOB_NAME='PF.EFT_ALLOCATIONS_PR'",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "SNK_DBO_PF_VIEWS_JOBS_CHECK",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Update Job Status",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Copy data1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "UPDATE [PF].[EFT_ALLOC_INVOICES_DS]\nSET AS_OF = GETDATE();\nSELECT 1\n",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "SNK_DBO_PF_VIEWS_JOBS_CHECK",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"folder": {
					"name": "EDW_PF_SQL_POOL"
				},
				"annotations": [],
				"lastPublishTime": "2023-02-23T16:21:18Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/PF_EFT_ALLOC_OUTSIDE_CYCLE_AF_VW')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Copy data1",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Truncate table Sink",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "OracleSource",
								"oracleReaderQuery": "SELECT *\nFROM PF.EFT_ALLOC_OUTSIDE_CYCLE_AF_VW",
								"partitionOption": "None",
								"queryTimeout": "02:00:00"
							},
							"sink": {
								"type": "SqlDWSink",
								"maxConcurrentConnections": 6,
								"allowPolyBase": true,
								"polyBaseSettings": {
									"rejectValue": 0,
									"rejectType": "value",
									"useTypeDefault": true
								},
								"disableMetricsCollection": false
							},
							"enableStaging": true,
							"stagingSettings": {
								"linkedServiceName": {
									"referenceName": "AzureBlobStorage1",
									"type": "LinkedServiceReference"
								},
								"path": "pfviewsoracle",
								"enableCompression": true
							},
							"parallelCopies": 8,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "CLUB",
											"type": "String"
										},
										"sink": {
											"name": "CLUB",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "DESCRIPTION",
											"type": "String"
										},
										"sink": {
											"name": "DESCRIPTION",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ACH",
											"type": "String"
										},
										"sink": {
											"name": "ACH",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "CCD",
											"type": "String"
										},
										"sink": {
											"name": "CCD",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PRB",
											"type": "String"
										},
										"sink": {
											"name": "PRB",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "STM",
											"type": "String"
										},
										"sink": {
											"name": "STM",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "AMZ",
											"type": "String"
										},
										"sink": {
											"name": "AMZ",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "APL",
											"type": "String"
										},
										"sink": {
											"name": "APL",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "DGP",
											"type": "String"
										},
										"sink": {
											"name": "DGP",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "TOT",
											"type": "String"
										},
										"sink": {
											"name": "TOT",
											"type": "String"
										}
									}
								]
							}
						},
						"inputs": [
							{
								"referenceName": "SRC_PF_EFT_ALLOC_OUTSIDE_CYCLE_AF_VW",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "SNK_SYN_EFT_ALLOC_OUTSIDE_CYCLE_AF",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Truncate table Sink",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Check Did Job Success",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "TRUNCATE TABLE [PF].[EFT_ALLOC_OUTSIDE_CYCLE_AF];\nSELECT 1;",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "SNK_SYN_EFT_ALLOC_OUTSIDE_CYCLE_AF",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": true
						}
					},
					{
						"name": "Get Job Status",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "select 1\nfrom [dbo].[PF_VIEWS_JOBS_CHECK] \nwhere finish_time = cast(GETDATE() AT TIME ZONE 'UTC' AT TIME ZONE 'Eastern Standard Time' AS DATE) \nand FBI_JOB_NAME= 'PF.EFT_ALLOCATIONS_PR' and job_completed=1",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "SNK_DBO_PF_VIEWS_JOBS_CHECK",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "check Oracle Job",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Get Job Status",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "OracleSource",
								"oracleReaderQuery": "select JOB_NAME,START_TIME,FINISH_TIME,STATUS, 'PF.EFT_ALLOCATIONS_PR' as FBI_JOB_NAME \nfrom dw.job_monitoring_vw \nwhere job_name = 'PF.EFT_ALLOCATIONS_PR' and status = 'SUCCESS' and to_date(finish_time,'YYYY/MM/DD HH24:MI:SS') > trunc(sysdate)",
								"partitionOption": "None",
								"queryTimeout": "02:00:00"
							},
							"dataset": {
								"referenceName": "OracleTable1",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Check Did Job Success",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "check Oracle Job",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "select count(*) from pf_views_jobs_check \nwhere job_name = 'PF.EFT_ALLOCATIONS_PR' and \n    status = 'SUCCESS' and cast(finish_time as date)=cast(GETDATE() AT TIME ZONE 'UTC' AT TIME ZONE 'Eastern Standard Time' AS DATE)\n    and FBI_JOB_NAME='PF.EFT_ALLOCATIONS_PR'",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "SNK_DBO_PF_VIEWS_JOBS_CHECK",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Update Job Status",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Copy data1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "UPDATE [PF].[EFT_ALLOC_OUTSIDE_CYCLE_AF]\nSET AS_OF = GETDATE();\nSELECT 1\n",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "SNK_DBO_PF_VIEWS_JOBS_CHECK",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"folder": {
					"name": "EDW_PF_SQL_POOL"
				},
				"annotations": [],
				"lastPublishTime": "2023-02-23T16:21:18Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/PF_EFT_ALLOC_OUTSIDE_CYCLE_DS_VW')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Copy data1",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Truncate table Sink",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "OracleSource",
								"oracleReaderQuery": "SELECT *\nFROM PF.EFT_ALLOC_OUTSIDE_CYCLE_DS_VW",
								"partitionOption": "None",
								"queryTimeout": "02:00:00"
							},
							"sink": {
								"type": "SqlDWSink",
								"maxConcurrentConnections": 6,
								"allowPolyBase": true,
								"polyBaseSettings": {
									"rejectValue": 0,
									"rejectType": "value",
									"useTypeDefault": true
								},
								"disableMetricsCollection": false
							},
							"enableStaging": true,
							"stagingSettings": {
								"linkedServiceName": {
									"referenceName": "AzureBlobStorage1",
									"type": "LinkedServiceReference"
								},
								"path": "pfviewsoracle",
								"enableCompression": true
							},
							"parallelCopies": 8,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "CLUB",
											"type": "String"
										},
										"sink": {
											"name": "CLUB",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "DESCRIPTION",
											"type": "String"
										},
										"sink": {
											"name": "DESCRIPTION",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ACH",
											"type": "String"
										},
										"sink": {
											"name": "ACH",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "CCD",
											"type": "String"
										},
										"sink": {
											"name": "CCD",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PRB",
											"type": "String"
										},
										"sink": {
											"name": "PRB",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "STM",
											"type": "String"
										},
										"sink": {
											"name": "STM",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "AMZ",
											"type": "String"
										},
										"sink": {
											"name": "AMZ",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "APL",
											"type": "String"
										},
										"sink": {
											"name": "APL",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "DGP",
											"type": "String"
										},
										"sink": {
											"name": "DGP",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "TOT",
											"type": "String"
										},
										"sink": {
											"name": "TOT",
											"type": "String"
										}
									}
								]
							}
						},
						"inputs": [
							{
								"referenceName": "SRC_PF_EFT_ALLOC_OUTSIDE_CYCLE_DS_VW",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "SNK_SYN_EFT_ALLOC_OUTSIDE_CYCLE_DS",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Truncate table Sink",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Check Did Job Success",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "TRUNCATE TABLE [PF].[EFT_ALLOC_OUTSIDE_CYCLE_DS];\nSELECT 1;",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "SNK_SYN_EFT_ALLOC_OUTSIDE_CYCLE_DS",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": true
						}
					},
					{
						"name": "Get Job Status",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "select 1\nfrom [dbo].[PF_VIEWS_JOBS_CHECK] \nwhere finish_time = cast(GETDATE() AT TIME ZONE 'UTC' AT TIME ZONE 'Eastern Standard Time' AS DATE) \nand FBI_JOB_NAME= 'PF.EFT_ALLOCATIONS_PR' and job_completed=1",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "SNK_DBO_PF_VIEWS_JOBS_CHECK",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "check Oracle Job",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Get Job Status",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "OracleSource",
								"oracleReaderQuery": "select JOB_NAME,START_TIME,FINISH_TIME,STATUS, 'PF.EFT_ALLOCATIONS_PR' as FBI_JOB_NAME \nfrom dw.job_monitoring_vw \nwhere job_name = 'PF.EFT_ALLOCATIONS_PR' and status = 'SUCCESS' and to_date(finish_time,'YYYY/MM/DD HH24:MI:SS') > trunc(sysdate)",
								"partitionOption": "None",
								"queryTimeout": "02:00:00"
							},
							"dataset": {
								"referenceName": "OracleTable1",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Check Did Job Success",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "check Oracle Job",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "select count(*) from pf_views_jobs_check \nwhere job_name = 'PF.EFT_ALLOCATIONS_PR' and \n    status = 'SUCCESS' and cast(finish_time as date)=cast(GETDATE() AT TIME ZONE 'UTC' AT TIME ZONE 'Eastern Standard Time' AS DATE)\n    and FBI_JOB_NAME='PF.EFT_ALLOCATIONS_PR'",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "SNK_DBO_PF_VIEWS_JOBS_CHECK",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Update Job Status",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Copy data1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "UPDATE [PF].[EFT_ALLOC_OUTSIDE_CYCLE_DS]\nSET AS_OF = GETDATE();\nSELECT 1\n",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "SNK_DBO_PF_VIEWS_JOBS_CHECK",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"folder": {
					"name": "EDW_PF_SQL_POOL"
				},
				"annotations": [],
				"lastPublishTime": "2023-02-23T16:21:18Z"
			},
			"dependsOn": []
		}
	]
}